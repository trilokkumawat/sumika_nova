;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="62c746ab-430d-942a-ac02-2dd81935e036")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,725990,e=>{"use strict";let t=(0,e.i(388019).default)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);e.s(["Minus",()=>t],725990)},868118,e=>{"use strict";e.s(["extractMethod",0,(e,t)=>{if(e.startsWith("https"))return{type:"https",url:e,secret:t||""};{let[t,s,a,r,i]=(e||"").split("/");return{type:"postgres",schema:r||"",functionName:i||""}}},"getRevokePermissionStatements",0,(e,t)=>[`-- Revoke access to function from supabase_auth_admin
revoke execute on function ${e}.${t} from supabase_auth_admin;`,`-- Revoke access to schema from supabase_auth_admin
revoke usage on schema ${e} from supabase_auth_admin;`,`-- Restore function permissions to authenticated, anon and public
grant execute on function ${e}.${t} to authenticated, anon, public;`],"isValidHook",0,e=>"postgres"===e.method.type&&e.method.schema.length>0&&e.method.functionName.length>0||"https"===e.method.type&&e.method.url.startsWith("https")&&e.method.secret.length>0])},258732,e=>{"use strict";var t=e.i(479084),s=e.i(959076);let a=50;var r=e.i(867088),i=e.i(714403),n=e.i(635494);e.i(10429);var l=e.i(837508),o=e.i(294285);e.s(["useUsersInfiniteQuery",0,({projectRef:e,connectionString:d,keywords:c,filter:u,providers:h,sort:m,order:p,column:x,improvedSearchEnabled:g=!1},{enabled:f=!0,..._}={})=>{let{data:j}=(0,n.useSelectedProjectQuery)(),v=j?.status===l.PROJECT_STATUS.ACTIVE_HEALTHY;return(0,r.useInfiniteQuery)({queryKey:o.authKeys.usersInfinite(e,{keywords:c,filter:u,providers:h,sort:m,order:p,column:x}),queryFn:({signal:r,pageParam:n})=>(0,i.executeSql)({projectRef:e,connectionString:d,sql:(({page:e=0,verified:r,keywords:i,providers:n,sort:l,order:o,limit:d=a,column:c,startAt:u,cursor:h,improvedSearchEnabled:m=!1})=>{if(m)return(({column:e,keywords:r,verified:i,providers:n,sort:l,order:o,cursor:d,limit:c=a})=>{let u=[];if(r&&""!==r){if("email"===e){let e=(0,s.stringRange)(r);e[1]?u.push(`email >= ${(0,t.literal)(e[0])} AND email < ${(0,t.literal)(e[1])}`):u.push(`email >= ${(0,t.literal)(e[0])}`)}else if("phone"===e){let e=(0,s.stringRange)(r);e[1]?u.push(`phone >= ${(0,t.literal)(e[0])} AND phone < ${(0,t.literal)(e[1])}`):u.push(`phone >= ${(0,t.literal)(e[0])}`)}else if("id"===e)u.push(`id = ${(0,t.literal)(r)}`);else if("name"===e){let e=(0,s.stringRange)(r);e[1]?u.push(`raw_user_meta_data->>'name' >= ${(0,t.literal)(e[0])} AND raw_user_meta_data->>'name' < ${(0,t.literal)(e[1])}`):u.push(`raw_user_meta_data->>'name' >= ${(0,t.literal)(e[0])}`)}}"verified"===i?u.push("(email_confirmed_at IS NOT NULL OR phone_confirmed_at IS NOT NULL)"):"anonymous"===i?u.push("is_anonymous IS TRUE"):"unverified"===i&&u.push("(email_confirmed_at IS NULL AND phone_confirmed_at IS NULL)"),n&&n.length>0&&(n.includes("saml 2.0")?u.push(`(SELECT jsonb_agg(CASE WHEN value ~ '^sso' THEN 'sso' ELSE value END) FROM jsonb_array_elements_text((raw_app_meta_data ->> 'providers')::jsonb)) ?| array[${n.map(e=>(0,t.literal)("saml 2.0"===e?"sso":e)).join(", ")}]`):u.push(`(raw_app_meta_data->>'providers')::jsonb ?| array[${n.map(e=>(0,t.literal)(e)).join(", ")}]`));let h=l??"created_at",m=o??"desc";if(d){let e="desc"===m?"<":">";"id"===h?u.push(`id ${e} ${(0,t.literal)(d.id)}::uuid`):u.push(`(${(0,t.ident)(h)}, id) ${e} (${(0,t.literal)(d.sort)}, ${(0,t.literal)(d.id)}::uuid)`)}let p=u.map(e=>`(${e})`).join(" AND "),x=u.length>0?`WHERE ${p}`:"",g="id"===h?`${(0,t.ident)(h)} ${m}`:`${(0,t.ident)(h)} ${m}, id ${m}`,f=`
    SELECT
      auth.users.id,
      auth.users.email,
      auth.users.banned_until,
      auth.users.created_at,
      auth.users.confirmed_at,
      auth.users.confirmation_sent_at,
      auth.users.is_anonymous,
      auth.users.is_sso_user,
      auth.users.invited_at,
      auth.users.last_sign_in_at,
      auth.users.phone,
      auth.users.raw_app_meta_data,
      auth.users.raw_user_meta_data
    FROM
      auth.users
    ${x}
    ORDER BY
      ${g}
    LIMIT
      ${c}`;return`
WITH
  users_data AS (${f})
SELECT
  *,
  COALESCE(
    (
      SELECT
        array_agg(DISTINCT i.provider)
      FROM
        auth.identities i
      WHERE
        i.user_id = users_data.id
    ),
    '{}'::text[]
  ) AS providers
FROM
  users_data;`.trim()})({column:c??"email",keywords:i,verified:r,providers:n,sort:l,order:o,limit:d,cursor:h});let p=e*d,x=[];if(i&&""!==i){let e=`%${i}%`;x.push(`id::text like ${(0,t.literal)(e)} or email like ${(0,t.literal)(e)} or phone like ${(0,t.literal)(e)} or raw_user_meta_data->>'full_name' ilike ${(0,t.literal)(e)} or raw_user_meta_data->>'first_name' ilike ${(0,t.literal)(e)} or raw_user_meta_data->>'last_name' ilike ${(0,t.literal)(e)} or raw_user_meta_data->>'display_name' ilike ${(0,t.literal)(e)}`)}"verified"===r?x.push("email_confirmed_at IS NOT NULL or phone_confirmed_at IS NOT NULL"):"anonymous"===r?x.push("is_anonymous is true"):"unverified"===r&&x.push("email_confirmed_at IS NULL AND phone_confirmed_at IS NULL"),n&&n.length>0&&(n.includes("saml 2.0")?x.push(`(select jsonb_agg(case when value ~ '^sso' then 'sso' else value end) from jsonb_array_elements_text((raw_app_meta_data ->> 'providers')::jsonb)) ?| array[${n.map(e=>(0,t.literal)("saml 2.0"===e?"sso":e)).join(", ")}]`.trim()):x.push(`(raw_app_meta_data->>'providers')::jsonb ?| array[${n.map(e=>(0,t.literal)(e)).join(", ")}]`));let g=x.map(e=>`(${e})`).join(" and "),f=o??"desc",_=`${x.length>0?` where ${g}`:""}
    order by
      ${(0,t.ident)(l??"created_at")} ${f} nulls last
    limit
      ${d}
    offset
      ${p}
  `,j=u?">":">=";if("email"===c){let e=(0,s.stringRange)(i??"");_=`where lower(email) ${j} ${(0,t.literal)(u||e[0])} ${e[1]?`and lower(email) < ${(0,t.literal)(e[1])}`:""} and instance_id = '00000000-0000-0000-0000-000000000000'::uuid order by instance_id, lower(email) asc limit ${d}`}else if("phone"===c){let e=(0,s.stringRange)(i??"");_=`where phone ${j} ${(0,t.literal)(u||e[0])} ${e[1]?`and phone < ${(0,t.literal)(e[1])}`:""} order by phone asc limit ${d}`}else"id"===c&&(_=(0,s.prefixToUUID)(i??"",!1)===i?`where id = ${(0,t.literal)(i)} order by id asc limit ${d}`:`where id ${j} ${(0,t.literal)(u||(0,s.prefixToUUID)(i??"",!1))} and id < ${(0,t.literal)((0,s.prefixToUUID)(i??"",!0))} order by id asc limit ${d}`);let v=`
    select
      auth.users.id,
      auth.users.email,
      auth.users.banned_until,
      auth.users.created_at,
      auth.users.confirmed_at,
      auth.users.confirmation_sent_at,
      auth.users.is_anonymous,
      auth.users.is_sso_user,
      auth.users.invited_at,
      auth.users.last_sign_in_at,
      auth.users.phone,
      auth.users.raw_app_meta_data,
      auth.users.raw_user_meta_data,
      auth.users.updated_at
    from
      auth.users
    ${_}`;return`
with
  users_data as (${v})
select
  *,
  coalesce(
    (
      select
        array_agg(distinct i.provider)
      from
        auth.identities i
      where
        i.user_id = users_data.id
    ),
    '{}'::text[]
  ) as providers
from
  users_data;
  `.trim()})({page:x?void 0:n,verified:u,keywords:c,providers:h,sort:m??"id",order:p??"asc",limit:50,column:x,startAt:x?n:void 0,cursor:g?n:void 0,improvedSearchEnabled:g})},r),enabled:f&&void 0!==e&&v,initialPageParam:void 0,getNextPageParam(e,t){if(!(e.result.length>=50))return;let s=e.result[e.result.length-1];if(s)return g?{sort:s[m??"created_at"],id:s.id}:x?s[x]:t.length},..._})}],258732)},959076,e=>{"use strict";function t(e,t){let s="00000000-0000-0000-0000-000000000000".split("").map((t,s)=>"-"===t?t:e[s]??t);if(e.length>=s.length)return s.join("");if(e.length&&e.length<15&&(s[14]="4"),e.length&&e.length<20&&(s[19]=t?"b":"8"),t)for(let t=e.length;t<s.length;t+=1)"0"===s[t]&&(s[t]="f");return s.join("")}function s(e){if(!e)return[e,void 0];let t=e.charCodeAt(e.length-1);if(122===t)return[e,e+"~"];if(t>=126)return[e,e+" "];let s=e.substring(0,e.length-1)+String.fromCharCode(t+1);return[e,s]}e.s(["prefixToUUID",()=>t,"stringRange",()=>s])},644131,e=>{"use strict";var t=e.i(81798);e.s(["ContextMenuSeparator_Shadcn_",()=>t.ContextMenuSeparator])},583369,e=>{"use strict";let t=(0,e.i(388019).default)("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);e.s(["default",()=>t])},71011,e=>{"use strict";var t=e.i(478902),s=e.i(55956),a=e.i(816467),r=e.i(211570),i=e.i(289937),i=i,n=e.i(591385),l=e.i(10429),o=e.i(34411),d=e.i(843778),c=e.i(62307),u=e.i(756441),h=e.i(917134),m=e.i(644131),p=e.i(794965),x=e.i(375761),g=e.i(441730),f=e.i(88816),_=e.i(170169),j=e.i(583369),j=j,v=e.i(389959),y=e.i(837710),b=e.i(874311);let N=({col:e,specificFilterColumn:s,setSortByValue:a})=>{let r=(0,v.useRef)(0),[i,n]=(0,v.useState)(!1);return(0,v.useEffect)(()=>{r.current=Number(new Date)},[i]),(0,t.jsxs)("div",{className:"flex items-center justify-between font-normal text-xs w-full",children:[(0,t.jsx)("div",{className:"flex items-center gap-x-2",children:(0,t.jsx)("p",{className:"!text-foreground",children:e.name})}),"freeform"===s&&["created_at","email","phone"].includes(e.id)&&(0,t.jsxs)(b.DropdownMenu,{open:i,onOpenChange:e=>{!1===e&&Number(new Date)-r.current>100&&n(e)},children:[(0,t.jsx)(b.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(y.Button,{type:"text",icon:(0,t.jsx)(f.ChevronDown,{}),className:"p-0 h-5 w-5",onClick:()=>n(!i)})}),(0,t.jsxs)(b.DropdownMenuContent,{className:"w-36",children:[(0,t.jsxs)(b.DropdownMenuItem,{className:"flex items-center gap-x-2",onClick:()=>{n(!1),a(`${e.id}:desc`)},children:[(0,t.jsx)(j.default,{size:14}),"Sort descending"]}),(0,t.jsxs)(b.DropdownMenuItem,{className:"flex items-center gap-x-2",onClick:()=>{n(!1),a(`${e.id}:asc`)},children:[(0,t.jsx)(_.SortAsc,{size:14}),"Sort ascending"]})]})]})]})},S="https://avatars.githubusercontent.com",w=[S,"https://lh3.googleusercontent.com"],k=[{email:"email-icon2"},{apple:"apple-icon"},{azure:"microsoft-icon"},{bitbucket:"bitbucket-icon"},{discord:"discord-icon"},{facebook:"facebook-icon"},{figma:"figma-icon"},{github:"github-icon"},{gitlab:"gitlab-icon"},{google:"google-icon"},{kakao:"kakao-icon"},{keycloak:"keycloak-icon"},{linkedin_oidc:"linkedin-icon"},{notion:"notion-icon"},{twitch:"twitch-icon"},{twitter:"twitter-icon"},{x:"x-icon-light"},{slack_oidc:"slack-icon"},{slack:"slack-icon"},{spotify:"spotify-icon"},{workos:"workos-icon"},{zoom:"zoom-icon"}],C=[{twilio:"twilio-icon"},{messagebird:"messagebird-icon"},{textlocal:"messagebird-icon"},{vonage:"messagebird-icon"},{twilioverify:"twilio-verify-icon"}],E=Object.values([...k,...C]).reduce((e,t)=>{let[[s,a]]=Object.entries(t);return{...e,[s]:a}},{}),$=k.map(e=>{let[t]=Object.keys(e);return t}),A=C.map(e=>{let[t]=Object.keys(e);return t});function D(e){if(e){if("string"==typeof e)return e;if(Array.isArray(e))return e.map(e=>D(e)).join(" ");try{return JSON.stringify(e)}catch(e){}}}function T(e,t="-"){let{custom_claims:s,displayName:a,display_name:r,fullName:i,full_name:n,familyName:l,family_name:o,givenName:d,given_name:c,surname:u,lastName:h,last_name:m,firstName:p,first_name:x,name:g}=e.raw_user_meta_data??{},{displayName:f,display_name:_,fullName:j,full_name:v,familyName:y,family_name:b,givenName:N,given_name:S,surname:w,lastName:k,last_name:C,firstName:E,first_name:$}=s??{},A=D(l||o||u||h||m||y||b||w||k||C),L=D(d||c||p||x||N||S||E||$);return D(g||a||r||f||_||i||n||j||v||L&&A&&`${L} ${A}`||A||L)||t}function L(e){let{avatarUrl:t,avatarURL:s,avatar_url:a,profileUrl:r,profileURL:i,profile_url:n,profileImage:l,profile_image:o,profileImageUrl:d,profileImageURL:c,profile_image_url:u}=e.raw_user_meta_data??{},h=t||s||a||l||o||r||i||n||d||c||u||"";if("string"!=typeof h)return;let m=w.some(e=>h.startsWith(e));try{let e=new URL(h);return e.searchParams.set("s","24"),m?h.startsWith(S)?e.href:h:void 0}catch(e){return m?h:void 0}}e.s(["formatUserColumns",0,({specificFilterColumn:e,columns:l,config:f,users:_,visibleColumns:j=[],setSortByValue:v,onSelectDeleteUser:y})=>{let b=f.map(e=>e.id)??l.map(e=>e.id),S=l.map(l=>{let j=f.find(e=>e.id===l.id);return{key:l.id,name:l.name,resizable:l.resizable??!0,sortable:!1,draggable:!0,width:j?.width??l.width,minWidth:l.minWidth??120,headerCellClass:"z-50 outline-none !shadow-none",renderHeaderCell:()=>{if("img"!==l.id)return(0,t.jsx)(N,{col:l,specificFilterColumn:e,setSortByValue:v})},renderCell:({row:e})=>{let[f,j]=(0,n.useRowSelection)(),v=e?.[l.id],b=_?.find(t=>t.id===e.id),N=null!==v&&["created_at","last_sign_in_at"].includes(l.id)?(0,s.default)(v).format("ddd DD MMM YYYY HH:mm:ss [GMT]ZZ"):Array.isArray(v)?"providers"===l.id?v.map(e=>{let t=g.PROVIDERS_SCHEMAS.find(t=>"key"in t&&t.key===e||t.title.toLowerCase()===e);return t?.title}).join(", "):v.join(", "):v,S=!!b?.confirmed_at;return"img"===l.id?(0,t.jsxs)("div",{className:"flex items-center justify-center gap-x-2",children:[(0,t.jsx)(o.Checkbox_Shadcn_,{checked:f,onClick:t=>{t.stopPropagation(),j({row:e,type:"ROW",checked:!f,isShiftClick:t.shiftKey})}}),(0,t.jsx)("div",{className:(0,d.cn)("flex items-center justify-center w-6 h-6 rounded-full bg-center bg-cover bg-no-repeat",e.img?"border":"bg-selection"),style:{backgroundImage:e.img?`url('${e.img}')`:"none"},children:!e.img&&(0,t.jsx)(i.default,{size:12})})]}):(0,t.jsxs)(c.ContextMenu_Shadcn_,{children:[(0,t.jsx)(p.ContextMenuTrigger_Shadcn_,{asChild:!0,children:(0,t.jsxs)("div",{className:(0,d.cn)("w-full flex items-center text-xs",l.id.includes("provider")?"capitalize":""),children:["providers"===l.id&&e.provider_icons.map((s,a)=>{let r=e.providers[a];return(0,t.jsx)("div",{className:"min-w-6 min-h-6 rounded-full border flex items-center justify-center bg-surface-75",style:{marginLeft:0===a?0:"-8px",zIndex:e.provider_icons.length-a},children:(0,t.jsx)("img",{width:16,src:s,alt:`${r} auth icon`,className:(0,d.cn)(("github"===r||"x"===r)&&"dark:invert")},`${b?.id}-${r}`)})}),"last_sign_in_at"!==l.id||S?(0,t.jsx)("p",{className:(0,d.cn)("providers"===l.id&&"ml-1"),children:null===N?"-":N}):(0,t.jsx)("p",{className:"text-foreground-lighter",children:"Waiting for verification"})]})}),(0,t.jsxs)(u.ContextMenuContent_Shadcn_,{onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)(h.ContextMenuItem_Shadcn_,{className:"gap-x-2",onFocusCapture:e=>e.stopPropagation(),onSelect:()=>{let t="providers"===l.id?e.providers.join(", "):N;(0,x.copyToClipboard)(t)},children:[(0,t.jsx)(a.Copy,{size:12}),(0,t.jsxs)("span",{children:["Copy ","id"===l.id?l.name:l.name.toLowerCase()]})]}),(0,t.jsx)(m.ContextMenuSeparator_Shadcn_,{}),(0,t.jsxs)(h.ContextMenuItem_Shadcn_,{className:"gap-x-2",onFocusCapture:e=>e.stopPropagation(),onSelect:()=>{b&&y(b)},children:[(0,t.jsx)(r.Trash,{size:12}),(0,t.jsx)("span",{children:"Delete user"})]})]})]})}}}),w=S.find(e=>"img"===e.key);return b.length>0&&(S=S.filter(e=>b.includes(e.key)).sort((e,t)=>b.indexOf(e.key)-b.indexOf(t.key))),0===j.length?S:[w].concat(S.filter(e=>j.includes(e.key)))},"formatUsersData",0,e=>e.map(e=>{let t=e.raw_app_meta_data?.provider??"",s=e.providers.map(e=>e.startsWith("sso")?"SAML":e);return{id:e.id,email:e.email,phone:e.phone,created_at:e.created_at,last_sign_in_at:e.last_sign_in_at,providers:e.is_anonymous?"-":s,provider_icons:s.map(e=>"email"===e?`${l.BASE_PATH}/img/icons/email-icon2.svg`:"SAML"===e?`${l.BASE_PATH}/img/icons/saml-icon.svg`:E[e]?`${l.BASE_PATH}/img/icons/${E[e]}.svg`:void 0).filter(Boolean),provider_type:e.is_anonymous?"Anonymous":"email"===t?"-":$.includes(t)?"Social":A.includes(t)?"Phone":"-",img:L(e),name:T(e)}}),"getAvatarUrl",()=>L,"getDisplayName",()=>T,"providerIconMap",0,E],71011)},883668,e=>{"use strict";var t=e.i(478902),s=e.i(389959),a=e.i(201461),r=e.i(874311),i=e.i(843778),n=e.i(896975);let l=({isSelected:e=!1})=>{let{resolvedTheme:s}=(0,n.useTheme)();return(0,t.jsx)("svg",{width:"53",height:"17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsxs)("g",{opacity:e?"1":".5",children:[(0,t.jsx)("rect",{x:"37.161",y:".53",width:"15",height:"15",rx:"5.5",stroke:"light"===s?"#11181C":"#EDEDED"}),(0,t.jsx)("path",{d:"M1 10.53h32.214",stroke:"#33A7E9",strokeLinecap:"round",strokeDasharray:"2 2"}),(0,t.jsx)("rect",{x:"15.964",y:".53",width:"9",height:"15",rx:"4.5",stroke:"light"===s?"#7E868C":"#7E7E7E"}),(0,t.jsx)("path",{d:"M1 5.53h32.214",stroke:"#33A7E9",strokeLinecap:"round",strokeDasharray:"2 2"})]})})},o=({isSelected:e=!1})=>{let{resolvedTheme:s}=(0,n.useTheme)();return(0,t.jsx)("svg",{width:"53",height:"17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsxs)("g",{opacity:e?"1":".5",children:[(0,t.jsx)("path",{d:"M1 4.994a.5.5 0 0 0 0 1v-1Zm16.218 1h.5v-1h-.5v1ZM1 5.994h1.014v-1H1v1Zm3.04 0h2.028v-1H4.041v1Zm4.056 0h2.027v-1H8.096v1Zm4.054 0h2.027v-1H12.15v1Zm4.055 0h1.013v-1h-1.013v1Z",fill:"light"===s?"#7E868C":"#7E7E7E"}),(0,t.jsx)("path",{d:"m15.92 12.56 9.04-9.04",stroke:"light"===s?"#11181C":"#EDEDED"}),(0,t.jsx)("rect",{x:"15.964",y:".494",width:"9",height:"15",rx:"4.5",stroke:"light"===s?"#11181C":"#EDEDED"}),(0,t.jsx)("rect",{x:"37.161",y:".744",width:"15",height:"15",rx:"5.5",stroke:"light"===s?"#11181C":"#EDEDED"}),(0,t.jsx)("path",{d:"M1 10.494h32.214",stroke:"#33A7E9",strokeLinecap:"round",strokeDasharray:"2 2"}),(0,t.jsx)("path",{d:"M15.96 7.562 22.568.956M19.049 14.885l5.957-5.958",stroke:"light"===s?"#11181C":"#EDEDED"})]})})},d=({isSelected:e=!1})=>{let{resolvedTheme:s}=(0,n.useTheme)();return(0,t.jsx)("svg",{width:"68",height:"17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsxs)("g",{opacity:e?"1":".5",children:[(0,t.jsx)("path",{d:"M15.63 5.156a.5.5 0 1 0 0 1v-1Zm16.218 1h.5v-1h-.5v1Zm-16.218 0h1.013v-1H15.63v1Zm3.04 0h2.028v-1h-2.027v1Zm4.055 0h2.028v-1h-2.028v1Zm4.055 0h2.027v-1H26.78v1Zm4.055 0h1.013v-1h-1.013v1Z",fill:"light"===s?"#7E868C":"#7E7E7E"}),(0,t.jsx)("path",{d:"m30.55 12.722 9.04-9.04",stroke:"light"===s?"#11181C":"#EDEDED"}),(0,t.jsx)("rect",{x:"30.594",y:".656",width:"9",height:"15",rx:"4.5",stroke:"light"===s?"#11181C":"#EDEDED"}),(0,t.jsx)("rect",{x:"51.791",y:".906",width:"15",height:"15",rx:"5.5",stroke:"light"===s?"#11181C":"#EDEDED"}),(0,t.jsx)("path",{d:"M15.63 10.656h32.214",stroke:"#33A7E9",strokeLinecap:"round",strokeDasharray:"2 2"}),(0,t.jsx)("path",{d:"m30.59 7.724 6.607-6.606M33.679 15.047l5.957-5.958",stroke:"light"===s?"#11181C":"#EDEDED"}),(0,t.jsx)("path",{d:"M12.666 14.281v-1.333A2.667 2.667 0 0 0 10 10.28H6a2.667 2.667 0 0 0-2.667 2.667v1.333M8 7.615A2.667 2.667 0 1 0 8 2.28a2.667 2.667 0 0 0 0 5.334Z",stroke:"light"===s?"#11181C":"#EDEDED",strokeLinecap:"round",strokeLinejoin:"round"})]})})};var c=e.i(370410),u=e.i(725990);let h=function({label:e,value:s,isSelected:a,onSelectedChange:r,icon:n}){return(0,t.jsxs)("label",{className:(0,i.cn)("border border-default rounded-md bg-surface-200 hover:bg-overlay-hover hover:border-control px-4 py-3 w-44 cursor-pointer transition-colors",a&&"border-foreground-muted hover:border-foreground-muted bg-surface-300"),tabIndex:0,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&r(s)},htmlFor:`role-${s}`,children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[n&&(0,t.jsx)("div",{children:n}),a&&(0,t.jsxs)("div",{className:"flex items-center justify-center p-0.5 bg-foreground text-background rounded-full",children:["boolean"==typeof a&&(0,t.jsx)(c.Check,{size:12,strokeWidth:"4",className:"text-background"}),"partially"===a&&(0,t.jsx)(u.Minus,{size:12,strokeWidth:"4",className:"text-background"})]})]}),(0,t.jsx)("input",{id:`role-${s}`,type:"radio",name:"role",value:s,checked:!!a,onChange:e=>{r(e.target.value)},className:"invisible h-0 w-0 border-0"}),(0,t.jsxs)("span",{className:(0,i.cn)("text-sm text-foreground-light whitespace-nowrap select-none transition-colors",a&&"text-foreground"),children:[e??s," role"]})]})};var m=e.i(202584),p=e.i(88816),x=e.i(659016),g=e.i(774803),f=e.i(366652),_=e.i(975924),j=e.i(355901),v=e.i(201844);e.i(128328);var y=e.i(947748),b=e.i(158639),N=e.i(567558),S=e.i(937942),w=e.i(258732),k=e.i(868118),C=e.i(14703),E=e.i(124416),$=e.i(635494),A=e.i(10429),D=e.i(837710),T=e.i(925282),L=e.i(774234),I=e.i(554855),M=e.i(171997),R=e.i(396831),O=e.i(290811),U=e.i(500850),P=e.i(283606),z=e.i(314805),H=e.i(408279),F=e.i(252387),W=e.i(71011);let Z=()=>{let[e,n]=(0,s.useState)(""),[l,o]=(0,s.useState)("aal1"),[d,c]=(0,s.useState)(""),[u,h]=(0,s.useState)(""),{id:x}=(0,b.useParams)(),[Z,B]=(0,s.useState)("user"),[Q,q]=(0,E.useLocalStorage)(y.LOCAL_STORAGE_KEYS.USER_IMPERSONATION_SELECTOR_PREVIOUS_SEARCHES(x),[]),J=(0,a.useRoleImpersonationStateSnapshot)(),G=(0,m.useDebounce)(e,300),{data:X}=(0,$.useSelectedProjectQuery)(),{data:ee,isSuccess:et,isPending:es,isError:ea,error:er,isFetching:ei,isPlaceholderData:en}=(0,w.useUsersInfiniteQuery)({projectRef:X?.ref,connectionString:X?.connectionString,keywords:G.trim().toLocaleLowerCase()},{placeholderData:v.keepPreviousData}),el=(0,s.useMemo)(()=>ee?.pages.flatMap(e=>e.result)??[],[ee?.pages]),eo=J.role?.type==="postgrest"&&"authenticated"===J.role.role&&"native"===J.role.userType&&J.role.user,ed=J.role?.type==="postgrest"&&"authenticated"===J.role.role&&"external"===J.role.userType&&J.role.externalAuth,ec=function(e){let{data:t}=(0,C.useAuthConfigQuery)({projectRef:e});return(0,s.useMemo)(()=>(function(e){if(e&&e.HOOK_CUSTOM_ACCESS_TOKEN_ENABLED)return(0,k.extractMethod)(e.HOOK_CUSTOM_ACCESS_TOKEN_URI,e.HOOK_CUSTOM_ACCESS_TOKEN_SECRETS)})(t),[t])}(X?.ref),[eu,eh]=(0,s.useState)(!1);async function em(e){eh(!0),q(t=>[...t.filter(t=>t.id!==e.id),e].slice(-6)),ec?.type==="https"&&j.toast.info("Please note that HTTPS custom access token hooks are not yet supported in the dashboard.");try{await J.setRole({type:"postgrest",role:"authenticated",userType:"native",user:e,aal:l},ec)}catch(e){j.toast.error(`Failed to impersonate user: ${e.message}`)}eh(!1)}async function ep(){eh(!0);let e={};try{e=u?JSON.parse(u):{}}catch(e){j.toast.error("Invalid JSON in additional claims");return}try{await J.setRole({type:"postgrest",role:"authenticated",userType:"external",externalAuth:{sub:d,additionalClaims:e},aal:l},ec)}catch(e){j.toast.error(`Failed to impersonate user: ${e.message}`)}eh(!1)}function ex(){J.setRole(void 0)}let eg=eo?(0,W.getDisplayName)(eo,eo.email??eo.phone??eo.id??"Unknown"):ed?J.role.externalAuth.sub:void 0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"px-5 py-3",children:[(0,t.jsx)("p",{className:"text-foreground text-sm",children:eg?`Impersonating ${eg}`:"Impersonate a User"}),(0,t.jsx)("p",{className:"text-sm text-foreground-light",children:eo||ed?"Results will respect your database's Row-Level Security policies for this user.":"Select a user to respect your database's Row-Level Security policies for that particular user."}),eo&&(0,t.jsx)(K,{user:eo,onClick:ex,isImpersonating:!0,aal:l,isLoading:eu}),ed&&(0,t.jsx)(V,{sub:J.role.externalAuth.sub,onClick:ex,aal:l,isLoading:eu}),!eo&&!ed&&(0,t.jsxs)(U.Tabs_Shadcn_,{value:Z,onValueChange:e=>B(e),children:[(0,t.jsxs)(z.TabsList_Shadcn_,{className:"gap-x-3",children:[(0,t.jsx)(H.TabsTrigger_Shadcn_,{value:"user",children:"Project user"}),(0,t.jsxs)(H.TabsTrigger_Shadcn_,{value:"external",className:"gap-x-1.5",children:["External user",(0,t.jsx)(F.InfoTooltip,{side:"bottom",className:"flex flex-col gap-1 max-w-96",children:"Test RLS policies with external auth providers like Clerk or Auth0 by providing a user ID and optional claims."})]})]}),(0,t.jsx)(P.TabsContent_Shadcn_,{value:"user",children:(0,t.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,t.jsx)(M.Input,{size:"tiny",className:"table-editor-search border-none",icon:en&&ei?(0,t.jsx)(g.Loader2,{className:"animate-spin text-foreground-lighter",size:16,strokeWidth:1.5}):(0,t.jsx)(f.Search,{className:"text-foreground-lighter",size:16,strokeWidth:1.5}),placeholder:"Search by id, email, phone, or name...",onChange:e=>n(e.target.value),value:e,actions:e&&(0,t.jsx)(D.Button,{size:"tiny",type:"text",className:"px-1",onClick:()=>n(""),children:(0,t.jsx)(_.X,{size:12,strokeWidth:2})})}),es&&(0,t.jsxs)("div",{className:"flex flex-col gap-2 items-center justify-center h-24",children:[(0,t.jsx)(g.Loader2,{className:"animate-spin",size:24}),(0,t.jsx)("span",{className:"text-foreground-light",children:"Loading users..."})]}),ea&&(0,t.jsx)(N.default,{error:er,subject:"Failed to retrieve users"}),et&&(el.length>0?(0,t.jsx)("div",{children:(0,t.jsx)("ul",{className:"divide-y max-h-[150px] overflow-y-scroll",role:"list",children:el.map(e=>(0,t.jsx)("li",{role:"listitem",children:(0,t.jsx)(Y,{user:e,onClick:em,isLoading:eu})},e.id))})}):(0,t.jsx)("div",{className:"flex flex-col gap-2 items-center justify-center h-24",children:(0,t.jsx)("p",{className:"text-foreground-light text-xs",role:"status",children:"No users found"})})),(0,t.jsx)(t.Fragment,{children:Q.length>0&&(0,t.jsx)("div",{children:Q.length>0?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(T.Collapsible_Shadcn_,{className:"relative",children:[(0,t.jsx)(I.CollapsibleTrigger_Shadcn_,{className:"group font-normal p-0 [&[data-state=open]>div>svg]:!-rotate-180",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-1 w-full",children:[(0,t.jsx)("p",{className:"text-xs text-foreground-light group-hover:text-foreground transition",children:"Recents"}),(0,t.jsx)(p.ChevronDown,{className:"transition-transform duration-200",strokeWidth:1.5,size:14})]})}),(0,t.jsxs)(L.CollapsibleContent_Shadcn_,{className:"mt-1 flex flex-col gap-y-4",children:[(0,t.jsx)(D.Button,{size:"tiny",type:"text",className:"absolute right-0 top-0 py-2 hover:bg-muted flex items-center text",onClick:function(){q([])},children:(0,t.jsx)("span",{className:"flex items-center",children:"Clear"})}),(0,t.jsx)(R.ScrollArea,{className:(0,i.cn)(Q.length>3?"h-36":"h-auto"),children:(0,t.jsx)("ul",{className:"grid gap-2 ",children:Q.map(e=>(0,t.jsx)("li",{children:(0,t.jsx)(Y,{user:e,onClick:em})},e.id))})})]})]})}):(0,t.jsx)("div",{className:"p-4 text-center text-muted-foreground",children:"No recent searches"})})})]})}),(0,t.jsx)(P.TabsContent_Shadcn_,{value:"external",children:(0,t.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,t.jsx)(M.Input,{size:"small",layout:"horizontal",label:"External User ID",descriptionText:"The user ID from your external auth provider",placeholder:"e.g. user_abc123",value:d,onChange:e=>c(e.target.value)}),(0,t.jsx)(M.Input,{size:"small",layout:"horizontal",label:"Additional Claims (JSON)",descriptionText:"Optional: Add custom claims like org_id or roles",placeholder:'e.g. {"app_metadata": {"org_id": "org_456"}}',value:u,onChange:e=>h(e.target.value)}),(0,t.jsx)("div",{className:"flex items-center justify-end",children:(0,t.jsx)(D.Button,{type:"default",disabled:!d,onClick:ep,children:"Impersonate"})})]})})]})]}),eo||ed?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.DropdownMenuSeparator,{className:"m-0"}),(0,t.jsx)("div",{className:"px-5 py-2 flex flex-col gap-2 relative",children:(0,t.jsxs)(T.Collapsible_Shadcn_,{children:[(0,t.jsx)(I.CollapsibleTrigger_Shadcn_,{className:"group font-normal p-0 [&[data-state=open]>div>svg]:!-rotate-180",children:(0,t.jsxs)("div",{className:"flex items-center gap-x-1 w-full",children:[(0,t.jsx)("p",{className:"text-xs text-foreground-light group-hover:text-foreground transition",children:"Advanced options"}),(0,t.jsx)(p.ChevronDown,{className:"transition-transform duration-200",strokeWidth:1.5,size:14})]})}),(0,t.jsx)(L.CollapsibleContent_Shadcn_,{className:"mt-1 flex flex-col gap-y-4",children:(0,t.jsxs)("div",{className:"flex flex-row items-center gap-x-4 text-sm text-foreground-light",children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,t.jsx)("h3",{children:"MFA assurance level"}),(0,t.jsxs)(F.InfoTooltip,{side:"top",className:"max-w-96",children:["AAL1 verifies users via standard login methods, while AAL2 adds a second authentication factor. If you're not using MFA, you can leave this on AAL1. Learn more about MFA"," ",(0,t.jsx)(S.InlineLink,{href:`${A.DOCS_URL}/guides/auth/auth-mfa`,children:"here"}),"."]})]}),(0,t.jsxs)("div",{className:"flex flex-row items-center gap-x-2 text-xs font-bold",children:[(0,t.jsx)("p",{className:"aal1"===l?void 0:"text-foreground-lighter",children:"AAL1"}),(0,t.jsx)(O.Switch,{checked:"aal2"===l,onCheckedChange:function(){o(e=>"aal2"===e?"aal1":"aal2")}}),(0,t.jsx)("p",{className:"aal2"===l?void 0:"text-foreground-lighter",children:"AAL2"})]})]})})]})})]})]})},B=({onClick:e,aal:s,displayName:a,avatarUrl:r,isImpersonating:i=!1,isLoading:n=!1})=>(0,t.jsxs)("div",{className:"flex items-center gap-3 py-2 text-foreground",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 bg-surface-200 pr-4 pl-0.5 py-0.5 border rounded-full max-w-l",children:[r?(0,t.jsx)("img",{className:"rounded-full w-5 h-5",src:r,alt:a}):(0,t.jsx)("div",{className:"rounded-full w-[21px] h-[21px] bg-surface-300 border border-strong flex items-center justify-center",children:(0,t.jsx)(x.User,{size:12,strokeWidth:2})}),(0,t.jsxs)("span",{className:"text-sm truncate",children:[a," ",(0,t.jsx)("span",{className:"ml-2 text-foreground-lighter text-xs font-light",children:"aal2"===s?"AAL2":"AAL1"})]})]}),(0,t.jsx)(D.Button,{type:"default",onClick:e,disabled:n,loading:n,children:i?"Stop Impersonating":"Impersonate"})]}),K=({user:e,onClick:s,isImpersonating:a=!1,isLoading:r=!1,aal:i})=>{let n=(0,W.getAvatarUrl)(e),l=(0,W.getDisplayName)(e,e.email??e.phone??e.id??"Unknown")+(e.is_anonymous?" (anonymous)":"");return(0,t.jsx)(B,{onClick:()=>s(e),aal:i,displayName:l,avatarUrl:n,isImpersonating:a,isLoading:r})},V=({sub:e,onClick:s,aal:a,isLoading:r=!1})=>(0,t.jsx)(B,{onClick:s,aal:a,displayName:e,isImpersonating:!0,isLoading:r}),Y=({user:e,onClick:s,isImpersonating:a=!1,isLoading:r=!1})=>{let i=(0,W.getAvatarUrl)(e),n=e.email||e.phone,l=(0,W.getDisplayName)(e,""),o=e.is_anonymous,d=l&&l!==n;return(0,t.jsxs)("div",{className:"flex items-center justify-between py-1 text-foreground",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[i?(0,t.jsx)("img",{className:"rounded-full w-5 h-5",src:i,alt:l||n}):(0,t.jsx)("div",{className:"rounded-full w-[21px] h-[21px] bg-surface-300 border flex items-center justify-center text-foreground-lighter",children:(0,t.jsx)(x.User,{size:12,strokeWidth:2})}),(0,t.jsxs)("span",{className:"text-sm flex items-center gap-4",children:[n,d&&(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("span",{className:"text-foreground-lighter",children:[l,o?" (anonymous)":""]})}),(0,t.jsx)("span",{className:"text-foreground-light bg-surface-200 dark:bg-surface-400 rounded-md px-1 py-0.5 font-mono text-xs",children:e?.id?.slice(0,8)})]})]}),(0,t.jsx)(D.Button,{type:"default",onClick:()=>s(e),disabled:r,loading:r,children:a?"Stop Impersonating":"Impersonate"})]})};e.s(["RoleImpersonationSelector",0,({serviceRoleLabel:e,padded:n=!0,disallowAuthenticatedOption:c=!1})=>{let u=(0,a.useRoleImpersonationStateSnapshot)(),[m,p]=(0,s.useState)(()=>u.role?.type==="postgrest"&&("anon"===u.role.role||"authenticated"===u.role.role)?u.role.role:"service_role"),x=!!("authenticated"===m&&u.role?.type==="postgrest"&&"authenticated"===u.role.role&&("user"in u.role&&u.role.user||"externalAuth"in u.role&&u.role.externalAuth));function g(e){"service_role"===e&&u.setRole(void 0),"anon"===e&&u.setRole({type:"postgrest",role:e}),p(e)}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:(0,i.cn)("flex flex-col gap-3",n?"p-5":"pb-5"),children:[(0,t.jsx)("p",{className:"text-foreground text-base",children:"Database role settings"}),(0,t.jsx)("form",{onSubmit:e=>{e.preventDefault()},children:(0,t.jsxs)("fieldset",{className:"flex gap-3",children:[(0,t.jsx)(h,{value:"service_role",isSelected:"service_role"===m,onSelectedChange:g,label:e,icon:(0,t.jsx)(l,{isSelected:"service_role"===m})}),(0,t.jsx)(h,{value:"anon",isSelected:"anon"===m,onSelectedChange:g,icon:(0,t.jsx)(o,{isSelected:"anon"===m})}),!c&&(0,t.jsx)(h,{value:"authenticated",isSelected:"authenticated"===m&&(x||"partially"),onSelectedChange:g,icon:(0,t.jsx)(d,{isSelected:"authenticated"===m})})]})}),"service_role"===m&&(0,t.jsxs)("p",{className:"text-foreground-light text-sm",children:[(0,t.jsx)("span",{className:"text-foreground",children:"The default Postgres/superuser role"}),(0,t.jsx)("br",{}),"This has admin privileges and will bypass Row Level Security (RLS) policies."]}),"anon"===m&&(0,t.jsxs)("p",{className:"text-foreground-light text-sm",children:[(0,t.jsx)("span",{className:"text-foreground",children:'For "anonymous access"'}),(0,t.jsx)("br",{}),"This is the role which the API (PostgREST) will use when a user is not logged in. ",(0,t.jsx)("br",{}),"It will respect Row Level Security (RLS) policies."]}),"authenticated"===m&&(0,t.jsxs)("p",{className:"text-foreground-light text-sm",children:[(0,t.jsx)("span",{className:"text-foreground",children:'For "authenticated access"'}),(0,t.jsx)("br",{}),"This is the role which the API (PostgREST) will use when a user is logged in. ",(0,t.jsx)("br",{}),"It will respect Row Level Security (RLS) policies."]})]}),"authenticated"===m&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.DropdownMenuSeparator,{}),(0,t.jsx)(Z,{})]})]})}],883668)}]);

//# debugId=62c746ab-430d-942a-ac02-2dd81935e036
//# sourceMappingURL=e0f9fb751bee2f84.js.map