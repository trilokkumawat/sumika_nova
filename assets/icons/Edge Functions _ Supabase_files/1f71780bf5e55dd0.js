;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="6bff4594-ab9e-e32c-27b4-5eba19f51c9f")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,722168,e=>{"use strict";var t=e.i(478902),n=e.i(156054),s=e.i(271226),o=e.i(389959),i=e.i(202584);e.i(128328);var r=e.i(947748),a=e.i(158639),d=e.i(215618),l=e.i(124416),u=e.i(635494),c=e.i(432478),p=e.i(317040),h=e.i(441081),S=e.i(739409),b=e.i(63519),g=e.i(843778),m=e.i(710483),w=e.i(888738);e.s(["default",0,({id:e,snippetName:y,editorRef:A,monacoRef:C,autoFocus:E=!0,placeholder:f="",className:I,executeQuery:K,onHasSelection:L,onPrompt:M,onMount:T})=>{let N=(0,s.useRouter)(),{profile:R}=(0,c.useProfile)(),{ref:_,content:v}=(0,a.useParams)(),{data:O}=(0,u.useSelectedProjectQuery)(),j=(0,S.useSqlEditorV2StateSnapshot)(),q=(0,b.useTabsStateSnapshot)(),x=(0,p.useAiAssistantStateSnapshot)(),{openSidebar:D,toggleSidebar:P}=(0,h.useSidebarManagerSnapshot)(),[k]=(0,l.useLocalStorageQuery)(r.LOCAL_STORAGE_KEYS.SQL_EDITOR_INTELLISENSE,!0),[Y]=(0,l.useLocalStorageQuery)(r.LOCAL_STORAGE_KEYS.HOTKEY_SIDEBAR(d.SIDEBAR_KEYS.AI_ASSISTANT),!0),[Q,V]=(0,o.useState)(""),B=(0,i.useDebounce)(Q,1e3),G=j.snippets[e],F=G?.snippet.visibility==="project"&&G?.snippet.owner_id!==R?.id,U=(0,o.useRef)(K);U.current=K;let W=async(e,t)=>{A.current=e,C.current=t;let n=A.current.getModel();null!==n&&C.current.editor.setModelMarkers(n,"owner",[]),e.addAction({id:"run-query",label:"Run Query",keybindings:[t.KeyMod.CtrlCmd+t.KeyCode.Enter],contextMenuGroupId:"operation",contextMenuOrder:0,run:()=>{U.current()}}),e.addAction({id:"save-query",label:"Save Query",keybindings:[t.KeyMod.CtrlCmd+t.KeyCode.KeyS],contextMenuGroupId:"operation",contextMenuOrder:0,run:()=>{G&&j.addNeedsSaving(G.snippet.id)}}),e.addAction({id:"explain-code",label:"Explain Code",contextMenuGroupId:"operation",contextMenuOrder:1,run:()=>{let e=(A?.current).getModel().getValueInRange(A?.current?.getSelection());D(d.SIDEBAR_KEYS.AI_ASSISTANT),x.newChat({name:"Explain code section",sqlSnippets:[e],initialInput:"Can you explain this section to me in more detail?"})}}),e.addAction({id:"toggle-ai-assistant",label:"Toggle AI Assistant",keybindings:[t.KeyMod.CtrlCmd+t.KeyCode.KeyI],run:()=>{Y&&P(d.SIDEBAR_KEYS.AI_ASSISTANT)}}),M&&e.addAction({id:"generate-sql",label:"Generate SQL",keybindings:[t.KeyMod.CtrlCmd|t.KeyCode.KeyK],run:()=>{let t=e.getSelection(),n=e.getModel();if(!n||!t)return;let s=n.getLinesContent(),o=t.startLineNumber-1,i=t.endLineNumber,r=s.slice(0,o).join("\n")+"\n";M({selection:s.slice(o,i).join("\n"),beforeSelection:r,afterSelection:"\n"+s.slice(i).join("\n"),startLineNumber:t?.startLineNumber??0,endLineNumber:t?.endLineNumber??0})}}),e.onDidChangeCursorSelection(({selection:e})=>{L(e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn)}),E&&(1===e.getValue().length&&e.setPosition({lineNumber:1,column:2}),e.focus()),T?.(e)};function z(t){if(q.makeActiveTabPermanent(),e&&t){if(!G&&_&&void 0!==R&&void 0!==O){let n=(0,w.createSqlSnippetSkeletonV2)({idOverride:e,name:y,sql:t,owner_id:R?.id,project_id:O?.id});j.addSnippet({projectRef:_,snippet:n}),N.push(`/project/${_}/sql/${n.id}`,void 0,{shallow:!0})}V(t)}}return(0,o.useEffect)(()=>{if(B.length>0&&G){let t=G.snippet.isNotSavedInDatabaseYet;j.setSql({id:e,sql:Q,shouldInvalidate:t})}},[B]),(0,o.useEffect)(()=>{v&&v.length>0&&z(v)},[]),(0,t.jsxs)(t.Fragment,{children:[F&&(0,t.jsx)(m.Admonition,{type:"default",className:"rounded-none border-0 border-b",title:"Read-only snippet",description:"This snippet has been shared to the project and is only editable by the owner who created this snippet. You may duplicate this snippet into a personal copy by right clicking on the snippet and selecting “Duplicate query”."}),(0,t.jsx)(n.default,{className:(0,g.cn)(I,"monaco-editor"),theme:"supabase",onMount:W,onChange:z,defaultLanguage:"pgsql",defaultValue:G?.snippet.content?.sql,path:e,options:{tabSize:2,fontSize:13,placeholder:f,lineDecorationsWidth:0,readOnly:F,minimap:{enabled:!1},wordWrap:"on",padding:{top:4},suggest:{showMethods:k,showFunctions:k,showConstructors:k,showDeprecated:k,showFields:k,showVariables:k,showClasses:k,showStructs:k,showInterfaces:k,showModules:k,showProperties:k,showEvents:k,showOperators:k,showUnits:k,showValues:k,showConstants:k,showEnums:k,showEnumMembers:k,showKeywords:k,showWords:k,showColors:k,showFiles:k,showReferences:k,showFolders:k,showTypeParameters:k,showIssues:k,showUsers:k,showSnippets:k}}})]})}])},496981,e=>{e.n(e.i(722168))}]);

//# debugId=6bff4594-ab9e-e32c-27b4-5eba19f51c9f
//# sourceMappingURL=9bbfe53a005653f8.js.map