;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="da882070-87dd-1090-af41-e51d129a0c39")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,870152,e=>{"use strict";var t=e.i(532480);e.s(["InfoIcon",()=>t.default])},744507,526038,282237,940336,e=>{"use strict";var t=e.i(102291);e.s(["BarChartIcon",()=>t.default],744507);var r=e.i(388019);let i=(0,r.default)("GitCommitHorizontal",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]]);e.s(["GitCommitHorizontalIcon",()=>i],526038);let s=(0,r.default)("SquareTerminal",[["path",{d:"m7 11 2-2-2-2",key:"1lz0vl"}],["path",{d:"M11 13h4",key:"1p7l4v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}]]);e.s(["SquareTerminal",()=>s],282237);var a=e.i(478902),n=e.i(55956),o=e.i(389959),l=e.i(751883),c=e.i(834869);let d=e=>String(e).includes("."),u=(e,t)=>{if(0===t)return String(Math.round(e));let r=1/Math.pow(10,t);if(e>0&&e<r)return`<${r.toFixed(t)}`;if(e<0&&e>-r)return`>-${r.toFixed(t)}`;if(!d(e))return e.toLocaleString()+"."+"0".repeat(t);{let[r,i]=String(e).split(".");return Number(r).toLocaleString()+"."+i.slice(0,t)}};e.s(["formatPercentage",0,(e,t=2)=>{if(1e-6>Math.abs(e-100))return"100%";if(Number.isInteger(e))return`${e}%`;let r=u(e,t);if(r.startsWith("<")||r.startsWith(">"))return`${r}%`;if(r.includes(".")){let[e,i=""]=r.split(".");return`${e}.${i.padEnd(t,"0")}%`}return`${r}%`},"numberFormatter",0,(e,t=2)=>d(e)?u(e,t):e.toLocaleString(),"precisionFormatter",0,u,"timestampFormatter",0,(e,t=c.DateTimeFormats.FULL,r=!1)=>r?n.default.utc(e).format(t):(0,n.default)(e).format(t),"useChartSize",0,(e="normal",t={tiny:76,small:96,normal:160,large:280})=>{let r=t[e];return{Container:(0,o.useMemo)(()=>({className:e,children:t})=>(0,a.jsx)(l.ResponsiveContainer,{className:e,height:r,minHeight:r,width:"100%",children:t}),[e]),minHeight:r}},"useStacked",0,({data:e,xAxisKey:t,yAxisKey:r,stackKey:i,variant:s="values"})=>{let a=(0,o.useMemo)(()=>e?Object.entries(e.reduce((e,s)=>{let a=s[t],n=s[r],o=s[i];return e[a]||(e[a]={}),e[a][o]=n,e},{})).map(([e,r])=>({...r,[t]:Number.isNaN(Number(e))?e:Number(e)})):[],[JSON.stringify(e)]),n=(0,o.useMemo)(()=>Object.keys(a[0]||{}).filter(e=>e!==t&&e!==r).sort(),[JSON.stringify(a[0]||{})]),l=(0,o.useMemo)(()=>{if("percentages"===s)return a.map(e=>{let t=Object.entries(e),r=t.filter(([e,t])=>n.includes(e)).reduce((e,[t,r])=>e+r,0);return t.reduce((e,[t,i])=>n.includes(t)?{...e,[t]:0!==i?i/r:0}:{...e,[t]:i},{})})},[JSON.stringify(a)]);return{dataKeys:n,stackedData:a,percentagesStackedData:l}}],940336)},150401,e=>{"use strict";var t=e.i(389959);let r="supabase-chart-hover-sync-enabled",i="supabase-chart-tooltip-sync-enabled",s={hoveredIndex:null,hoveredChart:null,syncHover:!0,syncTooltip:!0},a=new Set;try{{let e=localStorage.getItem(r),t=localStorage.getItem(i);null!==e&&(s.syncHover=JSON.parse(e)),null!==t&&(s.syncTooltip=JSON.parse(t))}}catch(e){console.warn("Failed to load chart sync settings from localStorage:",e)}function n(e){let t=s;if(s={...s,...e},void 0!==e.syncHover)try{localStorage.setItem(r,JSON.stringify(s.syncHover))}catch(e){console.warn("Failed to save chart hover sync setting to localStorage:",e)}if(void 0!==e.syncTooltip)try{localStorage.setItem(i,JSON.stringify(s.syncTooltip))}catch(e){console.warn("Failed to save chart tooltip sync setting to localStorage:",e)}JSON.stringify(t)!==JSON.stringify(s)&&a.forEach(e=>e(s))}function o(e){let[r,i]=(0,t.useState)(s);(0,t.useEffect)(()=>{let e=e=>{i(e)};return a.add(e),()=>{a.delete(e)}},[]);let o=(0,t.useCallback)(t=>{s.syncHover?n({hoveredIndex:t,hoveredChart:null!==t?e:null}):i(r=>({...r,hoveredIndex:t,hoveredChart:null!==t?e:null}))},[e]),l=(0,t.useCallback)(()=>{s.syncHover?n({hoveredIndex:null,hoveredChart:null}):i(e=>({...e,hoveredIndex:null,hoveredChart:null}))},[]),c=(0,t.useCallback)(e=>{n({syncHover:e,...!1===e&&{syncTooltip:!1}})},[]),d=(0,t.useCallback)(e=>{n({syncTooltip:e,...!0===e&&{syncHover:!0}})},[]),u=r.hoveredChart===e,m=r.syncHover&&null!==r.hoveredChart&&!u;return{hoveredIndex:m||u?r.hoveredIndex:null,syncHover:r.syncHover,syncTooltip:r.syncTooltip,hoveredChart:r.hoveredChart,setHover:o,clearHover:l,setSyncHover:c,setSyncTooltip:d,isHovered:null!==r.hoveredIndex&&(u||m),isCurrentChart:u}}e.s(["useChartHoverState",()=>o])},414833,682679,e=>{"use strict";var t=e.i(478902),r=e.i(536068),i=e.i(843778);e.i(128328);var s=e.i(158639),a=e.i(215312),n=e.i(55956),o=e.i(48189),l=e.i(787845),c=e.i(744507),d=e.i(526038),u=e.i(870152),m=e.i(282237),p=e.i(210419),x=e.i(389959),h=e.i(587433),f=e.i(252387),g=e.i(940336),y=e.i(150401);let v=({format:e,highlightedValue:r,highlightedLabel:v,hideHighlightedValue:j=!1,hideHighlightedLabel:b=!1,hideHighlightArea:S=!1,title:N,minimalHeader:C=!1,hideChartType:k=!1,chartStyle:w="bar",onChartStyleChange:I,showMaxValue:_=!1,setShowMaxValue:P,docsUrl:T,syncId:M,data:B,xAxisKey:E,yAxisKey:A,xAxisIsDate:D=!0,displayDateInUtc:$,customDateFormat:R,valuePrecision:O=2,shouldFormatBytes:L=!1,isNetworkChart:F=!1,attributes:z,sql:H,titleTooltip:q,showNewBadge:U})=>{let{ref:G}=(0,s.useParams)(),{hoveredIndex:Y,isHovered:V}=(0,y.useChartHoverState)(M||"default"),[J,Q]=(0,x.useState)(r),[K,W]=(0,x.useState)(v);(0,x.useEffect)(()=>{if(M&&null!==Y&&V&&B&&E&&A){let e=B[Y];if(e){let t=e[A];if(z&&z.length>1){let r=z?.filter(e=>e.omitFromTotal||e.isMaxValue||"reference-line"===e.provider)?.map(e=>e.attribute)??[];t=Object.entries(e).filter(([e,t])=>"number"==typeof t&&"timestamp"!==e&&"period_start"!==e&&!r.includes(e)&&z.some(t=>t.attribute===e&&!1!==t.enabled)).reduce((e,[t,r])=>e+r,0)}Q(t);let r=v;if(D&&e[E]){let t;r=(t=e[E],$?(0,n.default)(t).utc():(0,n.default)(t)).format(R||"YYYY-MM-DD HH:mm:ss")}else e[E]&&(r=e[E]);W(r)}}else Q(r),W(v)},[Y,V,M,B,E,A,D,$,R,r,v,z]);let X=(0,t.jsxs)("div",{className:"flex flex-row items-center gap-x-2",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center gap-x-2",children:[(0,t.jsx)("h3",{className:"text-foreground-lighter "+(C?"text-xs":"text-sm"),children:N}),q&&(0,t.jsx)(f.InfoTooltip,{children:q})]}),T&&(0,t.jsx)(a.ButtonTooltip,{type:"text",className:"px-1",asChild:!0,tooltip:{content:{side:"top",text:"Read docs"}},children:(0,t.jsx)(p.default,{href:T,target:"_blank",children:(0,t.jsx)(u.InfoIcon,{className:"w-4 h-4 text-foreground-lighter"})})})]}),Z=(0,t.jsx)("h4",{className:`text-foreground text-xl font-normal ${C?"text-base":"text-2xl"}`,children:void 0!==J&&(t=>{if("number"!=typeof t)return t;if("function"==typeof e)return e(t);if(L){let e=F?Math.abs(t):t;return(0,o.formatBytes)(e,O)}if("%"===e)return(0,g.formatPercentage)(t,O);let r=(0,g.numberFormatter)(t,O);return"string"==typeof e&&e?`${r} ${e}`:r})(J)}),ee=(0,t.jsx)("h4",{className:"text-foreground-lighter text-xs",children:K});if(C)return(0,t.jsxs)("div",{className:(0,i.cn)("flex flex-row items-center gap-x-4",S&&"hidden"),style:{minHeight:"1.8rem"},children:[N&&X,(0,t.jsxs)("div",{className:"flex flex-row items-baseline gap-x-2",children:[void 0!==r&&!j&&Z,!b&&ee]})]});let et=void 0!==r&&!j;return(0,t.jsxs)("div",{className:(0,i.cn)("flex-grow flex justify-between items-start min-h-16",S&&"hidden"),children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[N&&X,U&&(0,t.jsx)(h.Badge,{variant:"success",children:"New"})]}),(0,t.jsxs)("div",{className:"h-4",children:[et&&Z,!b&&ee]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[H?(0,t.jsx)(a.ButtonTooltip,{type:"default",className:"px-1.5",asChild:!0,tooltip:{content:{side:"top",text:"Open in Log Explorer"}},children:(0,t.jsx)(p.default,{href:`/project/${G}/logs/explorer?q=${encodeURIComponent(H)}`,children:(0,t.jsx)(m.SquareTerminal,{className:"w-4 h-4 text-foreground-lighter"})})}):null,!k&&I&&(0,t.jsx)(a.ButtonTooltip,{type:"default",className:"px-1.5",icon:"bar"===w?(0,t.jsx)(l.Activity,{}):(0,t.jsx)(c.BarChartIcon,{}),onClick:()=>I("bar"===w?"line":"bar"),tooltip:{content:{side:"top",text:`View as ${"bar"===w?"line chart":"bar chart"}`}}}),P&&(0,t.jsx)(a.ButtonTooltip,{type:_?"default":"dashed",className:"px-1.5",icon:(0,t.jsx)(d.GitCommitHorizontalIcon,{className:_?"text-foreground-light":"text-foreground-lighter"}),onClick:()=>P(!_),tooltip:{content:{side:"top",text:`${_?"Hide":"Show"} limit`}}})]})]})};e.s(["ChartHeader",0,v],682679),e.s(["default",0,({attribute:e,message:s="No data to show",description:a,format:n,className:o="",size:l,isFullHeight:c=!1,titleTooltip:d,hideTotalPlaceholder:u=!1})=>{let{minHeight:m}=(0,g.useChartSize)(l);return(0,t.jsxs)("div",{className:(0,i.cn)(c&&"h-full"),children:[void 0!==e&&(0,t.jsx)(v,{title:e,format:n,highlightedValue:u?void 0:0,titleTooltip:d}),(0,t.jsxs)("div",{className:(0,i.cn)("border-control flex flex-grow w-full flex-col items-center justify-center space-y-2 border border-dashed text-center",c&&"h-full",o),style:{minHeight:m+20},children:[(0,t.jsx)(r.BarChart2,{size:20,className:"text-border-stronger"}),(0,t.jsxs)("div",{className:"px-1",children:[(0,t.jsx)("p",{className:"text-foreground-light text-xs",children:s}),a&&(0,t.jsx)("p",{className:"text-foreground-lighter text-xs",children:a})]})]})]})}],414833)},582391,e=>{"use strict";let t=(0,e.i(388019).default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["Edit2",()=>t],582391)},670447,470754,291653,e=>{"use strict";var t=e.i(478902),r=e.i(975924),i=e.i(837710),s=e.i(627069),a=e.i(843778),n=e.i(10429);e.s(["BannerCard",0,({onDismiss:e,children:o,className:l})=>(0,t.jsxs)(s.Card,{className:(0,a.cn)("relative overflow-hidden shadow-lg rounded-2xl",l),children:[(0,t.jsxs)("div",{className:"absolute -inset-16 z-0 opacity-100 pointer-events-none",children:[(0,t.jsx)("img",{src:`${n.BASE_PATH}/img/reports/bg-grafana-dark.svg`,alt:"Background pattern",className:"w-full h-full object-cover object-right hidden dark:block"}),(0,t.jsx)("img",{src:`${n.BASE_PATH}/img/reports/bg-grafana-light.svg`,alt:"Background pattern",className:"w-full h-full object-cover object-right dark:hidden"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-background-alternative to-transparent"})]}),(0,t.jsxs)(s.CardContent,{className:"relative z-10 p-6",children:[e&&(0,t.jsx)("div",{className:"absolute top-4 right-4 z-20",children:(0,t.jsx)(i.Button,{type:"text",size:"tiny",htmlType:"button",icon:(0,t.jsx)(r.X,{size:16,strokeWidth:1.5}),onClick:t=>{t.preventDefault(),e()},className:"opacity-75 hover:opacity-100 px-1","aria-label":"Close banner"})}),o]})]})],670447);var o=e.i(389959);let l=(0,o.createContext)(void 0),c=()=>{let e=(0,o.useContext)(l);if(!e)throw Error("useBannerStack must be used within BannerStackProvider");return e};e.s(["BannerStackProvider",0,({children:e})=>{let[r,i]=(0,o.useState)([]),s=(0,o.useCallback)(e=>{i(t=>t.some(t=>t.id===e.id)?t:[...t,e].sort((e,t)=>(t.priority??0)-(e.priority??0)))},[]),a=(0,o.useCallback)(e=>{i(t=>t.map(t=>t.id===e?{...t,isDismissed:!0}:t)),setTimeout(()=>{i(t=>t.filter(t=>t.id!==e))},300)},[]);return(0,t.jsx)(l.Provider,{value:{banners:r,addBanner:s,dismissBanner:a},children:e})},"useBannerStack",0,c],470754);var d=e.i(265100),u=e.i(809323);e.s(["BannerStack",0,()=>{let{banners:e}=c(),[r,i]=(0,o.useState)(!1),s=e.filter(e=>!e.isDismissed);return 0===s.length?null:(0,t.jsx)(d.motion.div,{className:"fixed bottom-4 right-4 z-50",onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),animate:{y:r?-8:0},transition:{type:"spring",stiffness:300,damping:25},children:(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)(u.AnimatePresence,{mode:"popLayout",children:s.map((e,n)=>{let o=0===n,l=s.length-1-n;return(0,t.jsx)(d.motion.div,{initial:{opacity:0,scale:.99,y:8},animate:{opacity:1,scale:r?1:1-.07*n,x:0,y:r?-(216*n):-(4*n)},exit:{opacity:0,scale:.99,y:8},transition:{type:"spring",stiffness:300,damping:30,delay:.25},onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),style:{position:o?"relative":"absolute",bottom:o?void 0:0,right:o?void 0:0,zIndex:30+l,transformOrigin:"center bottom"},className:(0,a.cn)("w-full max-w-72",!r&&0===n&&"pointer-events-none"),children:e.content},e.id)})})})})}],291653)},350106,e=>{"use strict";var t=e.i(478902);e.i(69870);var r=e.i(158639),i=e.i(670447),s=e.i(967052),a=e.i(124416);e.i(128328);var n=e.i(947748),o=e.i(587433),l=e.i(223173),c=e.i(389959),d=e.i(837710),u=e.i(210419),m=e.i(10429),p=e.i(470754);e.s(["BannerMetricsAPI",0,()=>{let{ref:e}=(0,r.useParams)(),x=(0,s.useTrack)(),{dismissBanner:h}=(0,p.useBannerStack)(),[,f]=(0,a.useLocalStorageQuery)(n.LOCAL_STORAGE_KEYS.OBSERVABILITY_BANNER_DISMISSED(e??""),!1);return(0,t.jsx)(i.BannerCard,{onDismiss:()=>{f(!0),h("metrics-api-banner"),x("metrics_api_banner_dismiss_button_clicked")},children:(0,t.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-y-2 items-start",children:[(0,t.jsx)(o.Badge,{variant:"success",className:"-ml-0.5 uppercase inline-flex items-center mb-2",children:"Beta"}),(0,t.jsx)("div",{className:"flex items-center gap-4",children:l.LOG_DRAIN_TYPES.filter(e=>"sentry"!==e.value).map(e=>(0,t.jsx)(c.default.Fragment,{children:c.default.cloneElement(e.icon,{height:20,width:20})},e.value))})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-y-1 mb-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Export Metrics to your dashboards"}),(0,t.jsx)("p",{className:"text-xs text-foreground-lighter text-balance",children:"Visualize over 200 database performance and health metrics with our Metrics API."})]}),(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsx)(d.Button,{type:"default",size:"tiny",asChild:!0,children:(0,t.jsx)(u.default,{href:`${m.DOCS_URL}/guides/telemetry/metrics`,target:"_blank",onClick:()=>x("metrics_api_banner_cta_button_clicked"),children:"Get started for free"})})})]})})}])},303213,e=>{"use strict";var t=e.i(478902),r=e.i(271226),i=e.i(389959),s=e.i(355901),a=e.i(420985),n=e.i(635494),o=e.i(48189),l=e.i(432478),c=e.i(837710),d=e.i(441345),u=e.i(171997),m=e.i(40892);e.s(["CreateReportModal",0,({visible:e,onCancel:p,afterSubmit:x})=>{let h=(0,r.useRouter)(),{profile:f}=(0,l.useProfile)(),{data:g}=(0,n.useSelectedProjectQuery)(),y=g?.ref??"default",v=(0,i.useMemo)(()=>{let{its:e,ite:t,isHelper:r,helperText:i}=h.query,s=new URLSearchParams;e&&"string"==typeof e&&s.set("its",e),t&&"string"==typeof t&&s.set("ite",t),r&&"string"==typeof r&&s.set("isHelper",r),i&&"string"==typeof i&&s.set("helperText",i);let a=s.toString();return a?`?${a}`:""},[h.query]),{mutate:j,isPending:b}=(0,a.useContentUpsertMutation)({onSuccess:(e,t)=>{s.toast.success("Successfully created new report");let r=t.payload.id;h.push(`/project/${y}/observability/${r}${v}`),x()},onError:e=>{s.toast.error(`Failed to create report: ${e.message}`)}});async function S({name:e,description:t}){return y?f?void j({projectRef:y,payload:{id:(0,o.uuidv4)(),type:"report",name:e,description:t||"",visibility:"project",owner_id:f?.id,content:{schema_version:1,period_start:{time_period:"7d",date:""},period_end:{time_period:"today",date:""},interval:"1d",layout:[]}}}):console.error("Profile is required"):console.error("Project ref is required")}return(0,t.jsx)(m.Modal,{visible:e,onCancel:p,hideFooter:!0,header:"Create a custom report",size:"small",children:(0,t.jsx)(d.Form,{onReset:p,validateOnBlur:!0,initialValues:{name:"",description:""},validate:e=>{let t={};return e.name||(t.name="Required"),t},onSubmit:e=>S(e),children:()=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(m.Modal.Content,{className:"space-y-4",children:[(0,t.jsx)(u.Input,{label:"Name",id:"name",name:"name"}),(0,t.jsx)(u.Input.TextArea,{label:"Description",id:"description",placeholder:"Describe your custom report",size:"medium",textAreaClassName:"resize-none"})]}),(0,t.jsx)(m.Modal.Separator,{}),(0,t.jsxs)(m.Modal.Content,{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(c.Button,{htmlType:"reset",type:"default",onClick:p,disabled:b,children:"Cancel"}),(0,t.jsx)(c.Button,{htmlType:"submit",loading:b,disabled:b,children:"Create report"})]})]})})})}])},212846,e=>{"use strict";var t=e.i(478902),r=e.i(389959);e.i(128328);var i=e.i(158639),s=e.i(947748),a=e.i(86086),n=e.i(902780),o=e.i(912793),l=e.i(951138),c=e.i(124416),d=e.i(350106),u=e.i(825713),m=e.i(902858),p=e.i(657588),x=e.i(303213),h=e.i(355901),f=e.i(420985),g=e.i(837710),y=e.i(441345),v=e.i(171997),j=e.i(40892);let b=({selectedReport:e,initialValues:r,onCancel:s})=>{let{ref:a}=(0,i.useParams)(),{mutate:n,isPending:o}=(0,f.useContentUpsertMutation)({onSuccess:()=>{h.toast.success("Successfully updated report"),s()},onError:e=>{h.toast.error(`Failed to update report: ${e.message}`)}});return(0,t.jsx)(j.Modal,{visible:void 0!==e,onCancel:s,hideFooter:!0,header:"Update custom report",size:"small",children:(0,t.jsx)(y.Form,{onReset:s,validateOnBlur:!0,initialValues:r,validate:function(e){let t={};return e.name||(t.name="This field is required"),t},onSubmit:t=>a?e&&e.id?void(e.project_id&&n({projectRef:a,payload:{...e,owner_id:e.owner_id,project_id:e.project_id,id:e.id,name:t.name,description:t.description||""}})):void 0:console.error("Project ref is required"),children:()=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.Modal.Content,{children:(0,t.jsx)(v.Input,{label:"Name",id:"name",name:"name"})}),(0,t.jsx)(j.Modal.Content,{children:(0,t.jsx)(v.Input.TextArea,{label:"Description",id:"description",placeholder:"Describe your custom report",size:"medium",textAreaClassName:"resize-none"})}),(0,t.jsx)(j.Modal.Separator,{}),(0,t.jsxs)(j.Modal.Content,{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(g.Button,{htmlType:"reset",type:"default",onClick:s,disabled:o,children:"Cancel"}),(0,t.jsx)(g.Button,{htmlType:"submit",loading:o,disabled:o,children:"Save custom report"})]})]})})})};var S=e.i(215312),N=e.i(586011),C=e.i(929461),k=e.i(2579),w=e.i(10429),I=e.i(432478),_=e.i(479232),P=e.i(210419),T=e.i(271226),M=e.i(533488),B=e.i(862326),E=e.i(843778),A=e.i(498377),D=e.i(466472),$=e.i(108151),R=e.i(582391),O=e.i(211570),L=e.i(471998),F=e.i(874311);let z=({item:e,pageKey:r,onSelectEdit:i,onSelectDelete:s})=>{let{profile:a}=(0,I.useProfile)(),{can:n}=(0,k.useAsyncCheckPermissions)(m.PermissionAction.UPDATE,"user_content",{resource:{type:"report",visibility:e.report.visibility,owner_id:e.report.owner_id},subject:{id:a?.id}});return(0,t.jsxs)(P.default,{className:(0,E.cn)("pr-2 h-7 pl-3 mt-1 text-foreground-light group-hover:text-foreground/80 text-sm","flex items-center justify-between rounded-md group relative",e.key===r?"bg-surface-300 text-foreground":"hover:text-foreground"),href:e.url,children:[(0,t.jsx)("div",{children:e.name}),n&&(0,t.jsxs)(F.DropdownMenu,{children:[(0,t.jsx)(F.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(g.Button,{type:"text",className:"px-1 opacity-50 hover:opacity-100",icon:(0,t.jsx)(L.MoreVertical,{size:12,strokeWidth:2}),onClick:e=>{e.preventDefault(),e.stopPropagation()}})}),(0,t.jsxs)(F.DropdownMenuContent,{align:"start",className:"w-32 *:gap-x-2",children:[(0,t.jsxs)(F.DropdownMenuItem,{onClick:t=>{t.preventDefault(),t.stopPropagation(),e.id&&i()},children:[(0,t.jsx)(R.Edit2,{size:12}),(0,t.jsx)("div",{children:"Rename report"})]}),(0,t.jsx)(F.DropdownMenuSeparator,{}),(0,t.jsxs)(F.DropdownMenuItem,{onClick:t=>{t.preventDefault(),t.stopPropagation(),e.id&&s()},children:[(0,t.jsx)(O.Trash,{size:12}),(0,t.jsx)("div",{children:"Delete report"})]})]})]})]},e.key+"-menukey")},H=()=>{let e=(0,T.useRouter)(),{profile:s}=(0,I.useProfile)(),{ref:a,id:n}=(0,i.useParams)(),l=n||e.pathname.split("/")[4]||"observability",c=(0,p.useFlag)("observabilityOverview"),d=(0,p.useFlag)("authreportv2"),u=(0,p.useFlag)("edgefunctionreport"),f=(0,p.useFlag)("realtimeReport"),g=(0,p.useFlag)("storagereport"),y=(0,p.useFlag)("postgrestreport"),v=(0,o.useIsFeatureEnabled)("project_storage:all"),{can:j}=(0,k.useAsyncCheckPermissions)(m.PermissionAction.CREATE,"user_content",{resource:{type:"report",owner_id:s?.id},subject:{id:s?.id}}),R=(0,r.useMemo)(()=>{let{its:t,ite:r,isHelper:i,helperText:s}=e.query,a=new URLSearchParams;t&&"string"==typeof t&&a.set("its",t),r&&"string"==typeof r&&a.set("ite",r),i&&"string"==typeof i&&a.set("isHelper",i),s&&"string"==typeof s&&a.set("helperText",s);let n=a.toString();return n?`?${n}`:""},[e.query]),{data:O,isPending:L}=(0,C.useContentQuery)({projectRef:a,type:"report"}),{mutate:F,isPending:H}=(0,N.useContentDeleteMutation)({onSuccess:()=>{U(!1),h.toast.success("Successfully deleted report"),e.push(`/project/${a}/observability`)},onError:e=>{h.toast.error(`Failed to delete report: ${e.message}`)}}),[q,U]=(0,r.useState)(!1),[G,Y]=(0,M.useQueryState)("newReport",M.parseAsBoolean.withDefault(!1).withOptions({history:"push",clearOnDefault:!0})),[V,J]=(0,r.useState)(),[Q,K]=(0,r.useState)();function W(e){return"report"===e.type}let X=function(){if(!O)return[];let e=O?.content.filter(W);return(e?.sort((e,t)=>e.name<t.name?-1:+(e.name>t.name))).map((e,t)=>({id:e.id,name:e.name,description:e.description||"",key:e.id||t+"-report",url:`/project/${a}/observability/${e.id}${R}`,hasDropdownActions:!0,report:e}))}(),Z=[{title:"GENERAL",key:"general-section",items:[...c?[{name:"Overview",key:"observability",url:`/project/${a}/observability${R}`}]:[],{name:"Query Performance",key:"query-performance",url:`/project/${a}/observability/query-performance${R}`},...w.IS_PLATFORM?[{name:"API Gateway",key:"api-overview",url:`/project/${a}/observability/api-overview${R}`}]:[]]},{title:"PRODUCT",key:"product-section",items:[...w.IS_PLATFORM?[{name:"Database",key:"database",url:`/project/${a}/observability/database${R}`}]:[],...y?[{name:"Data API",key:"postgrest",url:`/project/${a}/observability/postgrest${R}`}]:[],...d?[{name:"Auth",key:"auth",url:`/project/${a}/observability/auth${R}`}]:[],...u?[{name:"Edge Functions",key:"edge-functions",url:`/project/${a}/observability/edge-functions${R}`}]:[],...g&&v?[{name:"Storage",key:"storage",url:`/project/${a}/observability/storage${R}`}]:[],...f?[{name:"Realtime",key:"realtime",url:`/project/${a}/observability/realtime${R}`}]:[]]}];return(0,t.jsx)(B.Menu,{type:"pills",className:"mt-6",children:L?(0,t.jsxs)("div",{className:"px-5 my-4 space-y-2",children:[(0,t.jsx)($.ShimmeringLoader,{}),(0,t.jsx)($.ShimmeringLoader,{className:"w-3/4"}),(0,t.jsx)($.ShimmeringLoader,{className:"w-1/2"})]}):(0,t.jsxs)("div",{className:"flex flex-col gap-y-6",children:[Z.map((e,i)=>(0,t.jsxs)(r.Fragment,{children:[(0,t.jsx)("div",{className:"h-px w-full bg-border-overlay first:hidden"}),(0,t.jsx)("div",{children:e.items&&e.items.length>0?(0,t.jsxs)("div",{className:"px-2",children:[(0,t.jsx)(B.Menu.Group,{title:(0,t.jsx)("span",{className:"uppercase font-mono",children:e.title})}),(0,t.jsx)("div",{className:"flex flex-col",children:e.items.map(e=>(0,t.jsx)("li",{className:(0,E.cn)("pr-2 mt-1 text-foreground-light group-hover:text-foreground/80 text-sm","flex items-center justify-between rounded-md group relative",e.key===l?"bg-surface-300 text-foreground":"hover:text-foreground"),children:(0,t.jsx)(P.default,{href:e.url,className:"flex-grow h-7 flex justify-between items-center pl-3",children:(0,t.jsx)("span",{children:e.name})})},e.key))},e.key)]}):null})]},i)),w.IS_PLATFORM&&(0,t.jsxs)(r.Fragment,{children:[(0,t.jsx)("div",{className:"h-px w-full bg-border-overlay"}),(0,t.jsxs)("div",{className:"mx-2",children:[(0,t.jsx)(B.Menu.Group,{title:(0,t.jsxs)("span",{className:"flex w-full items-center justify-between relative h-6",children:[(0,t.jsx)("span",{className:"uppercase font-mono",children:"Custom Reports"}),X.length>0&&(0,t.jsx)(S.ButtonTooltip,{type:"default",size:"tiny",icon:(0,t.jsx)(_.Plus,{}),disabled:!j,className:"flex items-center justify-center h-6 w-6 absolute top-0 -right-1",onClick:()=>{Y(!0)},tooltip:{content:{side:"bottom",text:j?void 0:"You need additional permissions to create custom reports"}}})]})}),0===X.length?(0,t.jsx)("div",{className:"px-2",children:(0,t.jsx)(A.InnerSideBarEmptyPanel,{title:"No custom reports yet",description:"Create and save custom reports to track your project metrics",actions:(0,t.jsx)(S.ButtonTooltip,{type:"default",icon:(0,t.jsx)(_.Plus,{}),disabled:!j,onClick:()=>{Y(!0)},tooltip:{content:{side:"bottom",text:j?void 0:"You need additional permissions to create custom reports"}},children:"New custom report"})})}):(0,t.jsx)(t.Fragment,{children:X.map(e=>(0,t.jsx)(z,{item:e,pageKey:l,onSelectEdit:()=>{K(e.report)},onSelectDelete:()=>{J(e.report),U(!0)}},e.id))})]})]}),(0,t.jsx)(b,{onCancel:()=>K(void 0),selectedReport:Q,initialValues:{name:Q?.name||"",description:Q?.description||""}}),(0,t.jsx)(D.default,{title:"Delete custom report",confirmLabel:"Delete report",confirmLabelLoading:"Deleting report",size:"medium",loading:H,visible:q,onCancel:()=>U(!1),onConfirm:()=>void 0===a?console.error("Project ref is required"):V?.id===void 0?console.error("Report ID is required"):void F({projectRef:a,ids:[V.id]}),children:(0,t.jsx)("div",{className:"text-sm text-foreground-light grid gap-4",children:(0,t.jsx)("div",{className:"grid gap-1",children:(0,t.jsxs)("p",{children:["Are you sure you want to delete '",V?.name,"'?"]})})})}),(0,t.jsx)(x.CreateReportModal,{visible:G,onCancel:()=>Y(!1),afterSubmit:()=>Y(!1)})]})})};var q=e.i(470754),U=e.i(291653),G=e.i(742251),Y=e.i(888525);e.i(69870);var V=e.i(284399),J=e.i(967052),Q=e.i(924115),K=e.i(670447);let W=()=>{let e=(0,J.useTrack)(),{ref:r}=(0,i.useParams)(),{dismissBanner:a}=(0,q.useBannerStack)(),[,n]=(0,c.useLocalStorageQuery)(s.LOCAL_STORAGE_KEYS.INDEX_ADVISOR_NOTICE_DISMISSED(r??""),!1);return(0,t.jsx)(K.BannerCard,{onDismiss:()=>{n(!0),a("index-advisor-banner"),e("index_advisor_banner_dismiss_button_clicked")},children:(0,t.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,t.jsx)("div",{className:"flex flex-col gap-y-2 items-start",children:(0,t.jsx)("div",{className:"p-2 rounded-lg bg-warning-300 text-warning",children:(0,t.jsx)(Q.Lightbulb,{size:16})})}),(0,t.jsxs)("div",{className:"flex flex-col gap-y-1 mb-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Enable Index Advisor"}),(0,t.jsx)("p",{className:"text-xs text-foreground-lighter text-balance",children:"Recommends indexes to improve query performance."})]}),(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsx)(V.EnableIndexAdvisorButton,{})})]})})},X=({title:e,children:l})=>{let{ref:m}=(0,i.useParams)(),p=(0,G.usePathname)(),{addBanner:x,dismissBanner:h}=(0,q.useBannerStack)(),{isIndexAdvisorAvailable:f,isIndexAdvisorEnabled:g}=(0,Y.useIndexAdvisorStatus)(),[y]=(0,c.useLocalStorageQuery)(s.LOCAL_STORAGE_KEYS.OBSERVABILITY_BANNER_DISMISSED(m??""),!1),[v]=(0,c.useLocalStorageQuery)(s.LOCAL_STORAGE_KEYS.INDEX_ADVISOR_NOTICE_DISMISSED(m??""),!1);(0,r.useEffect)(()=>{!y&&a.IS_PLATFORM?x({id:"metrics-api-banner",isDismissed:!1,content:(0,t.jsx)(d.BannerMetricsAPI,{}),priority:1}):h("metrics-api-banner")},[y,x,h]);let j=(0,r.useRef)(p);(0,r.useEffect)(()=>{let e=p?.includes("/query-performance");e&&f&&!g&&!v?x({id:"index-advisor-banner",isDismissed:!1,content:(0,t.jsx)(W,{}),priority:3}):(v||!e||g)&&h("index-advisor-banner"),j.current=p},[p,f,g,v,x,h]);let{reportsAll:b}=(0,o.useIsFeatureEnabled)(["reports:all"]);return b?(0,t.jsx)(u.ProjectLayout,{title:e,product:"Observability",productMenu:(0,t.jsx)(H,{}),isBlocking:!1,children:l}):(0,t.jsx)(n.UnknownInterface,{urlBack:`/project/${m}`})},Z=(0,l.withAuth)(e=>{let{ref:r}=(0,i.useParams)(),{reportsAll:s}=(0,o.useIsFeatureEnabled)(["reports:all"]);return s?(0,t.jsxs)(q.BannerStackProvider,{children:[(0,t.jsx)(X,{...e}),(0,t.jsx)(U.BannerStack,{})]}):(0,t.jsx)(n.UnknownInterface,{urlBack:`/project/${r}`})});e.s(["default",0,Z],212846)}]);

//# debugId=da882070-87dd-1090-af41-e51d129a0c39
//# sourceMappingURL=df5756e30cd46a36.js.map