;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="7f584e57-2365-85a4-a870-74c324535507")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,513535,e=>{"use strict";var s=e.i(478902),t=e.i(902858),i=e.i(55956),a=e.i(210419),r=e.i(389959);e.i(128328);var n=e.i(158639),l=e.i(167892),c=e.i(567558),o=e.i(929603),d=e.i(693241),u=e.i(726398),m=e.i(129393),g=e.i(164045),x=e.i(540203),p=e.i(2579),h=e.i(3251),j=e.i(370410),f=e.i(88816),_=e.i(533488),y=e.i(837710),b=e.i(843778),N=e.i(917007),S=e.i(549815),v=e.i(710483),M=e.i(108151),C=e.i(286260),E=e.i(536068),P=e.i(368315),O=e.i(912793),U=e.i(10429),I=e.i(17203),R=e.i(587433);let T=({section:e,includedInPlan:t,children:i})=>{let{name:r,description:n,links:c}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.ScaffoldContainer,{children:(0,s.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-8 md:py-16",children:(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,s.jsx)("div",{className:"col-span-12 lg:col-span-5",children:(0,s.jsxs)("div",{className:"sticky top-32 space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{className:"text-base capitalize",children:r}),!1===t&&(0,s.jsx)(R.Badge,{children:"Not included"})]}),(0,s.jsx)("div",{className:"grid gap-4",children:n.split("\n").map((e,t)=>(0,s.jsx)("p",{className:"text-sm text-foreground-light pr-8",children:e},`desc-${t}`))})]}),c&&c.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-xs font-mono uppercase text-foreground-lighter mb-2",children:"More information"}),c.map(e=>(0,s.jsx)("div",{children:(0,s.jsx)(a.default,{href:e.url,target:"_blank",rel:"noreferrer",children:(0,s.jsxs)("div",{className:"inline-flex items-center space-x-2 text-foreground-light hover:text-foreground transition",children:[(0,s.jsx)("p",{className:"text-sm",children:e.name}),(0,s.jsx)(I.ExternalLink,{size:16,strokeWidth:1.5})]})})},e.url))]})]})}),(0,s.jsx)("div",{className:"col-span-12 lg:col-span-7 space-y-6",children:i})]})})}),(0,s.jsx)(l.ScaffoldDivider,{})]})};var k=e.i(492460);let L=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}),D=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];function w(e,s){if(!e||!e.usages.length)return[];let t=(0,k.default)(e.usages.filter(e=>s(e.metric)),"date"),a=[];return Object.entries(t).forEach(([e,s])=>{let t={period_start:e,periodStartFormatted:(0,i.default)(e).format("DD MMM")};for(let e of s)if(t[e.metric.toLowerCase()]=e.usage_original,e.breakdown)for(let[s,i]of Object.entries(e.breakdown))t[s.toLowerCase()]=i;a.push(t)}),a}var A=e.i(908204);let G=({orgDailyStats:e,isLoadingOrgDailyStats:t})=>{let{billingAll:i}=(0,O.useIsFeatureEnabled)(["billing:all"]),a=w(e,e=>e===m.PricingMetric.ACTIVE_COMPUTE_HOURS),n=(0,r.useMemo)(()=>a.some(e=>e.active_compute_hours&&Number(e.active_compute_hours)>0),[a]);return(0,s.jsx)("div",{id:"active-compute",className:"scroll-my-12",children:(0,s.jsxs)(T,{section:{name:"Active Compute Hours",description:"Amount of active compute hours your projects on scale-to-zero instances consumed. Projects on scale-to-zero instances automatically scale down after a 15m inactivity period.",links:i?[{name:"Learn more",url:`${U.DOCS_URL}/guides/integrations/supabase-for-platforms#pico-compute-instance`}]:[]},children:[t&&(0,s.jsx)(M.GenericSkeletonLoader,{}),!t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-1",children:[a.length>0&&(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsx)("p",{className:"text-sm",children:"Active Compute Hours usage"})})}),(0,s.jsxs)("div",{className:"flex items-center justify-between border-b last:border-b-0 py-1 last:py-0",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Active Compute Hours usage in period"}),(0,s.jsxs)("p",{className:"text-sm",children:[a.reduce((e,s)=>e+(s.active_compute_hours??0),0)," ","hours"]})]})]}),a.length>0&&n?(0,s.jsx)(A.default,{name:"Active Compute Hours usage",unit:"hours",attributes:[{key:"active_compute_hours",color:"blue"}],data:a,yMin:24}):(0,s.jsx)(P.default,{children:(0,s.jsx)(P.default.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)(E.BarChart2,{className:"text-foreground-light mb-2"}),(0,s.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to one hour to show"})]})})})]})]})})};var B=e.i(855168);let H=({title:e,description:t,className:i})=>(0,s.jsx)("div",{className:(0,b.cn)("mx-auto flex flex-col gap-10 py-14",i),children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xl",children:e}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:t})]})});var z=e.i(416304),$=e.i(217444),F=e.i(101369),Y=e.i(613580);let K=({slug:e,projectRef:t,attribute:i,usage:n,usageMeta:l,chartMeta:o,subscription:d,error:u,isLoading:m,isError:g,isSuccess:x,currentBillingCycleSelected:p})=>{let h=function(e,s,t){let{billingAll:i}=(0,O.useIsFeatureEnabled)(["billing:all"]);if(!i){let s=`Organization Slug: ${e}
Requested plan: <Specify which plan to upgrade to: Pro | Team | Enterprise | Platform>`;return`/support/new?orgSlug=${e}&projectRef=no-project&category=Plan_upgrade&subject=Enquiry to upgrade plan for organization&message=${encodeURIComponent(s)}`}return s?s?.plan?.id==="pro"&&s?.usage_billing_enabled===!1?`/org/${e}/billing#cost-control`:`/org/${e}/billing?panel=subscriptionPlan&source=usage${t}`:`/org/${e}/billing`}(e??"",d,i.key),j=(l?.usage??0)/(l?.pricing_free_units??0),f=(l?.usage??0)-(l?.pricing_free_units??0),_=d?.usage_billing_enabled,N=_?"text-amber-900":"text-red-900",S=(0,r.useMemo)(()=>o[i.key]?.data??[],[i.key,o]),v=void 0===t&&p&&!1===_&&j>=U.USAGE_APPROACHING_THRESHOLD,C=(0,r.useMemo)(()=>i.attributes?.map(e=>S.some(s=>0!==Number(s[e.key]))).some(e=>!!e)??!1,[i.attributes,S]);return(0,s.jsx)("div",{id:i.anchor,className:"scroll-my-12",children:(0,s.jsxs)(T,{section:i,children:[m&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(M.ShimmeringLoader,{}),(0,s.jsx)(M.ShimmeringLoader,{className:"w-3/4"}),(0,s.jsx)(M.ShimmeringLoader,{className:"w-1/2"})]}),g&&(0,s.jsx)(c.default,{subject:"Failed to retrieve usage data",error:u}),x&&(0,s.jsx)(s.Fragment,{children:!l||l?.available_in_plan?(0,s.jsxs)(s.Fragment,{children:[!t&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("p",{className:"text-sm",children:[i.name," usage"]}),v&&(0,s.jsxs)(Y.Tooltip,{children:[(0,s.jsx)(Y.TooltipTrigger,{asChild:!0,children:j>=1?(0,s.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,s.jsx)($.AlertTriangle,{size:14,strokeWidth:2,className:N}),(0,s.jsx)("p",{className:`text-sm ${N}`,children:"Exceeded limit"})]}):j>=U.USAGE_APPROACHING_THRESHOLD&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,s.jsx)($.AlertTriangle,{size:14,strokeWidth:2,className:"text-amber-900"}),(0,s.jsx)("p",{className:"text-sm text-amber-900",children:"Approaching limit"})]})}),(0,s.jsxs)(Y.TooltipContent,{side:"bottom",children:[(0,s.jsx)("p",{children:"Exceeding your plans included usage will lead to restrictions to your project."}),(0,s.jsx)("p",{children:"Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})]})]})]})}),p&&l&&!l.unlimited&&(0,s.jsx)(F.default,{type:"horizontal",barClass:(0,b.cn)(j>=1?_?"bg-foreground-light":"bg-red-900":!1===_&&j>=U.USAGE_APPROACHING_THRESHOLD?"bg-amber-900":"bg-foreground-light"),bgClass:"bg-surface-300",value:l?.usage??0,max:l?.pricing_free_units||1}),(0,s.jsxs)("div",{children:[l&&0!==l.pricing_free_units&&(0,s.jsxs)("div",{className:"flex items-center justify-between border-b py-1",children:[(0,s.jsxs)("p",{className:"text-xs text-foreground-light",children:["Included in ",d?.plan?.name," Plan"]}),l.unlimited?(0,s.jsx)("p",{className:"text-xs",children:"Unlimited"}):(0,s.jsx)("p",{className:"text-xs",children:"bytes"===i.unit||"gigabytes"===i.unit?`${l.pricing_free_units??0} GB`:(l.pricing_free_units??0).toLocaleString()})]}),p&&l&&(0,s.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,s.jsxs)("p",{className:"text-xs text-foreground-light",children:[i.chartPrefix||"Used "," in period"]}),(0,s.jsx)("p",{className:"text-xs",children:"bytes"===i.unit||"gigabytes"===i.unit?`${(l?.usage??0).toFixed(2)} GB`:(l?.usage??0).toLocaleString()})]}),p&&(l?.pricing_free_units??0)>0&&(0,s.jsxs)("div",{className:"flex items-center justify-between border-t py-1",children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"Overage in period"}),(0,s.jsx)("p",{className:"text-xs",children:(l?.pricing_free_units??0)===-1||f<0?`0${"bytes"===i.unit||"gigabytes"===i.unit?" GB":""}`:"bytes"===i.unit||"gigabytes"===i.unit?`${f.toFixed(2)} GB`:f.toLocaleString()})]})]})]}),i.additionalInfo?.(n),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-sm",children:[i.chartPrefix||""," ",i.name," ",i.chartSuffix||"per day"]}),i.chartDescription.split("\n").map((e,t)=>(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:e},`para-${t}`))]}),o[i.key].isLoading?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(M.ShimmeringLoader,{}),(0,s.jsx)(M.ShimmeringLoader,{className:"w-3/4"}),(0,s.jsx)(M.ShimmeringLoader,{className:"w-1/2"})]}):S.length>0&&C?(0,s.jsx)(A.default,{name:`${i.chartPrefix||""} ${i.name}`,unit:i.unit,attributes:i.attributes,data:S,yLeftMargin:o[i.key].margin,yFormatter:e=>((e,s)=>{if("string"==typeof e)return e;if("bytes"===s){let s=(e=>{if(0===e||void 0===e)return"0 bytes";let s=Math.floor(Math.log(e)/Math.log(1024)),t=D[s],i=2;return["bytes","KB","MB"].includes(t)?i=0:["GB"].includes(t)&&(i=1),parseFloat((e/Math.pow(1024,s)).toFixed(i))+" "+t})(e).replace(/\s/g,"");return"0bytes"===s?"0":s}return"gigabytes"===s?L.format(e)+"GB":L.format(e)})(e,i.unit),tooltipFormatter:e=>((e,s)=>{if("string"==typeof e)return e;if("bytes"===s){let s=(e=>{if(0===e||void 0===e)return"0 bytes";let s=Math.floor(Math.log(e)/Math.log(1024)),t=D[s];return parseFloat((e/Math.pow(1024,s)).toFixed(3))+" "+t})(e).replace(/\s/g,"");return"0bytes"===s?"0":s}return"gigabytes"===s?L.format(e)+"GB":L.format(e)})(e,i.unit)}):(0,s.jsx)(P.default,{children:(0,s.jsx)(P.default.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)(E.BarChart2,{className:"text-foreground-light mb-2"}),(0,s.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to 24 hours to show"})]})})})]}):(0,s.jsx)(P.default,{children:(0,s.jsx)(P.default.Content,{children:(0,s.jsxs)("div",{className:"flex w-full items-center flex-col justify-center space-y-2 md:flex-row md:justify-between",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm",children:"Not included in plan"}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"You need to be on a higher plan in order to use this feature."})})]}),(0,s.jsx)(y.Button,{type:"primary",asChild:!0,children:(0,s.jsx)(a.default,{href:h,children:"Upgrade plan"})})]})})})})]})})};var Z=e.i(48189),X=e.i(178527),V=e.i(206413),W=e.i(592360),Q=e.i(877555),q=e.i(252387);let J=({attribute:e,subscription:t,usage:i,currentBillingCycleSelected:n})=>{let l=(0,r.useMemo)(()=>i?.usages.find(e=>e.metric===m.PricingMetric.DATABASE_SIZE),[i]),c=(0,r.useMemo)(()=>l?.project_allocations.some(e=>e.usage>.5*1e9),[l]);return(0,s.jsx)("div",{id:e.anchor,className:"scroll-my-12",children:(0,s.jsx)(T,{section:e,children:(0,s.jsxs)("div",{className:"space-y-4",children:[n&&c&&(0,s.jsxs)(X.Alert_Shadcn_,{variant:"warning",children:[(0,s.jsx)(Q.CriticalIcon,{}),(0,s.jsx)(W.AlertTitle_Shadcn_,{children:"Projects exceeding quota"}),(0,s.jsx)(V.AlertDescription_Shadcn_,{children:"You have projects that are exceeding 0.5 GB of database size. Reduce the database size or upgrade to a paid plan."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)("p",{className:"text-sm",children:[e.name," usage"]})})}),t?.plan.id!=="platform"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between border-b py-1",children:[(0,s.jsxs)("p",{className:"text-xs text-foreground-light",children:["Included in ",t?.plan?.name," Plan"]}),(0,s.jsx)("p",{className:"text-xs",children:"0.5 GB per project"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"Max database size"}),(0,s.jsx)("p",{className:"text-xs",children:l?.usage?(0,Z.formatBytes)(l?.usage_original):"-"})]})]})]}),n&&t?.plan.id!=="platform"?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"space-y-1",children:(0,s.jsx)("p",{className:"text-sm",children:"Current database size per project"})}),l?.project_allocations.length===0&&(0,s.jsx)(P.default,{children:(0,s.jsx)(P.default.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)("p",{className:"text-sm",children:"No active projects"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"You don't have any active projects in this organization."})]})})}),l?.project_allocations.map((e,t)=>(0,s.jsxs)("div",{className:t!==l.project_allocations.length-1?"border-b pb-2":"",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-foreground-light flex items-center gap-2",children:e.name}),(0,s.jsx)(y.Button,{asChild:!0,type:"default",size:"tiny",children:(0,s.jsx)(a.default,{href:`/project/${e.ref}/observability/database#database-size-report`,children:"Manage Database Size"})})]}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsxs)("div",{className:"flex items-center h-6 gap-3",children:[(0,s.jsxs)("span",{className:"text-foreground-light text-sm font-mono flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-foreground font-semibold font-mono -mt-[2px]",children:(0,Z.formatBytes)(e.usage)})," ","Database Size"]}),(0,s.jsx)(q.InfoTooltip,{side:"top",children:(0,s.jsxs)("p",{children:[(0,Z.formatBytes)(e.usage)," GB database size as reported by Postgres."]})})]})})]},`usage-project-${e.ref}`))]}):(0,s.jsx)(P.default,{children:(0,s.jsx)(P.default.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)("p",{className:"text-sm",children:"Data not available"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Switch to current billing cycle to see current database size per project."})]})})})]})})})};var ee=e.i(844809),es=e.i(722740),et=e.i(837508);let ei=({slug:e,projectRef:t,attribute:i,subscription:n,usage:l,currentBillingCycleSelected:o})=>{let{data:d,isError:u,isPending:g,isSuccess:x,error:p}=(0,es.useOrgProjectsInfiniteQuery)({slug:e},{enabled:o}),h=(0,r.useMemo)(()=>d?.pages.flatMap(e=>e.projects)||[],[d?.pages]),j=(0,r.useMemo)(()=>x?h.filter(e=>{let s=e.is_branch&&e.databases.some(e=>(e.disk_volume_size_gb??8)>8),t=e.status!==et.PROJECT_STATUS.INACTIVE,i=e.databases.every(e=>"AWS"===e.cloud_provider);return(!e.is_branch||s)&&t&&i}).filter(e=>e.ref===t||!t):[],[x,h,t]),f=(0,r.useMemo)(()=>j.some(e=>e.databases.some(e=>"READ_REPLICA"===e.type||e.disk_volume_size_gb&&e.disk_volume_size_gb>8)),[j]),_=l?.usages.find(e=>e.metric===m.PricingMetric.DISK_SIZE_GB_HOURS_GP3),b=l?.usages.find(e=>e.metric===m.PricingMetric.DISK_SIZE_GB_HOURS_IO2);return(0,s.jsx)("div",{id:i.anchor,className:"scroll-my-12",children:(0,s.jsxs)(T,{section:i,children:[g&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(M.ShimmeringLoader,{}),(0,s.jsx)(M.ShimmeringLoader,{className:"w-3/4"}),(0,s.jsx)(M.ShimmeringLoader,{className:"w-1/2"})]}),u&&(0,s.jsx)(c.default,{subject:"Failed to retrieve usage data",error:p}),x&&(0,s.jsxs)("div",{className:"space-y-4",children:[o&&n?.usage_billing_enabled===!1&&f&&(0,s.jsxs)(X.Alert_Shadcn_,{variant:"warning",children:[(0,s.jsx)(Q.CriticalIcon,{}),(0,s.jsx)(W.AlertTitle_Shadcn_,{children:"Projects exceeding quota"}),(0,s.jsx)(V.AlertDescription_Shadcn_,{children:"You have projects that are exceeding 8 GB of provisioned disk size, but do not allow any overages with the Spend Cap on. Reduce the disk size or disable the spend cap."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)("p",{className:"text-sm",children:[i.name," usage"]})})}),(0,s.jsxs)("div",{className:"flex items-center justify-between border-b py-1",children:[(0,s.jsxs)("p",{className:"text-xs text-foreground-light",children:["Included in ",n?.plan?.name," Plan"]}),(0,s.jsx)("p",{className:"text-xs",children:"8 GB GP3 disk per project"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"Overages in period"}),(0,s.jsxs)("p",{className:"text-xs",children:[(_?.usage??0).toLocaleString()," GP3 GB-Hrs",b?.usage?` / ${b.usage.toLocaleString()} IO2 GB-Hrs`:""]})]})]}),o?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm",children:"Current disk size per project"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Breakdown of disk per project. Head to your project's disk management section to see database size used."})]}),0===j.length&&(0,s.jsx)(P.default,{children:(0,s.jsx)(P.default.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)("p",{className:"text-sm",children:"No active projects"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"You don't have any active projects in this organization."})]})})}),j.map((e,t)=>{let i=e.databases.filter(e=>"PRIMARY"===e.type).reduce((e,s)=>e+(s.disk_volume_size_gb??8),0),r=e.databases.filter(e=>"PRIMARY"!==e.type),n=r.reduce((e,s)=>e+(s.disk_volume_size_gb??8),0);return(0,s.jsxs)("div",{className:t!==j.length-1?"border-b pb-2":"",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-foreground-light flex items-center gap-2",children:e.name}),(0,s.jsx)(y.Button,{asChild:!0,type:"default",size:"tiny",children:(0,s.jsx)(a.default,{href:`/project/${e.ref}/settings/compute-and-disk`,children:"Manage Disk"})})]}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsxs)("div",{className:"flex items-center h-6 gap-3",children:[(0,s.jsxs)("span",{className:"text-foreground-light text-sm font-mono flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-foreground font-semibold -mt-[2px]",children:(0,s.jsx)(ee.default,{value:i+n,style:{lineHeight:.8},className:"font-mono"})})," ","GB Disk provisioned"]}),(0,s.jsxs)(q.InfoTooltip,{side:"top",children:[(0,s.jsxs)("p",{children:[i," GB for Primary Database"]}),r.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:[n," GB for ",r.length," Read"," ",1===r.length?"Replica":"Replicas"]}),(0,s.jsx)("p",{className:"mt-1",children:"Read replicas have their own disk and use 25% more disk to account for WAL files."})]})]})]})})]},`usage-project-${e.ref}`)})]}):(0,s.jsx)(P.default,{children:(0,s.jsx)(P.default.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)("p",{className:"text-sm",children:"Data not available"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Switch to current billing cycle to see current disk size per project."})]})})})]})]})})},ea=({orgSlug:e,projectRef:t,categoryKey:i,chartMeta:a,subscription:r,currentBillingCycleSelected:n,startDate:c,endDate:o})=>{let{data:d,error:u,isPending:g,isError:x,isSuccess:p}=(0,B.useOrgUsageQuery)({orgSlug:e,projectRef:t,start:!n&&c?new Date(c):void 0,end:!n&&o?new Date(o):void 0}),h=(0,z.USAGE_CATEGORIES)(r).find(e=>e.key===i);return h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.ScaffoldContainer,{children:(0,s.jsx)(H,{title:h.name,description:h.description,className:"pb-0"})}),h.attributes.map(i=>"diskSize"===i.key?(0,s.jsx)(ei,{slug:e,projectRef:t,attribute:i,subscription:r,currentBillingCycleSelected:n,usage:d},i.name):i.key===m.PricingMetric.DATABASE_SIZE&&r?.plan.id==="free"?(0,s.jsx)(J,{slug:e,projectRef:t,attribute:i,subscription:r,currentBillingCycleSelected:n,usage:d},i.name):(0,s.jsx)(K,{slug:e,projectRef:t,attribute:i,usage:d,usageMeta:d?.usages.find(e=>e.metric===i.key),chartMeta:a,subscription:r,error:u,isLoading:g,isError:x,isSuccess:p,currentBillingCycleSelected:n},i.name))]}):null},er=({orgSlug:e,projectRef:t,subscription:i,currentBillingCycleSelected:a,orgDailyStats:r,isLoadingOrgDailyStats:n})=>{let l={[m.PricingMetric.MONTHLY_ACTIVE_USERS]:{data:w(r,e=>e===m.PricingMetric.MONTHLY_ACTIVE_USERS),margin:18,isLoading:n},[m.PricingMetric.MONTHLY_ACTIVE_SSO_USERS]:{data:w(r,e=>e===m.PricingMetric.MONTHLY_ACTIVE_SSO_USERS),margin:20,isLoading:n},[m.PricingMetric.STORAGE_IMAGES_TRANSFORMED]:{data:w(r,e=>e===m.PricingMetric.STORAGE_IMAGES_TRANSFORMED),margin:0,isLoading:n},[m.PricingMetric.FUNCTION_INVOCATIONS]:{data:w(r,e=>e===m.PricingMetric.FUNCTION_INVOCATIONS),margin:26,isLoading:n},[m.PricingMetric.REALTIME_MESSAGE_COUNT]:{data:w(r,e=>e===m.PricingMetric.REALTIME_MESSAGE_COUNT),margin:38,isLoading:n},[m.PricingMetric.REALTIME_PEAK_CONNECTIONS]:{data:w(r,e=>e===m.PricingMetric.REALTIME_PEAK_CONNECTIONS),margin:0,isLoading:n}};return(0,s.jsx)(ea,{orgSlug:e,projectRef:t,categoryKey:"activity",chartMeta:l,subscription:i,currentBillingCycleSelected:a})},en=({orgDailyStats:e,isLoadingOrgDailyStats:t})=>{let i=Object.values(m.ComputeUsageMetric).map(e=>e.toLowerCase()),{billingAll:a}=(0,O.useIsFeatureEnabled)(["billing:all"]),n=w(e,e=>e.toString().startsWith("COMPUTE")),l={[m.ComputeUsageMetric.COMPUTE_HOURS_BRANCH]:"blue",[m.ComputeUsageMetric.COMPUTE_HOURS_XS]:"white",[m.ComputeUsageMetric.COMPUTE_HOURS_SM]:"green",[m.ComputeUsageMetric.COMPUTE_HOURS_MD]:"dark-green",[m.ComputeUsageMetric.COMPUTE_HOURS_L]:"yellow",[m.ComputeUsageMetric.COMPUTE_HOURS_XL]:"dark-yellow",[m.ComputeUsageMetric.COMPUTE_HOURS_2XL]:"orange",[m.ComputeUsageMetric.COMPUTE_HOURS_4XL]:"dark-orange",[m.ComputeUsageMetric.COMPUTE_HOURS_8XL]:"red",[m.ComputeUsageMetric.COMPUTE_HOURS_12XL]:"dark-red",[m.ComputeUsageMetric.COMPUTE_HOURS_16XL]:"purple",[m.ComputeUsageMetric.COMPUTE_HOURS_24XL]:"purple",[m.ComputeUsageMetric.COMPUTE_HOURS_24XL_OPTIMIZED_CPU]:"purple",[m.ComputeUsageMetric.COMPUTE_HOURS_24XL_OPTIMIZED_MEMORY]:"purple",[m.ComputeUsageMetric.COMPUTE_HOURS_24XL_HIGH_MEMORY]:"purple",[m.ComputeUsageMetric.COMPUTE_HOURS_48XL]:"purple",[m.ComputeUsageMetric.COMPUTE_HOURS_48XL_OPTIMIZED_CPU]:"purple",[m.ComputeUsageMetric.COMPUTE_HOURS_48XL_OPTIMIZED_MEMORY]:"purple",[m.ComputeUsageMetric.COMPUTE_HOURS_48XL_HIGH_MEMORY]:"purple"},c=Object.keys(m.ComputeUsageMetric).map(e=>({key:e.toLowerCase(),color:l[e]||"white",name:(0,m.computeUsageMetricLabel)(e)})),o=(0,r.useMemo)(()=>i.filter(e=>n.some(s=>s[e])),[n]),d=(0,r.useMemo)(()=>o.length>0,[o]);return(0,s.jsx)("div",{id:"compute",className:"scroll-my-12",children:(0,s.jsxs)(T,{section:{name:"Compute Hours",description:"Amount of hours your projects were active. Each project is a dedicated server and database.\nPaid plans come with $10 in Compute Credits to cover one project running on Micro Compute or parts of any compute add-on.\nBilling is based on the sum of Compute Hours used. Paused projects do not count towards usage.",links:a?[{name:"Compute Add-ons",url:`${U.DOCS_URL}/guides/platform/compute-add-ons`},{name:"Usage-billing for Compute",url:`${U.DOCS_URL}/guides/platform/manage-your-usage/compute`}]:[]},children:[t&&(0,s.jsx)(M.GenericSkeletonLoader,{}),!t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-1",children:[n.length>0&&(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsx)("p",{className:"text-sm",children:"Compute Hours usage"})})}),o.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between border-b last:border-b-0 py-1 last:py-0",children:[(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:[(0,s.jsx)("span",{className:"font-medium",children:(0,m.computeUsageMetricLabel)(e.toUpperCase())})," ","Compute Hours usage in period"]}),(0,s.jsxs)("p",{className:"text-sm",children:[n.reduce((s,t)=>s+(t[e]??0),0)," hours"]})]},e))]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm",children:"Compute Hours usage per day"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"The data refreshes every hour."})]}),n.length>0&&d?(0,s.jsx)(A.default,{name:"Compute Hours usage",unit:"hours",attributes:c,data:n,yMin:24}):(0,s.jsx)(P.default,{children:(0,s.jsx)(P.default.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)(E.BarChart2,{className:"text-foreground-light mb-2"}),(0,s.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to one hour to show"})]})})})]})]})})},el=({orgSlug:e,projectRef:t,subscription:i,currentBillingCycleSelected:a,orgDailyStats:r,isLoadingOrgDailyStats:n,startDate:l,endDate:c})=>{let o={[m.PricingMetric.EGRESS]:{data:w(r,e=>e===m.PricingMetric.EGRESS),margin:16,isLoading:n},[m.PricingMetric.CACHED_EGRESS]:{data:w(r,e=>e===m.PricingMetric.CACHED_EGRESS),margin:16,isLoading:n}};return(0,s.jsx)(ea,{orgSlug:e,projectRef:t,categoryKey:"egress",chartMeta:o,subscription:i,currentBillingCycleSelected:a,startDate:l,endDate:c})},ec=({orgSlug:e,projectRef:t,subscription:i,currentBillingCycleSelected:a,orgDailyStats:r,isLoadingOrgDailyStats:n})=>{let l={[m.PricingMetric.LOG_INGESTION]:{data:w(r,e=>e===m.PricingMetric.LOG_INGESTION),margin:18,isLoading:n},[m.PricingMetric.LOG_QUERYING]:{data:w(r,e=>e===m.PricingMetric.LOG_QUERYING),margin:20,isLoading:n},[m.PricingMetric.LOG_STORAGE]:{data:w(r,e=>e===m.PricingMetric.LOG_STORAGE),margin:0,isLoading:n}};return(0,s.jsx)(ea,{orgSlug:e,projectRef:t,categoryKey:"logs",chartMeta:l,subscription:i,currentBillingCycleSelected:a})},eo=({orgSlug:e,projectRef:t,subscription:i,currentBillingCycleSelected:a,orgDailyStats:r,isLoadingOrgDailyStats:n,startDate:l,endDate:c})=>{let o={[m.PricingMetric.STORAGE_SIZE]:{isLoading:n,margin:14,data:w(r,e=>e===m.PricingMetric.STORAGE_SIZE)},[m.PricingMetric.DATABASE_SIZE]:{isLoading:n,margin:14,data:w(r,e=>e===m.PricingMetric.DATABASE_SIZE)}};return(0,s.jsx)(ea,{orgSlug:e,projectRef:t,categoryKey:"sizeCount",chartMeta:o,subscription:i,currentBillingCycleSelected:a,startDate:l,endDate:c})};var ed=e.i(232107);let eu=[{key:m.PricingMetric.DATABASE_SIZE,name:"Database Size",units:"bytes",anchor:"dbSize",category:"Database",unitName:"GB",tip:"Database size refers to the actual amount of space used by all your database objects, as reported by Postgres. This measurement reflects your current database size at this moment. Free Plan projects are limited to 0.5 GB Database Size each and are monitored across the entire billing period."},{key:m.PricingMetric.EGRESS,name:"Egress",units:"bytes",anchor:"egress",category:"Database",unitName:"GB"},{key:m.PricingMetric.CACHED_EGRESS,name:"Cached Egress",units:"bytes",anchor:"cachedEgress",category:"Database",unitName:"GB"},{key:m.PricingMetric.MONTHLY_ACTIVE_USERS,name:"Monthly Active Users",units:"absolute",anchor:"mau",category:"Authentication",unitName:"MAU"},{key:m.PricingMetric.MONTHLY_ACTIVE_SSO_USERS,name:"Monthly Active SSO Users",units:"absolute",anchor:"mauSso",category:"Authentication",unitName:"MAU"},{key:m.PricingMetric.MONTHLY_ACTIVE_THIRD_PARTY_USERS,name:"Monthly Active Third-Party Users",units:"absolute",category:"Authentication",unitName:"MAU"},{key:m.PricingMetric.STORAGE_SIZE,name:"Storage Size",units:"bytes",anchor:"storageSize",category:"Storage",unitName:"GB"},{key:m.PricingMetric.STORAGE_IMAGES_TRANSFORMED,name:"Storage Image Transformations",units:"absolute",anchor:"storageImageTransformations",category:"Storage"},{key:m.PricingMetric.REALTIME_PEAK_CONNECTIONS,name:"Realtime Concurrent Peak Connections",units:"absolute",anchor:"realtimePeakConnections",category:"Realtime"},{key:m.PricingMetric.REALTIME_MESSAGE_COUNT,name:"Realtime Messages",units:"absolute",anchor:"realtimeMessageCount",category:"Realtime"},{key:m.PricingMetric.FUNCTION_INVOCATIONS,name:"Edge Function Invocations",units:"absolute",anchor:"funcInvocations",category:"Edge Functions"},{key:m.PricingMetric.DISK_SIZE_GB_HOURS_GP3,name:"Disk Size",anchor:"diskSize",units:"absolute",unitName:"GB-Hrs",category:"Database",tip:"Each project gets provisioned with 8 GB of GP3 disk for free. When you get close to the disk size limit, we autoscale your disk by 1.5x. Each GB of provisioned disk size beyond 8 GB incurs a GB-Hr every hour. Each extra GB is billed at $0.125/month ($0.000171/GB-Hr), prorated down to the hour.",docLink:{title:"Read more",url:`${U.DOCS_URL}/guides/platform/manage-your-usage/disk-size`}},{key:m.PricingMetric.DISK_SIZE_GB_HOURS_IO2,name:"Disk Size IO2",anchor:"diskSize",units:"absolute",unitName:"GB-Hrs",category:"Database"},{key:m.PricingMetric.DISK_IOPS_IO2,name:"Disk IOPS IO2",units:"absolute",unitName:"IOPS-Hrs",category:"Database"},{key:m.PricingMetric.DISK_IOPS_GP3,name:"Disk IOPS GP3",units:"absolute",unitName:"IOPS-Hrs",category:"Database"},{key:m.PricingMetric.DISK_THROUGHPUT_GP3,name:"Disk Throughput",units:"absolute",unitName:"IOPS-Hrs",category:"Database"},{key:m.PricingMetric.LOG_DRAIN_EVENTS,name:"Log Drain Events",units:"absolute",category:"Database"},{key:m.PricingMetric.LOG_INGESTION,name:"Log Ingestion",units:"bytes",category:"Logs",anchor:"logIngestion"},{key:m.PricingMetric.LOG_QUERYING,name:"Log Query",units:"bytes",category:"Logs",anchor:"logQuery"},{key:m.PricingMetric.LOG_STORAGE,name:"Log Storage",units:"bytes",category:"Logs",anchor:"logStorage"},{key:m.PricingMetric.ACTIVE_COMPUTE_HOURS,name:"Active Compute Hours",units:"absolute",category:"compute",anchor:"active-compute"}];var em=e.i(794231),eg=e.i(416050),ex=e.i(71049),ep=e.i(367051);let eh=({slug:e,metric:t,usage:i,subscription:n,relativeToSubscription:l,className:c})=>{let o=i.usages.find(e=>e.metric===t.key),d=(0,r.useMemo)(()=>o?l&&!1===o.available_in_plan?"Unavailable in plan":o.cost&&o.cost>0||!l||o.unlimited||0===o.pricing_free_units?"bytes"===t.units||"gigabytes"===t.units?`${o.usage.toLocaleString()??0} GB`:o.usage.toLocaleString()+(t.unitName?` ${t.unitName}`:""):"bytes"===t.units||"gigabytes"===t.units?`${o.usage.toLocaleString()??0} / ${o.pricing_free_units??0} GB`:`${o.usage.toLocaleString()} / ${o.pricing_free_units?.toLocaleString()}`+(t.unitName?` ${t.unitName}`:""):"",[o,l,t]),u=(0,r.useMemo)(()=>o&&o.project_allocations?o.project_allocations.sort((e,s)=>s.usage-e.usage):[],[o]);if(!o)return null;let m=0===o.usage?0:o.usage/(o.pricing_free_units??0),g=n?.usage_billing_enabled===!0,x=!1==!!o.unlimited,p=x&&m>=.8,h=l&&x&&m>=1,j=(0,ep.billingMetricUnit)(o.metric),f=0===o.usage||0===o.pricing_free_units?"":m<.01?"(<1%)":`(${(+(100*m).toFixed(0)).toLocaleString()}%)`;return(0,s.jsxs)(ex.HoverCard,{openDelay:50,closeDelay:200,children:[(0,s.jsx)(ex.HoverCardTrigger,{asChild:!0,children:(0,s.jsxs)("div",{className:(0,b.cn)("flex items-center justify-between",c),children:[t.anchor?(0,s.jsxs)(a.default,{href:`/org/${e}/usage#${t.anchor}`,className:"block w-full group",children:[(0,s.jsxs)("div",{className:"group flex items-center gap-1",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:t.name}),o.available_in_plan&&(0,s.jsx)("span",{className:"text-foreground-muted transition inline-block group-hover:transform group-hover:translate-x-0.5",children:(0,s.jsx)(eg.ChevronRight,{strokeWidth:1.5,size:16,className:"transition"})})]}),(0,s.jsx)("span",{className:"text-sm",children:d})," ",l&&o.cost&&o.cost>0?(0,s.jsxs)("span",{className:"text-sm",translate:"no",children:["(",(0,Z.formatCurrency)(o.cost),")"]}):o.available_in_plan&&0!==o.pricing_free_units&&!o.unlimited&&l?(0,s.jsx)("span",{className:"text-sm",children:f}):null]}):(0,s.jsxs)("div",{className:"block w-full",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light flex space-x-1",children:t.name}),(0,s.jsx)("span",{className:"text-sm",children:d})," ",l&&o.cost&&o.cost>0?(0,s.jsxs)("span",{className:"text-sm",translate:"no",children:["(",(0,Z.formatCurrency)(o.cost),")"]}):o.available_in_plan&&0!==o.pricing_free_units&&!o.unlimited&&l?(0,s.jsx)("span",{className:"text-sm",children:f}):null]}),o.available_in_plan?(0,s.jsx)("div",{children:l&&!o.unlimited&&0!==o.pricing_free_units?(0,s.jsxs)("svg",{className:"h-8 w-8 -rotate-90 transform",children:[(0,s.jsx)("circle",{cx:15,cy:15,r:12,fill:"transparent",stroke:"currentColor",strokeWidth:4,className:"text-background-surface-300"}),(0,s.jsx)("circle",{cx:15,cy:15,r:12,fill:"transparent",stroke:"currentColor",strokeDasharray:75.398,strokeDashoffset:`calc(75.39822 - ${m<1?100*m:100} / 100 * 75.39822)`,strokeWidth:4,className:g?"text-gray-dark-800":h?"text-red-900":p?"text-yellow-1000":"text-gray-dark-800"})]}):null}):(0,s.jsx)("div",{children:(0,s.jsx)(em.UpgradePlanButton,{source:`billingBreakdownUsage${t.anchor}`,featureProposition:`to use ${t.name}`,children:"Upgrade"})})]})}),o.available_in_plan&&(0,s.jsx)(ex.HoverCardContent,{side:"bottom",align:"end",className:"w-[500px]",animate:"slide-in",children:(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("p",{className:"font-medium",translate:"no",children:o.unit_price_desc}),t.tip&&(0,s.jsx)("div",{className:"my-2",children:(0,s.jsxs)("p",{className:"text-sm",children:[t.tip," ",t.docLink&&(0,s.jsx)(a.default,{href:t.docLink.url,target:"_blank",className:"transition text-brand hover:text-brand-600 underline",children:t.docLink.title})]})}),!1===n.usage_billing_enabled&&l&&(p||h)&&(0,s.jsx)("div",{className:"my-2",children:(0,s.jsx)("p",{className:"text-sm",children:"Exceeding your plans included usage will lead to restrictions to your project. Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})}),u&&u.length>0&&(0,s.jsxs)("table",{className:"list-disc w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left",children:"Project"}),(0,s.jsx)("th",{className:"text-right",children:"Usage"})]})}),(0,s.jsxs)("tbody",{children:[u.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.name}),(0,s.jsx)("td",{className:"text-right",children:(0,ep.formatUsage)(o.metric,e)})]},`${o.metric}_${e.ref}`)),(0,s.jsx)("tr",{})]}),(0,s.jsx)("tfoot",{children:(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{className:"py-2 border-t text-left",children:["Total",j&&(0,s.jsxs)("span",{children:[" (",j,")"]})]}),(0,s.jsxs)("td",{className:"py-2 border-t text-right",children:[(0,ep.formatUsage)(o.metric,{usage:o.usage_original})," "]})]})})]})]})})]})},ej=({slug:e,metric:t,usage:i,relativeToSubscription:n,className:l})=>{let c=i.usages.find(e=>e.metric===t.key),o=(0,r.useMemo)(()=>c?.pricing_free_units?`${c?.usage?.toLocaleString()??0} / ${c?.pricing_free_units??0} hours`:`${c?.usage?.toLocaleString()??0} hours`,[c]),d=(0,r.useMemo)(()=>c&&c.project_allocations?c.project_allocations.sort((e,s)=>s.usage-e.usage):[],[c]);return(0,s.jsxs)(ex.HoverCard,{openDelay:50,closeDelay:200,children:[(0,s.jsx)(ex.HoverCardTrigger,{asChild:!0,children:(0,s.jsxs)("div",{className:l,children:[(0,s.jsx)(a.default,{href:`/org/${e}/usage#${t.anchor}`,children:(0,s.jsxs)("div",{className:"group flex items-center space-x-2",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:t.name}),(0,s.jsx)(eg.ChevronRight,{strokeWidth:1.5,size:16,className:"transition"})]})}),(0,s.jsx)("span",{className:"text-sm",children:o})," ",n&&c?.cost&&c.cost>0?(0,s.jsxs)("span",{className:"text-sm",translate:"no",children:["(",(0,Z.formatCurrency)(c?.cost),")"]}):null]})}),(0,s.jsx)(ex.HoverCardContent,{side:"bottom",align:"end",className:"w-[500px]",animate:"slide-in",children:(0,s.jsxs)("div",{className:"text-sm text-foreground space-y-2",children:[(0,s.jsx)("p",{className:"font-medium",translate:"no",children:c?.unit_price_desc}),(0,s.jsx)("div",{className:"my-2",children:c?.metric===m.ComputeUsageMetric.COMPUTE_HOURS_BRANCH?(0,s.jsxs)("p",{className:"text-sm",children:["Each Preview branch is a separate environment with all Supabase services (Database, Auth, Storage, etc.)."," ",(0,s.jsx)(a.default,{href:`${U.DOCS_URL}/guides/platform/manage-your-usage/branching`,target:"_blank",className:"transition text-brand hover:text-brand-600 underline",children:"Read more"})]}):(0,s.jsxs)("p",{className:"text-sm",children:["Every project is a dedicated server and database. For every hour your project is active, it incurs compute costs based on the compute size of your project. Paused projects do not incur compute costs."," ",(0,s.jsx)(a.default,{href:`${U.DOCS_URL}/guides/platform/manage-your-usage/compute`,target:"_blank",className:"transition text-brand hover:text-brand-600 underline",children:"Read more"})]})}),c&&d.length>0&&(0,s.jsxs)("table",{className:"list-disc w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left",children:"Project"}),(0,s.jsx)("th",{className:"text-right",children:"Usage"})]})}),(0,s.jsxs)("tbody",{children:[d.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.name}),(0,s.jsx)("td",{className:"text-right",children:(0,ep.formatUsage)(c.metric,e)})]},`${c.metric}_${e.ref}`)),(0,s.jsx)("tr",{})]}),(0,s.jsx)("tfoot",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"py-2 border-t text-left",children:"Total (Hours)"}),(0,s.jsx)("td",{className:"py-2 border-t text-right",children:(0,ep.formatUsage)(c.metric,{usage:c.usage_original})})]})})]})]})})]})},ef=[m.PricingMetric.DISK_IOPS_IO2,m.PricingMetric.DISK_IOPS_GP3,m.PricingMetric.DISK_SIZE_GB_HOURS_GP3,m.PricingMetric.DISK_SIZE_GB_HOURS_IO2,m.PricingMetric.DISK_THROUGHPUT_GP3,m.PricingMetric.LOG_INGESTION,m.PricingMetric.LOG_STORAGE,m.PricingMetric.LOG_QUERYING,m.PricingMetric.ACTIVE_COMPUTE_HOURS],e_=({orgSlug:e,projectRef:t,subscription:i,startDate:a,endDate:n,currentBillingCycleSelected:l})=>{let o=(0,ed.useBreakpoint)("md"),d=i?.usage_billing_enabled,{billingAll:u}=(0,O.useIsFeatureEnabled)(["billing:all"]),{data:g,error:x,isPending:p,isError:h,isSuccess:j}=(0,B.useOrgUsageQuery)({orgSlug:e,projectRef:t,start:!l&&a?new Date(a):void 0,end:!l&&n?new Date(n):void 0}),f=l&&!t,_=["team","enterprise","platform"].includes(i?.plan.id??""),y=f&&!!g?.usages.find(e=>!e.metric.startsWith("COMPUTE_")&&!e.unlimited&&e.usage>(e?.pricing_free_units??0)),N=(0,r.useMemo)(()=>g?eu.filter(e=>g.usages.some(s=>s.metric===e.key)).filter(e=>{if(!ef.includes(e.key))return!0;let s=g.usages.find(s=>s.metric===e.key);return s&&s.usage>0}).slice().sort((e,s)=>{let t=g.usages.find(s=>s.metric===e.key),i="number"!=typeof t?(t?.usage??0)/(t?.pricing_free_units??0):0,a=g.usages.find(e=>e.metric===s.key),r="number"!=typeof a?(a?.usage??0)/(a?.pricing_free_units??0):0;return Number(a?.available_in_plan)-Number(t?.available_in_plan)||r-i}):[],[g]),S=(g?.usages||[]).filter(e=>e.metric.startsWith("COMPUTE")).map(e=>e.metric);return(0,s.jsx)("div",{id:"summary",children:(0,s.jsxs)(T,{section:{name:"Usage Summary",description:d?"Your plan includes a limited amount of usage. If exceeded, you will be charged for the overages. It may take up to 1 hour to refresh.":"Your plan includes a limited amount of usage. If exceeded, you may experience restrictions, as you are currently not billed for overages. It may take up to 1 hour to refresh.",links:u?[{name:"How billing works",url:`${U.DOCS_URL}/guides/platform/billing-on-supabase`},{name:"Supabase Plans",url:"https://supabase.com/pricing"}]:[]},children:[p&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(M.ShimmeringLoader,{}),(0,s.jsx)(M.ShimmeringLoader,{className:"w-3/4"}),(0,s.jsx)(M.ShimmeringLoader,{className:"w-1/2"})]}),h&&(0,s.jsx)(c.default,{subject:"Failed to retrieve usage data",error:x}),j&&i&&(0,s.jsxs)("div",{children:[f&&!_&&(0,s.jsx)("p",{className:"text-sm",children:y?y&&i?.plan?.id==="free"?(0,s.jsxs)("span",{children:["You have exceeded your"," ",(0,s.jsx)("span",{className:"font-medium",children:i?.plan.name})," Plan quota in this billing cycle. Upgrade your plan to continue using Supabase without restrictions."]}):y&&i?.usage_billing_enabled===!1&&i?.plan?.id==="pro"?(0,s.jsxs)("span",{children:["You have exceeded your"," ",(0,s.jsx)("span",{className:"font-medium",children:i?.plan.name})," Plan quota in this billing cycle. Disable your spend cap to continue using Supabase without restrictions."]}):y&&i?.usage_billing_enabled===!0?(0,s.jsxs)("span",{children:["You have exceeded your"," ",(0,s.jsx)("span",{className:"font-medium",children:i?.plan.name})," Plan quota in this billing cycle and will be charged for over-usage."]}):(0,s.jsxs)("span",{children:["You have not exceeded your"," ",(0,s.jsx)("span",{className:"font-medium",children:i?.plan.name})," Plan quota in this billing cycle."]}):(0,s.jsxs)("span",{children:["You have not exceeded your"," ",(0,s.jsx)("span",{className:"font-medium",children:i?.plan.name})," Plan quota in this billing cycle."]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 mt-3 gap-[1px] bg-border",children:[N.map((t,a)=>(0,s.jsx)("div",{className:(0,b.cn)("col-span-2 md:col-span-1 bg-sidebar space-y-4 py-4"),children:(0,s.jsx)(eh,{idx:a,slug:e,metric:t,usage:g,subscription:i,relativeToSubscription:f,className:(0,b.cn)(a%2==0?"md:pr-4":"md:pl-4")})},t.key)),S.map((t,i)=>(0,s.jsx)("div",{className:(0,b.cn)("col-span-2 md:col-span-1 bg-sidebar space-y-4 py-4"),children:(0,s.jsx)(ej,{slug:e,metric:{key:t,name:(0,m.computeUsageMetricLabel)(t)+" Compute Hours",units:"hours",anchor:"compute",category:"Compute",unitName:"GB"},relativeToSubscription:f,usage:g,className:(0,b.cn)((i+N.length)%2==0?"md:pr-4":"md:pl-4")})},t)),!o&&(N.length+S.length)%2==1&&(0,s.jsx)("div",{className:"col-span-2 md:col-span-1 bg-sidebar"})]})]})]})})},ey=()=>{let{slug:e}=(0,n.useParams)(),[E,P]=(0,r.useState)(),[O,U]=(0,_.useQueryState)("projectRef"),[I,R]=(0,r.useState)(!1),{can:T,isLoading:k}=(0,p.useAsyncCheckPermissions)(t.PermissionAction.BILLING_READ,"stripe.subscriptions"),{data:L,error:D,isPending:w,isError:A,isSuccess:B}=(0,x.useOrgSubscriptionQuery)({orgSlug:e}),{data:H}=(0,g.useProjectDetailQuery)({ref:O??void 0}),z=(0,r.useMemo)(()=>i.default.unix(L?.current_period_start??0).utc(),[L]),$=(0,r.useMemo)(()=>i.default.unix(L?.current_period_end??0).utc(),[L]),F=(0,r.useMemo)(()=>!(E?.period_start&&E?.period_end)||(0,i.default)(E.period_start.date).isSame(z)&&(0,i.default)(E.period_end.date).isSame($),[E,z,$]),Y=(0,r.useMemo)(()=>{if(E?.period_start?.date)return new Date(E?.period_start?.date).toISOString().slice(0,-5)+"Z"},[E,L]),K=(0,r.useMemo)(()=>E?.period_end?.date&&(0,i.default)(E.period_end.date).isAfter((0,i.default)())?(0,i.default)().endOf("day").toISOString().slice(0,-5)+"Z":E?.period_end?.date?new Date(E.period_end.date).toISOString().slice(0,-5)+"Z":void 0,[E,L]),{data:Z,error:X,isPending:V,isError:W}=(0,m.useOrgDailyStatsQuery)({orgSlug:e,projectRef:O??void 0,startDate:Y,endDate:K});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.ScaffoldContainer,{children:(0,s.jsx)(l.ScaffoldHeader,{className:"pt-8",children:(0,s.jsx)(l.ScaffoldTitle,{children:"Usage"})})}),(0,s.jsx)("div",{className:"sticky top-0 border-b bg-sidebar z-[1]",children:(0,s.jsx)(l.ScaffoldContainer,{children:(0,s.jsxs)("div",{className:"py-4 flex items-center space-x-4",children:[w||k?(0,s.jsxs)("div",{className:"flex lg:items-center items-start gap-3 flex-col lg:flex-row lg:justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(M.ShimmeringLoader,{className:"w-48"}),(0,s.jsx)(M.ShimmeringLoader,{className:"w-48"})]}),(0,s.jsx)(M.ShimmeringLoader,{className:"w-[280px]"})]}):T?null:(0,s.jsx)(d.default,{resourceText:"view organization usage"}),A&&(0,s.jsx)(c.default,{className:"w-full",subject:"Failed to retrieve usage data",error:D}),B&&(0,s.jsxs)("div",{className:"flex lg:items-center items-start gap-3 flex-col lg:flex-row lg:justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.default,{onChange:P,value:h.TIME_PERIODS_BILLING[0].key,options:[...h.TIME_PERIODS_BILLING,...h.TIME_PERIODS_REPORTS],loading:w,currentBillingPeriodStart:L?.current_period_start,currentBillingPeriodEnd:L?.current_period_end,className:"!w-48"}),(0,s.jsx)(u.OrganizationProjectSelector,{open:I,setOpen:R,selectedRef:O,onSelect:e=>{U(e.ref)},renderTrigger:()=>(0,s.jsx)(y.Button,{block:!0,type:"default",role:"combobox",size:"tiny",className:"justify-between w-[180px]",iconRight:(0,s.jsx)(f.ChevronDown,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),children:H?H?.name:"All projects"}),renderRow:e=>{let t=O===e.ref;return(0,s.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,s.jsx)("span",{className:(0,b.cn)("truncate",t?"max-w-60":"max-w-64"),children:e.name}),t&&(0,s.jsx)(j.Check,{size:16})]})},renderActions:()=>(0,s.jsx)(N.CommandGroup_Shadcn_,{children:(0,s.jsxs)(S.CommandItem_Shadcn_,{className:"cursor-pointer flex items-center justify-between w-full",onSelect:()=>{R(!1),U(null)},onClick:()=>{R(!1),U(null)},children:["All projects",!O&&(0,s.jsx)(j.Check,{size:16})]})})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("p",{className:(0,b.cn)("text-sm transition",w&&"opacity-50"),children:["Organization is on the"," ",(0,s.jsxs)("span",{className:"font-medium text-brand",children:[L.plan.name," Plan"]})]}),(0,s.jsx)("span",{className:"text-border-stronger",children:(0,s.jsx)("svg",{viewBox:"0 0 24 24",width:"16",height:"16",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",shapeRendering:"geometricPrecision",children:(0,s.jsx)("path",{d:"M16 3.549L7.12 20.600"})})}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:[z.format("DD MMM YYYY")," -"," ",$.format("DD MMM YYYY")]})]})]})]})})}),W&&(0,s.jsx)(l.ScaffoldContainer,{children:(0,s.jsx)(l.ScaffoldSection,{isFullWidth:!0,className:"pb-0",children:(0,s.jsx)(c.default,{error:X,subject:"Failed to retrieve usage statistics for organization"})})}),H?(0,s.jsx)(l.ScaffoldContainer,{className:"mt-5",children:(0,s.jsx)(v.Admonition,{type:"default",title:"Usage filtered by project",description:(0,s.jsxs)("div",{children:["You are currently viewing usage for the"," ",(0,s.jsx)("span",{className:"font-medium text-foreground",children:H?.name||O})," ","project. Supabase uses"," ",(0,s.jsx)(a.default,{href:"/docs/guides/platform/billing-on-supabase#organization-based-billing",target:"_blank",children:"organization-level billing"})," ",'and quotas. For billing purposes, we sum up usage from all your projects. To view your usage quota, set the project filter above back to "All Projects".']})})}):(0,s.jsx)(l.ScaffoldContainer,{id:"restriction",className:"mt-5",children:(0,s.jsx)(C.Restriction,{})}),(0,s.jsx)(e_,{orgSlug:e,projectRef:O,subscription:L,startDate:Y,endDate:K,currentBillingCycleSelected:F}),L?.plan.id!=="free"&&(0,s.jsx)(en,{orgDailyStats:Z,isLoadingOrgDailyStats:V}),L?.plan.id==="platform"&&(0,s.jsx)(G,{orgDailyStats:Z,isLoadingOrgDailyStats:V}),(0,s.jsx)(el,{orgSlug:e,projectRef:O,subscription:L,currentBillingCycleSelected:F,orgDailyStats:Z,isLoadingOrgDailyStats:V,startDate:Y,endDate:K}),(0,s.jsx)(eo,{orgSlug:e,projectRef:O,subscription:L,currentBillingCycleSelected:F,orgDailyStats:Z,isLoadingOrgDailyStats:V,startDate:Y,endDate:K}),(0,s.jsx)(er,{orgSlug:e,projectRef:O,subscription:L,startDate:Y,endDate:K,currentBillingCycleSelected:F,orgDailyStats:Z,isLoadingOrgDailyStats:V}),L?.plan.id==="platform"&&(0,s.jsx)(ec,{orgSlug:e,projectRef:O,subscription:L,startDate:Y,endDate:K,currentBillingCycleSelected:F,orgDailyStats:Z,isLoadingOrgDailyStats:V})]})};var eb=e.i(448710),eN=e.i(121958);let eS=()=>(0,s.jsx)(ey,{});eS.getLayout=e=>(0,s.jsx)(eb.default,{children:(0,s.jsx)(eN.default,{children:e})}),e.s(["default",0,eS],513535)},335452,(e,s,t)=>{let i="/org/[slug]/usage";(window.__NEXT_P=window.__NEXT_P||[]).push([i,()=>e.r(513535)]),s.hot&&s.hot.dispose(function(){window.__NEXT_P.push([i])})}]);

//# debugId=7f584e57-2365-85a4-a870-74c324535507
//# sourceMappingURL=8cc3e2e1232f81c6.js.map