;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="a5a2de99-6e8c-786d-c3b6-67efca5432d6")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,839941,e=>{"use strict";var t=e.i(478902),s=e.i(271226);e.i(128328);var r=e.i(158639),a=e.i(388147),i=e.i(951138),n=e.i(825713);let o=()=>{let{ref:e="default"}=(0,r.useParams)(),i=(0,s.useRouter)().pathname.split("/")[4],n=[{title:"Manage",items:[{name:"Functions",key:"main",pages:["","[functionSlug]","new"],url:`/project/${e}/functions`,items:[]},{name:"Secrets",key:"secrets",url:`/project/${e}/functions/secrets`,items:[]}]}];return(0,t.jsx)(a.ProductMenu,{page:i,menu:n})},l=(0,i.withAuth)(({children:e})=>(0,t.jsx)(n.ProjectLayout,{title:"Edge Functions",product:"Edge Functions",productMenu:(0,t.jsx)(o,{}),isBlocking:!1,children:e}));e.s(["default",0,l])},235151,e=>{"use strict";var t=e.i(242882);e.i(128328);var s=e.i(704206),r=e.i(294285);async function a(){try{return await (0,s.getAccessToken)()}catch(e){return null}}e.s(["useSessionAccessTokenQuery",0,({enabled:e=!0,...s}={})=>(0,t.useQuery)({queryKey:r.authKeys.accessToken(),queryFn:()=>a(),...s})])},525070,e=>{"use strict";var t=e.i(478902);let s=(0,e.i(388019).default)("BookOpenText",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}],["path",{d:"M6 8h2",key:"30oboj"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M16 12h2",key:"7q9ll5"}]]);e.i(128328);var r=e.i(158639),a=e.i(162082),i=e.i(265735),n=e.i(876298),o=e.i(215312);e.s(["APIDocsButton",0,({section:e,source:l})=>{let h=(0,n.useAppStateSnapshot)(),{ref:c}=(0,r.useParams)(),{data:u}=(0,i.useSelectedOrganizationQuery)(),{mutate:d}=(0,a.useSendEventMutation)();return(0,t.jsx)(o.ButtonTooltip,{size:"tiny",type:"default",onClick:()=>{e&&h.setActiveDocsSection(e),h.setShowProjectApiDocs(!0),d({action:"api_docs_opened",properties:{source:l},groups:{project:c??"Unknown",organization:u?.slug??"Unknown"}})},icon:(0,t.jsx)(s,{}),className:"h-7 w-7",tooltip:{content:{side:"bottom",text:"API Docs"}}})}],525070)},686415,e=>{"use strict";var t=e.i(478902),s=e.i(389959),r=e.i(837710),a=e.i(793912),i=e.i(135144),n=e.i(689805),o=e.i(843778),l=e.i(88816),h=e.i(659016),c=e.i(201461),u=e.i(883668),d=e.i(71011);let p=({user:e})=>{let s=(0,d.getAvatarUrl)(e),r=(0,d.getDisplayName)(e,e.email??e.phone??e.id??"Unknown");return(0,t.jsxs)("div",{className:"flex gap-1 items-center pl-0.5 pr-1.5 h-[21px] bg-surface-200 rounded-full overflow-hidden",children:[s?(0,t.jsx)("img",{className:"rounded-full w-[18px] h-[18px]",src:s,alt:r}):(0,t.jsx)("div",{className:"rounded-full w-[18px] h-[18px] bg-surface-100 border flex items-center justify-center text-light",children:(0,t.jsx)(h.User,{size:12,strokeWidth:2})}),(0,t.jsx)("span",{className:"truncate max-w-[84px]",children:r})]})},f=({sub:e})=>(0,t.jsxs)("div",{className:"flex gap-1 items-center pl-0.5 pr-1.5 h-[21px] bg-surface-200 rounded-full overflow-hidden",children:[(0,t.jsx)("div",{className:"rounded-full w-[18px] h-[18px] bg-surface-100 border flex items-center justify-center text-light",children:(0,t.jsx)(h.User,{size:12,strokeWidth:2})}),(0,t.jsx)("span",{className:"truncate max-w-[84px]",children:e})]});e.s(["RoleImpersonationPopover",0,({serviceRoleLabel:e,variant:h="regular",align:d="end",disallowAuthenticatedOption:m=!1})=>{let g=(0,c.useRoleImpersonationStateSnapshot)(),[y,x]=(0,s.useState)(!1),b=g.role?.role??e??"service role";return(0,t.jsxs)(n.Popover_Shadcn_,{open:y,onOpenChange:x,children:[(0,t.jsx)(i.PopoverTrigger_Shadcn_,{asChild:!0,children:(0,t.jsx)(r.Button,{size:"tiny",type:"default",className:(0,o.cn)("h-[26px] pr-3 gap-0","connected-on-right"===h&&"rounded-r-none border-r-0","connected-on-left"===h&&"rounded-l-none border-l-0","connected-on-both"===h&&"rounded-none border-x-0"),children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-foreground-muted",children:"Role"}),(0,t.jsx)("span",{children:b}),g.role?.type==="postgrest"&&"authenticated"===g.role.role&&(0,t.jsxs)(t.Fragment,{children:["native"===g.role.userType&&g.role.user?(0,t.jsx)(p,{user:g.role.user}):"external"===g.role.userType&&g.role.externalAuth?(0,t.jsx)(f,{sub:g.role.externalAuth.sub}):null,(0,t.jsx)("span",{className:"text-xs text-foreground-lighter font-light",children:"aal2"===g.role.aal?"AAL2":"AAL1"})]}),(0,t.jsx)(l.ChevronDown,{className:"text-muted",strokeWidth:1,size:12})]})})}),(0,t.jsx)(a.PopoverContent_Shadcn_,{className:"p-0 overflow-hidden w-min",side:"bottom",align:d,children:(0,t.jsx)(u.RoleImpersonationSelector,{serviceRoleLabel:e,disallowAuthenticatedOption:m})})]})}])},634530,e=>{"use strict";let t=[{id:"curl",label:"cURL",language:"bash",code:({showKey:e,functionUrl:t,apiKey:s})=>{let r=s.includes("publishable")?"SUPABASE_PUBLISHABLE_DEFAULT_KEY":"SUPABASE_ANON_KEY",a=e?s:r;return`curl -L -X POST '${t}' \\
  -H 'Authorization: Bearer ${a}' \\${s.includes("publishable")?`
  -H 'apikey: ${a}' \\`:""}
  -H 'Content-Type: application/json' \\
  --data '{"name":"Functions"}'`}},{id:"supabase-js",label:"JavaScript",language:"js",hideLineNumbers:!0,code:({functionName:e})=>`import { createClient } from '@supabase/supabase-js'
const supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_ANON_KEY)
const { data, error } = await supabase.functions.invoke('${e}', {
  body: { name: 'Functions' },
})`},{id:"swift",label:"Swift",language:"ts",hideLineNumbers:!0,code:({functionName:e})=>`struct Response: Decodable {
  // Expected response definition
}

let response: Response = try await supabase.functions
  .invoke(
    "${e}",
    options: FunctionInvokeOptions(
      body: ["name": "Functions"]
    )
  )`},{id:"flutter",label:"Flutter",language:"dart",hideLineNumbers:!0,code:({functionName:e})=>`final res = await supabase.functions.invoke('${e}', body: {'name': 'Functions'});
final data = res.data;`},{id:"python",label:"Python",language:"python",hideLineNumbers:!0,code:({functionName:e})=>`response = supabase.functions.invoke(
    "${e}",
    invoke_options={"body": {"name": "Functions"}}
)`}];e.s(["HTTP_METHODS",0,["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS"],"INVOCATION_TABS",0,t])},551788,287777,311542,e=>{"use strict";var t=e.i(388019);let s=(0,t.default)("FileArchive",[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]]);e.s(["FileArchive",()=>s],551788);let r=(0,t.default)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);e.s(["Send",()=>r],287777);var a=e.i(38429),i=e.i(355901),n=e.i(234745),o=e.i(10429);async function l({url:e,method:t,body:s,headers:r}){let a,i=await (0,n.constructHeaders)(),l=await (0,n.fetchHandler)(`${o.BASE_PATH}/api/edge-functions/test`,{method:"POST",headers:{...i,"Content-Type":"application/json"},body:JSON.stringify({url:e,method:t,body:s,headers:r})});try{a=await l.json()}catch{}if(!l.ok)throw Error(a.error?.message||"Failed to test edge function",{cause:{status:a.status}});return a}e.s(["useEdgeFunctionTestMutation",0,({onSuccess:e,onError:t,...s}={})=>(0,a.useMutation)({mutationFn:e=>l(e),async onSuccess(t,s,r){await e?.(t,s,r)},async onError(e,s,r){void 0===t?i.toast.error(`Failed to test edge function: ${e.message}`):t(e,s,r)},...s})],311542)},780990,e=>{"use strict";var t=e.i(478902),s=e.i(902858),r=e.i(786741),a=e.i(551788),i=e.i(287777),n=e.i(271226),o=e.i(389959),l=e.i(355901);e.i(204878);var h=e.i(339345),c=e.i(801612);e.i(128328);var u=e.i(86086),d=e.i(158639),p=e.i(463333),f=e.i(532728),m=e.i(774803),g=e.i(479232),y=e.i(975924),x=e.i(408891),b=e.i(531837),S=e.i(686415),j=e.i(108892),v=e.i(235151),w=e.i(462142),k=e.i(377451),C=e.i(311542),N=e.i(162082),_=e.i(2579),A=e.i(265735),T=e.i(10429),L=e.i(48189),P=e.i(908937),$=e.i(201461),F=e.i(587433),E=e.i(837710),z=e.i(672044),O=e.i(428353),B=e.i(24315),M=e.i(61863),H=e.i(378277),V=e.i(9679),R=e.i(725805),I=e.i(449123),D=e.i(451031),U=e.i(831927),W=e.i(156722),q=e.i(719754),Q=e.i(725137),J=e.i(500850),K=e.i(283606),G=e.i(314805),X=e.i(408279),Y=e.i(398876),Z=e.i(538482),ee=e.i(634530);let et=b.object({method:b.enum(ee.HTTP_METHODS),body:b.string().optional().transform(e=>e||"{}"),headers:b.array(b.object({key:b.string(),value:b.string()})),queryParams:b.array(b.object({key:b.string(),value:b.string()}))}),es=({visible:e,onClose:r})=>{let{data:a}=(0,A.useSelectedOrganizationQuery)(),{ref:n,functionSlug:l}=(0,d.useParams)(),h=(0,$.useGetImpersonatedRoleState)(),[c,u]=(0,o.useState)(null),[p,b]=(0,o.useState)(null),{can:es}=(0,_.useAsyncCheckPermissions)(s.PermissionAction.SECRETS_READ,"*"),{data:er}=(0,j.useAPIKeysQuery)({projectRef:n},{enabled:es}),{data:ea}=(0,w.useProjectPostgrestConfigQuery)({projectRef:n}),{data:ei}=(0,k.useProjectSettingsV2Query)({projectRef:n}),{data:en}=(0,v.useSessionAccessTokenQuery)({enabled:T.IS_PLATFORM}),{serviceKey:eo}=(0,j.getKeys)(er),{mutate:el}=(0,N.useSendEventMutation)(),{mutate:eh,isPending:ec}=(0,C.useEdgeFunctionTestMutation)({onSuccess:e=>u(e),onError:e=>{b(e instanceof Error?e.message:"An unknown error occurred"),e instanceof Error&&u({status:e.cause?.status||500,headers:{},body:""})}}),eu=ei?.app_config?.protocol??"https",ed=ei?.app_config?.endpoint??"",ep=`${eu}://${ed}/functions/v1/${l}`,ef=(0,x.useForm)({resolver:(0,f.zodResolver)(et),defaultValues:{method:"POST",body:'{ "name": "Functions" }',headers:[{key:"",value:""}],queryParams:[{key:"",value:""}]}}),{method:em}=ef.watch(),{fields:eg,append:ey,remove:ex}=(0,x.useFieldArray)({control:ef.control,name:"headers"}),{fields:eb,append:eS,remove:ej}=(0,x.useFieldArray)({control:ef.control,name:"queryParams"}),ev=async e=>{let t;b(null),u(null);try{JSON.parse(JSON.stringify(e.body))}catch(e){ef.setError("body",{message:"Must be a valid JSON string"});return}let s=h().role;if(void 0!==n&&ea?.jwt_secret!==void 0&&void 0!==s&&"postgrest"===s.type)try{let e=await (0,P.getRoleImpersonationJWT)(n,ea.jwt_secret,s);t="Bearer "+e}catch(e){console.error("Failed to generate JWT:",{error:e.message,roleDetails:s})}let r={};e.headers.forEach(({key:e,value:t})=>{e&&t&&(r[e]=t)});let a=e.queryParams.filter(({key:e,value:t})=>e&&t).map(({key:e,value:t})=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join("&");eh({url:a?`${ep}?${a}`:ep,method:e.method,body:e.body,headers:{...en&&{Authorization:`Bearer ${en}`},"x-test-authorization":t??`Bearer ${eo?.api_key}`,"Content-Type":"application/json",...r}})},ew=(e,s)=>(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(V.Label_Shadcn_,{className:"text-foreground text-sm",children:s}),(0,t.jsxs)(E.Button,{type:"default",size:"tiny",icon:(0,t.jsx)(g.Plus,{size:14}),onClick:()=>{"headers"===e?ey({key:"",value:""}):eS({key:"",value:""})},children:["Add ",s]})]}),(0,t.jsx)("div",{className:"border rounded-md bg-surface-200",children:("headers"===e?eg:eb).map((s,r)=>(0,t.jsxs)("div",{className:"grid grid-cols-[1fr,1fr,32px] border-b last:border-b-0",children:[(0,t.jsx)(M.FormField_Shadcn_,{control:ef.control,name:`${e}.${r}.key`,render:({field:e})=>(0,t.jsx)(B.FormControl_Shadcn_,{children:(0,t.jsx)(H.Input_Shadcn_,{...e,size:"tiny",placeholder:"Enter key...",disabled:ec,className:"h-auto py-2 font-mono rounded-none shadow-none bg-transparent border-l-0 border-r-1 border-t-0 border-b-0 border-border"})})}),(0,t.jsx)(M.FormField_Shadcn_,{control:ef.control,name:`${e}.${r}.value`,render:({field:e})=>(0,t.jsx)(B.FormControl_Shadcn_,{children:(0,t.jsx)(H.Input_Shadcn_,{...e,size:"tiny",placeholder:"Enter value...",disabled:ec,className:"h-auto py-2 font-mono rounded-none shadow-none bg-transparent border-none"})})}),(0,t.jsx)("div",{className:"flex items-center justify-center",children:("headers"===e?eg:eb).length>1&&(0,t.jsx)(E.Button,{type:"text",size:"tiny",icon:(0,t.jsx)(y.X,{strokeWidth:1.5,size:14}),className:"w-6 h-6",onClick:()=>{"headers"===e?ex(r):ej(r)}})})]},s.id))})]});return(0,t.jsx)(Q.Sheet,{open:e,onOpenChange:r,children:(0,t.jsxs)(Q.SheetContent,{size:"default",className:"flex flex-col gap-0 p-0",children:[(0,t.jsx)(Q.SheetHeader,{children:(0,t.jsxs)(Q.SheetTitle,{children:["Test ",l]})}),(0,t.jsx)(O.Form_Shadcn_,{...ef,children:(0,t.jsxs)("form",{onSubmit:ef.handleSubmit(ev),className:"flex-1 overflow-y-auto flex flex-col",children:[(0,t.jsxs)(R.ResizablePanelGroup,{direction:"vertical",children:[(0,t.jsx)(R.ResizablePanel,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-y-4 p-5 h-full overflow-y-auto",children:[(0,t.jsx)(M.FormField_Shadcn_,{control:ef.control,name:"method",render:({field:e})=>(0,t.jsx)(Z.FormItemLayout,{layout:"vertical",label:"HTTP Method",children:(0,t.jsx)(B.FormControl_Shadcn_,{children:(0,t.jsxs)(I.Select_Shadcn_,{value:e.value,onValueChange:e.onChange,disabled:ec,children:[(0,t.jsx)(W.SelectTrigger_Shadcn_,{className:"w-full",children:(0,t.jsx)(q.SelectValue_Shadcn_,{placeholder:"Select method"})}),(0,t.jsx)(D.SelectContent_Shadcn_,{children:ee.HTTP_METHODS.map(e=>(0,t.jsx)(U.SelectItem_Shadcn_,{value:e,children:e},e))})]})})})}),"GET"!==em&&(0,t.jsx)(M.FormField_Shadcn_,{control:ef.control,name:"body",render:({field:e})=>(0,t.jsx)(Z.FormItemLayout,{layout:"vertical",label:"Request Body",children:(0,t.jsx)(B.FormControl_Shadcn_,{children:(0,t.jsx)(Y.TextArea_Shadcn_,{...e,placeholder:"Request body (JSON)",rows:3,disabled:ec,className:"font-mono text-xs"})})})}),ew("headers","Headers"),ew("queryParams","Query Parameters")]})}),(0,t.jsx)(R.ResizableHandle,{withHandle:!0}),(0,t.jsx)(R.ResizablePanel,{defaultSize:41,minSize:41,maxSize:83,children:(0,t.jsx)("div",{className:"h-full bg-surface-100 border-t flex-1 flex flex-col overflow-hidden",children:c?(0,t.jsx)("div",{className:"h-full bg-surface-100 flex flex-col overflow-hidden",children:p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex gap-2 items-center p-5 text-sm pb-3",children:["Function responded with",(0,t.jsx)(F.Badge,{variant:c.status>=400?"destructive":"success",children:c.status})]}),(0,t.jsx)("p",{className:"px-5 text-sm text-foreground-light",children:p})]}):(0,t.jsxs)(J.Tabs_Shadcn_,{defaultValue:"body",className:"h-full flex-1 flex flex-col overflow-hidden",children:[(0,t.jsxs)(G.TabsList_Shadcn_,{className:"gap-4 px-5 pt-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,t.jsx)(X.TabsTrigger_Shadcn_,{className:"text-sm",value:"body",children:"Body"}),(0,t.jsx)(X.TabsTrigger_Shadcn_,{className:"text-sm",value:"headers",children:"Headers"})]}),(0,t.jsx)(F.Badge,{variant:c.status>=400?"destructive":"success",className:"-translate-y-1",children:c.status})]}),(0,t.jsx)(K.TabsContent_Shadcn_,{value:"body",className:"mt-0 flex-1 overflow-auto p-0",children:(0,t.jsx)(z.CodeBlock,{language:"json",hideLineNumbers:!0,className:"rounded-md !border-none !px-4 !py-3 h-full",value:(0,L.prettifyJSON)(c.body)})}),(0,t.jsx)(K.TabsContent_Shadcn_,{value:"headers",className:"mt-0 flex-1 overflow-auto p-0",children:(0,t.jsx)(z.CodeBlock,{language:"json",hideLineNumbers:!0,className:"rounded-md !border-none !px-4 !py-3 h-full",value:(0,L.prettifyJSON)(JSON.stringify(c.headers,null,2))})})]})}):ec?(0,t.jsxs)("div",{className:"h-full flex flex-col items-center justify-center gap-2",children:[(0,t.jsx)(m.Loader2,{size:24,className:"text-foreground-muted animate-spin"}),(0,t.jsx)("p",{className:"text-sm text-foreground-light",children:"Sending request..."})]}):(0,t.jsxs)("div",{className:"h-full flex flex-col items-center justify-center gap-2",children:[(0,t.jsx)(i.Send,{size:24,className:"text-foreground-muted"}),(0,t.jsx)("p",{className:"text-sm text-foreground-light",children:"Send your first test request"})]})})})]}),(0,t.jsx)(Q.SheetFooter,{className:"px-5 py-3 border-t",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)($.RoleImpersonationStateContextProvider,{children:(0,t.jsx)(S.RoleImpersonationPopover,{disallowAuthenticatedOption:!0})},`role-impersonation-state-${n}`),(0,t.jsx)(E.Button,{type:"primary",htmlType:"submit",loading:ec,disabled:ec,onClick:()=>el({action:"edge_function_test_send_button_clicked",properties:{httpMethod:em},groups:{project:n??"Unknown",organization:a?.slug??"Unknown"}}),children:"Send Request"})]})})]})})]})})};var er=e.i(525070),ea=e.i(513826),ei=e.i(693241),en=e.i(229914),eo=e.i(445547),el=e.i(951138),eh=e.i(210419),ec=e.i(773720),eu=e.i(242572),ed=e.i(996166),ep=e.i(165263),ef=e.i(547723),em=e.i(689805),eg=e.i(793912),ey=e.i(135144),ex=e.i(479095),eb=e.i(746301),eS=e.i(456050),ej=e.i(825713),ev=e.i(839941);let ew=(0,el.withAuth)(({title:e,children:f})=>{let m=(0,n.useRouter)(),{data:g}=(0,A.useSelectedOrganizationQuery)(),{functionSlug:y,ref:x}=(0,d.useParams)(),{mutate:b}=(0,N.useSendEventMutation)(),S=(0,p.useIsAPIDocsSidePanelEnabled)(),{isLoading:j,can:v}=(0,_.useAsyncCheckPermissions)(s.PermissionAction.FUNCTIONS_READ,"*"),[w,k]=(0,o.useState)(!1),{data:C,error:L,isError:P}=(0,eo.useEdgeFunctionQuery)({projectRef:x,slug:y}),{data:$={version:0,files:[]},error:F}=(0,en.useEdgeFunctionBodyQuery)({projectRef:x,slug:y},{retry:!1,retryOnMount:!0,refetchOnWindowFocus:!1,staleTime:1/0,refetchOnMount:!1,refetchOnReconnect:!1,refetchInterval:!1,refetchIntervalInBackground:!1}),z=C?.name||"",O=[{label:"Edge Functions",href:`/project/${x}/functions`},{label:y,href:`/project/${x}/functions/${y}`}],B=y?[...u.IS_PLATFORM?[{label:"Overview",href:`/project/${x}/functions/${y}`},{label:"Invocations",href:`/project/${x}/functions/${y}/invocations`},{label:"Logs",href:`/project/${x}/functions/${y}/logs`},{label:"Code",href:`/project/${x}/functions/${y}/code`}]:[],{label:"Details",href:`/project/${x}/functions/${y}/details`}]:[],M=async()=>{if(F)return l.toast.error("Failed to retrieve edge function files");let e=new h.BlobWriter("application/zip"),t=new c.ZipWriter(e,{bufferedWrite:!0}),s=$.files.map(e=>{let t=e.name.split("/"),s=t.indexOf(y??"");return t.slice(s+1).join("/")}),r=0;s.forEach(e=>{let t=e.split("/"),s=0;for(let e of t)if(".."===e)s++;else break;r=Math.max(r,s)}),$.files.forEach(e=>{let s=e.name.split("/"),a=s.indexOf(y??""),i=s.slice(a+1).join("/").split("/"),n=0;for(;i.length>0&&".."===i[0];)i.shift(),n++;let o=r-n,l=o>0?Array.from({length:o},(e,t)=>0===t?"src":`src${t}`).join("/")+"/"+i.join("/"):i.join("/"),c=new Blob([e.content]);t.add(l,new h.BlobReader(c))});let a=URL.createObjectURL(await t.close()),i=document.createElement("a");i.href=a,i.setAttribute("download",`${y}.zip`),document.body.appendChild(i),i.click(),i.parentNode?.removeChild(i)};return((0,o.useEffect)(()=>{let e=!1;return y&&P&&404===L.code&&!e&&((0,l.toast)("Edge function cannot be found in your project"),m.push(`/project/${x}/functions`)),()=>{e=!0}},[P]),j||v)?(0,t.jsx)(ev.default,{children:(0,t.jsxs)("div",{className:"w-full min-h-full flex flex-col items-stretch",children:[(0,t.jsxs)(eS.PageHeader,{size:"full",className:"sticky top-0 z-10 bg-background",children:[O.length>0&&(0,t.jsx)(eS.PageHeaderBreadcrumb,{children:(0,t.jsx)(ed.BreadcrumbList_Shadcn_,{children:O.map((e,s)=>(0,t.jsxs)(o.default.Fragment,{children:[(0,t.jsx)(ec.BreadcrumbItem_Shadcn_,{children:e.href?(0,t.jsx)(eu.BreadcrumbLink_Shadcn_,{asChild:!0,children:(0,t.jsx)(eh.default,{href:e.href,children:e.label})}):(0,t.jsx)("span",{children:e.label})}),s<O.length-1&&(0,t.jsx)(ep.BreadcrumbSeparator_Shadcn_,{})]},e.label||`breadcrumb-${s}`))})}),(0,t.jsxs)(eS.PageHeaderMeta,{children:[(0,t.jsx)(eS.PageHeaderSummary,{children:(0,t.jsx)(eS.PageHeaderTitle,{children:y?z:"Edge Functions"})}),(0,t.jsx)(eS.PageHeaderAside,{children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[S&&(0,t.jsx)(er.APIDocsButton,{section:void 0!==y?["edge-functions",y]:["edge-functions"],source:"edge-functions"}),(0,t.jsx)(ea.DocsButton,{href:`${T.DOCS_URL}/guides/functions`}),u.IS_PLATFORM&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(em.Popover_Shadcn_,{children:[(0,t.jsx)(ey.PopoverTrigger_Shadcn_,{asChild:!0,children:(0,t.jsx)(E.Button,{type:"default",icon:(0,t.jsx)(r.Download,{}),children:"Download"})}),(0,t.jsxs)(eg.PopoverContent_Shadcn_,{align:"end",className:"p-0",children:[(0,t.jsxs)("div",{className:"p-3 flex flex-col gap-y-2",children:[(0,t.jsx)("p",{className:"text-xs text-foreground-light",children:"Download via CLI"}),(0,t.jsx)(eb.Input,{copy:!0,showCopyOnHover:!0,readOnly:!0,containerClassName:"",className:"text-xs font-mono tracking-tighter",value:`supabase functions download ${y}`})]}),(0,t.jsx)(ex.Separator,{className:"!bg-border-overlay"}),(0,t.jsx)("div",{className:"py-2 px-1",children:(0,t.jsx)(E.Button,{type:"text",className:"w-min hover:bg-transparent",icon:(0,t.jsx)(a.FileArchive,{}),onClick:M,children:"Download as ZIP"})})]})]}),!!y&&(0,t.jsx)(E.Button,{type:"default",icon:(0,t.jsx)(i.Send,{}),onClick:()=>{k(!0),b({action:"edge_function_test_side_panel_opened",groups:{project:x??"Unknown",organization:g?.slug??"Unknown"}})},children:"Test"})]})]})})]}),B.length>0&&(0,t.jsx)(eS.PageHeaderNavigationTabs,{children:(0,t.jsx)(ef.NavMenu,{children:B.map(e=>{let s=m.asPath.split("?")[0]===e.href;return(0,t.jsx)(ef.NavMenuItem,{active:s,children:(0,t.jsx)(eh.default,{href:e.href,children:e.label})},e.label)})})})]}),f,(0,t.jsx)(es,{visible:w,onClose:()=>k(!1)})]})}):(0,t.jsx)(ej.ProjectLayout,{title:e||"Edge Functions",product:"Edge Functions",children:(0,t.jsx)(ei.default,{isFullPage:!0,resourceText:"access your project's edge functions"})})});e.s(["default",0,ew],780990)},773720,242572,996166,165263,e=>{"use strict";var t=e.i(3259);e.s(["BreadcrumbItem_Shadcn_",()=>t.BreadcrumbItem],773720),e.s(["BreadcrumbLink_Shadcn_",()=>t.BreadcrumbLink],242572),e.s(["BreadcrumbList_Shadcn_",()=>t.BreadcrumbList],996166),e.s(["BreadcrumbSeparator_Shadcn_",()=>t.BreadcrumbSeparator],165263)},229914,e=>{"use strict";var t=e.i(201780);function s(e,t=";"){let r,a=";"===t?/(?:^|;)\s*([^=;\s]+)(\s*=\s*(?:"((?:[^"\\]|\\.)*)"|((?:[^;]|\\\;)+))?)?/g:/(?:^|,)\s*([^=,\s]+)(\s*=\s*(?:"((?:[^"\\]|\\.)*)"|((?:[^,]|\\\,)+))?)?/g,i=[];for(;null!==(r=a.exec(e));){let e,t=r[1].trim();r[2]&&(e=(r[3]||r[4]||"").replace(/\\(.)/g,"$1").trim()),i.push([t,e])}return i}function r(e){return e.includes('"')||e.includes(";")||e.includes(" ")?`"${e.replace(/"/g,'\\"')}"`:e}function a(e){return null!=e&&"function"==typeof e[Symbol.iterator]}function i(e){return"*"===e||/^(W\/)?".*"$/.test(e)?e:`"${e}"`}var n=class{#e;constructor(e){if(this.#e=new Map,e){if("string"==typeof e)for(let t of e.split(/\s*,\s*/)){let e=s(t);if(e.length<1)continue;let r=e[0][0],a=1;for(let t=1;t<e.length;t++){let[s,r]=e[t];if("q"===s){a=Number(r);break}}this.#e.set(r.toLowerCase(),a)}else if(a(e))for(let t of e)Array.isArray(t)?this.#e.set(t[0].toLowerCase(),t[1]):this.#e.set(t.toLowerCase(),1);else for(let t of Object.getOwnPropertyNames(e))this.#e.set(t.toLowerCase(),e[t]);this.#t()}}#t(){this.#e=new Map([...this.#e].sort((e,t)=>t[1]-e[1]))}get mediaTypes(){return Array.from(this.#e.keys())}get weights(){return Array.from(this.#e.values())}get size(){return this.#e.size}accepts(e){return this.getWeight(e)>0}getWeight(e){let[t,s]=e.toLowerCase().split("/");for(let[e,r]of this){let[a,i]=e.split("/");if((a===t||"*"===a||"*"===t)&&(i===s||"*"===i||"*"===s))return r}return 0}getPreferred(e){let t=e.map(e=>[e,this.getWeight(e)]).sort((e,t)=>t[1]-e[1])[0];return void 0!==t&&t[1]>0?t[0]:null}get(e){return this.#e.get(e.toLowerCase())??null}set(e,t=1){this.#e.set(e.toLowerCase(),t),this.#t()}delete(e){this.#e.delete(e.toLowerCase())}has(e){return this.#e.has(e.toLowerCase())}clear(){this.#e.clear()}entries(){return this.#e.entries()}[Symbol.iterator](){return this.entries()}forEach(e,t){for(let[s,r]of this)e.call(t,s,r,this)}toString(){let e=[];for(let[t,s]of this.#e)e.push(`${t}${1===s?"":`;q=${s}`}`);return e.join(",")}},o=class{#e;constructor(e){if(this.#e=new Map,e){if("string"==typeof e)for(let t of e.split(/\s*,\s*/)){let e=s(t);if(e.length<1)continue;let r=e[0][0],a=1;for(let t=1;t<e.length;t++){let[s,r]=e[t];if("q"===s){a=Number(r);break}}this.#e.set(r.toLowerCase(),a)}else if(a(e))for(let t of e)Array.isArray(t)?this.#e.set(t[0].toLowerCase(),t[1]):this.#e.set(t.toLowerCase(),1);else for(let t of Object.getOwnPropertyNames(e))this.#e.set(t.toLowerCase(),e[t]);this.#t()}}#t(){this.#e=new Map([...this.#e].sort((e,t)=>t[1]-e[1]))}get encodings(){return Array.from(this.#e.keys())}get weights(){return Array.from(this.#e.values())}get size(){return this.#e.size}accepts(e){return"identity"===e.toLowerCase()||this.getWeight(e)>0}getWeight(e){let t=e.toLowerCase();for(let[e,s]of this)if(e===t||"*"===e||"*"===t)return s;return 0}getPreferred(e){let t=e.map(e=>[e,this.getWeight(e)]).sort((e,t)=>t[1]-e[1])[0];return void 0!==t&&t[1]>0?t[0]:null}get(e){return this.#e.get(e.toLowerCase())??null}set(e,t=1){this.#e.set(e.toLowerCase(),t),this.#t()}delete(e){this.#e.delete(e.toLowerCase())}has(e){return this.#e.has(e.toLowerCase())}clear(){this.#e.clear()}entries(){return this.#e.entries()}[Symbol.iterator](){return this.entries()}forEach(e,t){for(let[s,r]of this)e.call(t,s,r,this)}toString(){let e=[];for(let[t,s]of this.#e)e.push(`${t}${1===s?"":`;q=${s}`}`);return e.join(",")}},l=class{#e;constructor(e){if(this.#e=new Map,e){if("string"==typeof e)for(let t of e.split(/\s*,\s*/)){let e=s(t);if(e.length<1)continue;let r=e[0][0],a=1;for(let t=1;t<e.length;t++){let[s,r]=e[t];if("q"===s){a=Number(r);break}}this.#e.set(r.toLowerCase(),a)}else if(a(e))for(let t of e)Array.isArray(t)?this.#e.set(t[0].toLowerCase(),t[1]):this.#e.set(t.toLowerCase(),1);else for(let t of Object.getOwnPropertyNames(e))this.#e.set(t.toLowerCase(),e[t]);this.#t()}}#t(){this.#e=new Map([...this.#e].sort((e,t)=>t[1]-e[1]))}get languages(){return Array.from(this.#e.keys())}get weights(){return Array.from(this.#e.values())}get size(){return this.#e.size}accepts(e){return this.getWeight(e)>0}getWeight(e){let[t,s]=e.toLowerCase().split("-");for(let[e,r]of this){let[a,i]=e.split("-");if((a===t||"*"===a||"*"===t)&&(i===s||void 0===i||void 0===s))return r}return 0}getPreferred(e){let t=e.map(e=>[e,this.getWeight(e)]).sort((e,t)=>t[1]-e[1])[0];return void 0!==t&&t[1]>0?t[0]:null}get(e){return this.#e.get(e.toLowerCase())??null}set(e,t=1){this.#e.set(e.toLowerCase(),t),this.#t()}delete(e){this.#e.delete(e.toLowerCase())}has(e){return this.#e.has(e.toLowerCase())}clear(){this.#e.clear()}entries(){return this.#e.entries()}[Symbol.iterator](){return this.entries()}forEach(e,t){for(let[s,r]of this)e.call(t,s,r,this)}toString(){let e=[];for(let[t,s]of this.#e)e.push(`${t}${1===s?"":`;q=${s}`}`);return e.join(",")}},h=class{maxAge;maxStale;minFresh;sMaxage;noCache;noStore;noTransform;onlyIfCached;mustRevalidate;proxyRevalidate;mustUnderstand;private;public;immutable;staleWhileRevalidate;staleIfError;constructor(e){if(e)if("string"==typeof e){let t=s(e,",");if(t.length>0)for(let[e,s]of t)switch(e){case"max-age":this.maxAge=Number(s);break;case"max-stale":this.maxStale=Number(s);break;case"min-fresh":this.minFresh=Number(s);break;case"s-maxage":this.sMaxage=Number(s);break;case"no-cache":this.noCache=!0;break;case"no-store":this.noStore=!0;break;case"no-transform":this.noTransform=!0;break;case"only-if-cached":this.onlyIfCached=!0;break;case"must-revalidate":this.mustRevalidate=!0;break;case"proxy-revalidate":this.proxyRevalidate=!0;break;case"must-understand":this.mustUnderstand=!0;break;case"private":this.private=!0;break;case"public":this.public=!0;break;case"immutable":this.immutable=!0;break;case"stale-while-revalidate":this.staleWhileRevalidate=Number(s);break;case"stale-if-error":this.staleIfError=Number(s)}}else this.maxAge=e.maxAge,this.maxStale=e.maxStale,this.minFresh=e.minFresh,this.sMaxage=e.sMaxage,this.noCache=e.noCache,this.noStore=e.noStore,this.noTransform=e.noTransform,this.onlyIfCached=e.onlyIfCached,this.mustRevalidate=e.mustRevalidate,this.proxyRevalidate=e.proxyRevalidate,this.mustUnderstand=e.mustUnderstand,this.private=e.private,this.public=e.public,this.immutable=e.immutable,this.staleWhileRevalidate=e.staleWhileRevalidate,this.staleIfError=e.staleIfError}toString(){let e=[];return this.public&&e.push("public"),this.private&&e.push("private"),"number"==typeof this.maxAge&&e.push(`max-age=${this.maxAge}`),"number"==typeof this.sMaxage&&e.push(`s-maxage=${this.sMaxage}`),this.noCache&&e.push("no-cache"),this.noStore&&e.push("no-store"),this.noTransform&&e.push("no-transform"),this.onlyIfCached&&e.push("only-if-cached"),this.mustRevalidate&&e.push("must-revalidate"),this.proxyRevalidate&&e.push("proxy-revalidate"),this.mustUnderstand&&e.push("must-understand"),this.immutable&&e.push("immutable"),"number"==typeof this.staleWhileRevalidate&&e.push(`stale-while-revalidate=${this.staleWhileRevalidate}`),"number"==typeof this.staleIfError&&e.push(`stale-if-error=${this.staleIfError}`),"number"==typeof this.maxStale&&e.push(`max-stale=${this.maxStale}`),"number"==typeof this.minFresh&&e.push(`min-fresh=${this.minFresh}`),e.join(", ")}},c=class{filename;filenameSplat;name;type;constructor(e){if(e)if("string"==typeof e){let t=s(e);if(t.length>0)for(let[e,s]of(this.type=t[0][0],t.slice(1)))"filename"===e?this.filename=s:"filename*"===e?this.filenameSplat=s:"name"===e&&(this.name=s)}else this.filename=e.filename,this.filenameSplat=e.filenameSplat,this.name=e.name,this.type=e.type}get preferredFilename(){let e=this.filenameSplat;if(e){let t=function(e){let t=e.match(/^([\w-]+)'([^']*)'(.+)$/);if(!t)return null;let[,s,,r]=t,a=r.replace(/\+/g," ").replace(/%([0-9A-Fa-f]{2})/g,(e,t)=>String.fromCharCode(parseInt(t,16)));try{let e=new TextDecoder(s),t=new Uint8Array(a.split("").map(e=>e.charCodeAt(0)));return e.decode(t)}catch(e){return console.warn(`Failed to decode filename from charset ${s}:`,e),a}}(e);if(t)return t}return this.filename}toString(){if(!this.type)return"";let e=[this.type];return this.name&&e.push(`name=${r(this.name)}`),this.filename&&e.push(`filename=${r(this.filename)}`),this.filenameSplat&&e.push(`filename*=${r(this.filenameSplat)}`),e.join("; ")}},u=class{boundary;charset;mediaType;constructor(e){if(e)if("string"==typeof e){let t=s(e);if(t.length>0)for(let[e,s]of(this.mediaType=t[0][0],t.slice(1)))"boundary"===e?this.boundary=s:"charset"===e&&(this.charset=s)}else this.boundary=e.boundary,this.charset=e.charset,this.mediaType=e.mediaType}toString(){if(!this.mediaType)return"";let e=[this.mediaType];return this.charset&&e.push(`charset=${r(this.charset)}`),this.boundary&&e.push(`boundary=${r(this.boundary)}`),e.join("; ")}},d=class{#e;constructor(e){if(this.#e=new Map,e)if("string"==typeof e)for(let[t,r]of s(e))this.#e.set(t,r??"");else if(a(e))for(let[t,s]of e)this.#e.set(t,s);else for(let t of Object.getOwnPropertyNames(e))this.#e.set(t,e[t])}get names(){return Array.from(this.#e.keys())}get values(){return Array.from(this.#e.values())}get size(){return this.#e.size}get(e){return this.#e.get(e)??null}set(e,t){this.#e.set(e,t)}delete(e){this.#e.delete(e)}has(e){return this.#e.has(e)}clear(){this.#e.clear()}entries(){return this.#e.entries()}[Symbol.iterator](){return this.entries()}forEach(e,t){for(let[s,r]of this)e.call(t,s,r,this)}toString(){let e=[];for(let[t,s]of this.#e)e.push(`${t}=${r(s)}`);return e.join("; ")}},p=class{tags=[];constructor(e){e&&("string"==typeof e?this.tags.push(...e.split(/\s*,\s*/).map(i)):Array.isArray(e)?this.tags.push(...e.map(i)):this.tags.push(...e.tags.map(i)))}has(e){return this.tags.includes(i(e))}matches(e){return this.has(e)||this.tags.includes("*")}toString(){return this.tags.join(", ")}},f=class{domain;expires;httpOnly;maxAge;name;path;sameSite;secure;value;constructor(e){if(e)if("string"==typeof e){let t=s(e);if(t.length>0)for(let[e,s]of(this.name=t[0][0],this.value=t[0][1],t.slice(1)))switch(e.toLowerCase()){case"domain":this.domain=s;break;case"expires":if("string"==typeof s){let e=new Date(s);(function(e){return e instanceof Date&&!isNaN(e.getTime())})(e)&&(this.expires=e)}break;case"httponly":this.httpOnly=!0;break;case"max-age":if("string"==typeof s){let e=parseInt(s,10);isNaN(e)||(this.maxAge=e)}break;case"path":this.path=s;break;case"samesite":"string"==typeof s&&/strict|lax|none/i.test(s)&&(this.sameSite=function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}(s));break;case"secure":this.secure=!0}}else this.domain=e.domain,this.expires=e.expires,this.httpOnly=e.httpOnly,this.maxAge=e.maxAge,this.name=e.name,this.path=e.path,this.sameSite=e.sameSite,this.secure=e.secure,this.value=e.value}toString(){if(!this.name)return"";let e=[`${this.name}=${r(this.value||"")}`];return this.domain&&e.push(`Domain=${this.domain}`),this.path&&e.push(`Path=${this.path}`),this.expires&&e.push(`Expires=${this.expires.toUTCString()}`),this.maxAge&&e.push(`Max-Age=${this.maxAge}`),this.secure&&e.push("Secure"),this.httpOnly&&e.push("HttpOnly"),this.sameSite&&e.push(`SameSite=${this.sameSite}`),e.join("; ")}},m={ct:"CT",etag:"ETag",te:"TE",www:"WWW",x:"X",xss:"XSS"},g="accept",y="accept-encoding",x="accept-language",b="accept-ranges",S="cache-control",j="connection",v="content-disposition",w="content-encoding",k="content-language",C="content-length",N="content-type",_="cookie",A="date",T="etag",L="expires",P="host",$="if-modified-since",F="if-none-match",E="if-unmodified-since",z="last-modified",O="location",B="referer",M="set-cookie",H=class e extends Headers{#e;#s=[];constructor(t){if(super(),this.#e=new Map,t){if("string"==typeof t)for(let e of t.split("\r\n")){let t=e.match(/^([^:]+):(.*)/);t&&this.append(t[1].trim(),t[2].trim())}else if(a(t))for(let[e,s]of t)this.append(e,s);else if("object"==typeof t)for(let s of Object.getOwnPropertyNames(t)){let r=t[s],a=Object.getOwnPropertyDescriptor(e.prototype,s);a?.set?a.set.call(this,r):this.set(s,r.toString())}}}append(e,t){let s=e.toLowerCase();if(s===M)this.#s.push(t);else{let e=this.#e.get(s);this.#e.set(s,e?`${e}, ${t}`:t)}}delete(e){let t=e.toLowerCase();t===M?this.#s=[]:this.#e.delete(t)}get(e){let t=e.toLowerCase();if(t===M)return this.getSetCookie().join(", ");{let e=this.#e.get(t);if("string"==typeof e)return e;if(null==e)return null;{let t=e.toString();return""===t?null:t}}}getSetCookie(){return this.#s.map(e=>"string"==typeof e?e:e.toString())}has(e){let t=e.toLowerCase();return t===M?this.#s.length>0:null!=this.get(t)}set(e,t){let s=e.toLowerCase();s===M?this.#s=[t]:this.#e.set(s,t)}*keys(){for(let[e]of this)yield e}*values(){for(let[,e]of this)yield e}*entries(){for(let[e]of this.#e){let t=this.get(e);t&&(yield[e,t])}for(let e of this.getSetCookie())yield[M,e]}[Symbol.iterator](){return this.entries()}forEach(e,t){for(let[s,r]of this)e.call(t,r,s,this)}toString(){let e=[];for(let[t,s]of this)e.push(`${t.toLowerCase().split("-").map(e=>m[e]||e.charAt(0).toUpperCase()+e.slice(1)).join("-")}: ${s}`);return e.join("\r\n")}get accept(){return this.#r(g,n)}set accept(e){this.#a(g,n,e)}get acceptEncoding(){return this.#r(y,o)}set acceptEncoding(e){this.#a(y,o,e)}get acceptLanguage(){return this.#r(x,l)}set acceptLanguage(e){this.#a(x,l,e)}get acceptRanges(){return this.#i(b)}set acceptRanges(e){this.#n(b,e)}get age(){return this.#o("age")}set age(e){this.#l("age",e)}get cacheControl(){return this.#r(S,h)}set cacheControl(e){this.#a(S,h,e)}get connection(){return this.#i(j)}set connection(e){this.#n(j,e)}get contentDisposition(){return this.#r(v,c)}set contentDisposition(e){this.#a(v,c,e)}get contentEncoding(){return this.#i(w)}set contentEncoding(e){this.#n(w,Array.isArray(e)?e.join(", "):e)}get contentLanguage(){return this.#i(k)}set contentLanguage(e){this.#n(k,Array.isArray(e)?e.join(", "):e)}get contentLength(){return this.#o(C)}set contentLength(e){this.#l(C,e)}get contentType(){return this.#r(N,u)}set contentType(e){this.#a(N,u,e)}get cookie(){return this.#r(_,d)}set cookie(e){this.#a(_,d,e)}get date(){return this.#h(A)}set date(e){this.#c(A,e)}get etag(){return this.#i(T)}set etag(e){this.#n(T,"string"==typeof e?i(e):e)}get expires(){return this.#h(L)}set expires(e){this.#c(L,e)}get host(){return this.#i(P)}set host(e){this.#n(P,e)}get ifModifiedSince(){return this.#h($)}set ifModifiedSince(e){this.#c($,e)}get ifNoneMatch(){return this.#r(F,p)}set ifNoneMatch(e){this.#a(F,p,e)}get ifUnmodifiedSince(){return this.#h(E)}set ifUnmodifiedSince(e){this.#c(E,e)}get lastModified(){return this.#h(z)}set lastModified(e){this.#c(z,e)}get location(){return this.#i(O)}set location(e){this.#n(O,e)}get referer(){return this.#i(B)}set referer(e){this.#n(B,e)}get setCookie(){let e=this.#s;for(let t=0;t<e.length;++t)"string"==typeof e[t]&&(e[t]=new f(e[t]));return e}set setCookie(e){null!=e?this.#s=(Array.isArray(e)?e:[e]).map(e=>"string"==typeof e?e:new f(e)):this.#s=[]}#r(e,t){let s=this.#e.get(e);if(void 0!==s)if("string"!=typeof s)return s;else{let r=new t(s);return this.#e.set(e,r),r}let r=new t;return this.#e.set(e,r),r}#a(e,t,s){null!=s?this.#e.set(e,"string"==typeof s?s:new t(s)):this.#e.delete(e)}#h(e){let t=this.#e.get(e);return void 0===t?null:new Date(t)}#c(e,t){null!=t?this.#e.set(e,"string"==typeof t?t:("number"==typeof t?new Date(t):t).toUTCString()):this.#e.delete(e)}#o(e){let t=this.#e.get(e);return void 0===t?null:parseInt(t,10)}#l(e,t){null!=t?this.#e.set(e,"string"==typeof t?t:t.toString()):this.#e.delete(e)}#i(e){let t=this.#e.get(e);return void 0===t?null:t}#n(e,t){null!=t?this.#e.set(e,t):this.#e.delete(e)}};async function*V(e){let t=e.getReader();try{for(;;){let{done:e,value:s}=await t.read();if(e)break;yield s}}finally{t.releaseLock()}}function R(e){let s,r=new TextEncoder().encode(e);if("Buffer"in globalThis&&!("Bun"in globalThis||"Deno"in globalThis))s=(e,s=0)=>t.Buffer.prototype.indexOf.call(e,r,s);else{let e=r.length-1,t=new Uint8Array(256).fill(r.length);for(let s=0;s<e;++s)t[r[s]]=e-s;s=(s,a=0)=>{let i=s.length,n=a+e;for(;n<i;){for(let t=e,a=n;t>=0&&s[a]===r[t];--t,--a)if(0===t)return a;n+=t[s[n]]}return -1}}return s}var I=class extends Error{constructor(e){super(e),this.name="MultipartParseError"}},D=class extends I{constructor(e){super(`Multipart header size exceeds maximum allowed size of ${e} bytes`),this.name="MaxHeaderSizeExceededError"}},U=class extends I{constructor(e){super(`File size exceeds maximum allowed size of ${e} bytes`),this.name="MaxFileSizeExceededError"}};async function*W(e,t){let s=new Q(t.boundary,{maxHeaderSize:t.maxHeaderSize,maxFileSize:t.maxFileSize});for await(let t of V(e))0!==t.length&&(yield*s.write(t));s.finish()}var q=R("\r\n\r\n"),Q=class{boundary;maxHeaderSize;maxFileSize;#u;#d;#p;#f;#m;#g=0;#y=null;#x=null;#b=0;constructor(e,t){this.boundary=e,this.maxHeaderSize=t?.maxHeaderSize??8192,this.maxFileSize=t?.maxFileSize??2097152,this.#u=R(`--${e}`),this.#d=2+e.length,this.#p=R(`\r
--${e}`),this.#f=function(e){let t=new TextEncoder().encode(e),s={};for(let e=0;e<t.length;++e){let r=t[e];void 0===s[r]&&(s[r]=[]),s[r].push(e)}return function(e){let r=e.length-1;if(e[r]in s){let a=s[e[r]];for(let s=a.length-1;s>=0;--s)for(let i=a[s],n=r;i>=0&&e[n]===t[i];--i,--n)if(0===i)return n}return -1}}(`\r
--${e}`),this.#m=4+e.length}*write(e){if(4===this.#g)throw new I("Unexpected data after end of stream");let t=0,s=e.length;if(null!==this.#y){let t=new Uint8Array(this.#y.length+s);t.set(this.#y,0),t.set(e,this.#y.length),s=(e=t).length,this.#y=null}for(;;){if(3===this.#g){if(s-t<this.#m){this.#y=e.subarray(t);break}let r=this.#p(e,t);if(-1===r){let s=this.#f(e);-1===s?this.#S(0===t?e:e.subarray(t)):(this.#S(e.subarray(t,s)),this.#y=e.subarray(s));break}this.#S(e.subarray(t,r)),yield this.#x,t=r+this.#m,this.#g=1}if(1===this.#g){if(s-t<2){this.#y=e.subarray(t);break}if(45===e[t]&&45===e[t+1]){this.#g=4;break}t+=2,this.#g=2}if(2===this.#g){if(s-t<4){this.#y=e.subarray(t);break}let r=q(e,t);if(-1===r){if(s-t>this.maxHeaderSize)throw new D(this.maxHeaderSize);this.#y=e.subarray(t);break}if(r-t>this.maxHeaderSize)throw new D(this.maxHeaderSize);this.#x=new K(e.subarray(t,r),[]),this.#b=0,t=r+4,this.#g=3;continue}if(0===this.#g){if(s<this.#d){this.#y=e;break}if(0!==this.#u(e))throw new I("Invalid multipart stream: missing initial boundary");t=this.#d,this.#g=1}}}#S(e){if(this.#b+e.length>this.maxFileSize)throw new U(this.maxFileSize);this.#x.content.push(e),this.#b+=e.length}finish(){if(4!==this.#g)throw new I("Multipart stream not finished")}},J=new TextDecoder("utf-8",{fatal:!0}),K=class{content;#j;#v;constructor(e,t){this.#j=e,this.content=t}get arrayBuffer(){return this.bytes.buffer}get bytes(){let e=new Uint8Array(this.size),t=0;for(let s of this.content)e.set(s,t),t+=s.length;return e}get headers(){return this.#v||(this.#v=new H(J.decode(this.#j))),this.#v}get isFile(){return void 0!==this.filename||"application/octet-stream"===this.mediaType}get isText(){return!this.isFile}get filename(){return this.headers.contentDisposition.preferredFilename}get mediaType(){return this.headers.contentType.mediaType}get name(){return this.headers.contentDisposition.name}get size(){let e=0;for(let t of this.content)e+=t.length;return e}get text(){return J.decode(this.bytes)}},G=e.i(242882),X=e.i(234745),Y=e.i(10429),Z=e.i(68205);async function ee({projectRef:e,slug:t},s){var r;let a;if(!e)throw Error("projectRef is required");if(!t)throw Error("slug is required");let{data:i,response:n,error:o}=await (0,X.get)("/v1/projects/{ref}/functions/{function_slug}/body",{params:{path:{ref:e,function_slug:t}},headers:{Accept:"multipart/form-data"},parseAs:"stream",signal:s});o&&(0,X.handleError)(o);let l=(r=n.headers.get("content-type")??"",(a=/boundary=(?:"([^"]+)"|([^;]+))/i.exec(r))?a[1]??a[2]:null),h=[];if(!i||!l)return{files:[]};let c={};for await(let e of W(i,{boundary:l,maxFileSize:0x1400000}))e.isFile?h.push({name:e.filename,content:e.text}):c=JSON.parse(e.text);return{metadata:c,files:h}}e.s(["getEdgeFunctionBody",()=>ee,"useEdgeFunctionBodyQuery",0,({projectRef:e,slug:t},{enabled:s=!0,...r}={})=>(0,G.useQuery)({queryKey:Z.edgeFunctionsKeys.body(e,t),queryFn:({signal:s})=>ee({projectRef:e,slug:t},s),enabled:Y.IS_PLATFORM&&s&&void 0!==e&&void 0!==t,...r})],229914)}]);

//# debugId=a5a2de99-6e8c-786d-c3b6-67efca5432d6
//# sourceMappingURL=e745e2f127a2fee7.js.map