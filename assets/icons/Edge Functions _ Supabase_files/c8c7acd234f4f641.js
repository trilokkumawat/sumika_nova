;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="332cbc5c-4855-7b31-f204-58e640f1ae8c")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,555979,e=>{"use strict";var t=e.i(478902),s=e.i(55956);let a=(0,e.i(388019).default)("Rewind",[["polygon",{points:"11 19 2 12 11 5 11 19",key:"14yba5"}],["polygon",{points:"22 19 13 12 22 5 22 19",key:"1pi1cj"}]]);var r=e.i(271226),l=e.i(389959);e.i(128328);var i=e.i(158639),n=e.i(543851),o=e.i(890054),c=e.i(61187),d=e.i(366652),u=e.i(454931),m=e.i(975924),h=e.i(210419),x=e.i(215312),p=e.i(282492),f=e.i(106579),g=e.i(330287),j=e.i(10429),y=e.i(837710),v=e.i(171997),N=e.i(613580),b=e.i(843778),S=e.i(748356),E=e.i(993394),C=e.i(237002),T=e.i(737018),k=e.i(767073);let I=({options:e,filters:s,onFiltersChange:a,buttonClassName:r,align:i="start",isLoading:n=!1})=>{let o=e.key,[c,d]=(0,l.useState)(!1),[u,m]=(0,l.useState)(s),h=()=>d(!c),x=(0,l.useMemo)(()=>{let e=u[o];return!!("object"==typeof e&&Object.values(e).some(Boolean))},[u,o]);return(0,l.useEffect)(()=>{c||m(s)},[c,s]),(0,t.jsxs)(k.Popover,{open:c,onOpenChange:h,children:[(0,t.jsx)(k.PopoverTrigger,{asChild:!0,children:(0,t.jsx)(y.Button,{type:x?"default":"outline",onClick:h,className:(0,b.cn)("min-w-20 border-dashed",{"border-solid":x},r),children:(0,t.jsx)("span",{children:e.label})})}),(0,t.jsx)(k.PopoverContent,{align:i,className:"p-0 w-60",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),a(u),d(!1)},children:[e.options.map((s,a)=>(0,t.jsxs)(T.Label,{htmlFor:`${e.key}.${s.key}`,className:"flex items-start hover:bg-overlay-hover overflow-hidden p-2 m-1 rounded-sm gap-3 transition-all duration-150 ease-in-out",children:[(0,t.jsx)("div",{children:(0,t.jsx)(C.Checkbox,{value:e.key,id:`${e.key}.${s.key}`,checked:!!u?.[e.key]?.[s.key],onCheckedChange:t=>{m({...u,[e.key]:{...u[e.key],[s.key]:t}})}})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:s.label}),(0,t.jsx)("span",{className:"text-sm text-foreground-lighter",children:s.description})]})]},s.key)),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-default p-2",children:[(0,t.jsx)(y.Button,{size:"tiny",type:"default",onClick:()=>{m({[o]:{}}),a({...s,[o]:{}})},htmlType:"button",children:"Clear"}),(0,t.jsx)(y.Button,{loading:n,type:"primary",htmlType:"submit",children:"Apply"})]})]})})]})},w=({isLoading:e,newCount:s,onRefresh:a,onSearch:C=()=>{},defaultSearchValue:T="",onExploreClick:k,queryUrl:w,condensedLayout:R,isShowingEventChart:_,onToggleEventChart:O,csvData:L,onFiltersChange:P,filters:M,table:D,onSelectedDatabaseChange:F,className:B,selectedDatePickerValue:q,setSelectedDatePickerValue:U})=>{let A=(0,r.useRouter)(),{ref:H}=(0,i.useParams)(),[$,Q]=(0,l.useState)(""),z=A.pathname.split("/").pop(),{data:K}=(0,g.useLoadBalancersQuery)({projectRef:H}),W=j.IS_PLATFORM&&E.LOG_ROUTES_WITH_REPLICA_SUPPORT.includes(A.pathname),G=$!==T,Y=e=>C("search-input-change",{query:e});return(0,l.useEffect)(()=>{$!==T&&Q(T)},[T]),(0,t.jsxs)("div",{className:(0,b.cn)("flex w-full items-center justify-between overflow-x-scroll no-scrollbar",R?" p-3":"",B),children:[(0,t.jsxs)("div",{className:"flex flex-row items-center gap-x-2 mr-2",children:[(0,t.jsx)("form",{id:"log-panel-search",onSubmit:e=>{e.preventDefault(),Y($)},children:(0,t.jsx)(v.Input,{className:"w-60",size:"tiny",placeholder:"Search events",onChange:e=>Q(e.target.value),onBlur:e=>{Q(e.target.value),Y(e.target.value)},icon:(0,t.jsx)("div",{className:"text-foreground-lighter",children:(0,t.jsx)(d.Search,{size:14})}),value:$,actions:(0,t.jsxs)("div",{className:"flex items-center gap-x-1 mr-0.5",children:[G&&(0,t.jsx)(x.ButtonTooltip,{icon:(0,t.jsx)("span",{children:"â†²"}),type:"text",className:"px-1 h-[20px]",onClick:()=>Y($),tooltip:{content:{side:"bottom",text:"Search for events"}}}),$.length>0&&(0,t.jsx)(x.ButtonTooltip,{icon:(0,t.jsx)(m.X,{}),type:"text",className:"p-[1px] h-[20px]",onClick:()=>Y(""),tooltip:{content:{side:"bottom",text:"Clear search"}}})]})})}),(0,t.jsxs)(N.Tooltip,{children:[(0,t.jsx)(N.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(y.Button,{title:"refresh",type:"default",className:"px-1.5",icon:(0,t.jsxs)("div",{className:"relative",children:[s>0&&(0,t.jsxs)("div",{className:"absolute -top-3 right-3 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"absolute z-20",children:(0,t.jsx)("p",{style:{fontSize:"0.6rem"},className:"text-white",children:s>1e3?`${Math.floor(s/100)/10}K`:s})}),(0,t.jsx)("div",{className:"h-4 w-4 animate-ping rounded-full bg-green-800 opacity-60"}),(0,t.jsx)("div",{className:"z-60 absolute top-0 right-0 h-full w-full rounded-full bg-green-900 opacity-80"})]}),(0,t.jsx)(c.RefreshCw,{})]}),loading:e,disabled:e,onClick:a})}),(0,t.jsx)(N.TooltipContent,{side:"bottom",className:"text-xs",children:"Refresh logs"})]}),(0,t.jsx)(S.LogsDatePicker,{helpers:E.PREVIEWER_DATEPICKER_HELPERS,onSubmit:e=>{C("datepicker-change",{to:e.to,from:e.from}),U(e)},value:q}),void 0!==E.FILTER_OPTIONS[D]&&(0,t.jsx)("div",{className:"flex items-center",children:E.FILTER_OPTIONS[D]&&Object.values(E.FILTER_OPTIONS[D]).map((e,s)=>{let a=[];Object.values(E.FILTER_OPTIONS[D]).length>=2&&(0===s?a.push("rounded-tr-none rounded-br-none"):s===Object.values(E.FILTER_OPTIONS[D]).length-1?a.push("rounded-tl-none rounded-bl-none"):a.push("rounded-none"));let r=Object.values(E.FILTER_OPTIONS[D]).length-1;return(0,t.jsx)(I,{buttonClassName:a.join(" "),options:e,onFiltersChange:P,filters:M,align:0===s?"start":s===r?"end":"center"},`${e.key}-filter`)})}),(0,t.jsx)("div",{className:"flex items-center space-x-2",children:(0,t.jsx)(y.Button,{type:"default",onClick:()=>O(),icon:_?(0,t.jsx)(n.Eye,{}):(0,t.jsx)(o.EyeOff,{}),children:"Chart"})}),!!L&&(0,t.jsx)(f.DownloadResultsButton,{iconOnly:!0,type:"default",align:"center",results:L??[],fileName:`supabase-${z}-${H}.csv`})]}),W?(0,t.jsxs)("div",{className:"flex items-center justify-center gap-x-2",children:[(0,t.jsxs)(N.Tooltip,{children:[(0,t.jsx)(N.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(y.Button,{asChild:!0,className:"px-1.5",type:"default",icon:(0,t.jsx)(u.Terminal,{}),children:(0,t.jsx)(h.default,{href:w})})}),(0,t.jsx)(N.TooltipContent,{side:"bottom",className:"text-xs",children:"Open query in Logs Explorer"})]}),(0,t.jsx)(p.DatabaseSelector,{onSelectId:F,additionalOptions:D===E.LogsTableName.EDGE&&(K??[]).length>0?[{id:`${H}-all`,name:"API Load Balancer"}]:[]})]}):(0,t.jsx)(y.Button,{asChild:!0,type:"default",onClick:k,children:(0,t.jsx)(h.default,{href:w,children:"Explore via query"})})]})};var R=e.i(744244),_=e.i(427432),O=e.i(150671),L=e.i(450049),P=e.i(281192),M=e.i(783804),D=e.i(242882),F=e.i(460988),B=e.i(234745),q=e.i(912793);let U=function({projectRef:e,id:t,queryType:s,paramsToMerge:a}){let r=s?E.LOGS_TABLES[s]:void 0,l=t&&r?(0,F.genSingleLogQuery)(r,t):"",i={...a,sql:l},n=!!(t&&r),{logsMetadata:o}=(0,q.useIsFeatureEnabled)(["logs:metadata"]),{data:c,error:d,isPending:u,isRefetching:m,refetch:h}=(0,D.useQuery)({queryKey:["projects",e,"single-log",t,s],queryFn:async({signal:t})=>{let{data:s,error:a}=await (0,B.get)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:e},query:i},signal:t});if(a)throw a;return s},enabled:n,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}),x=d?d.message:null,p=c?.result?c.result[0]:void 0;return{data:p?{...p,metadata:o?p?.metadata:void 0}:void 0,isLoading:n&&u||m,error:x,refresh:()=>h()}};var A=e.i(280590),H=e.i(265735),$=e.i(169240),Q=e.i(189329),z=e.i(238921),K=e.i(651068),W=e.i(979377);e.s(["LogsPreviewer",0,({projectRef:e,queryType:n,filterOverride:o,condensedLayout:c=!1,tableName:d,children:u,EmptyState:m,filterPanelClassName:h})=>{let x=(0,r.useRouter)(),{db:p}=(0,i.useParams)(),{data:f}=(0,H.useSelectedOrganizationQuery)(),g=(0,Q.useDatabaseSelectorStateSnapshot)(),[j,v]=(0,l.useState)(!0),[N,b]=(0,l.useState)(function(){let e=x.query.iso_timestamp_start,t=x.query.iso_timestamp_end;if(e&&t)return{to:t,from:e,text:`${(0,s.default)(e).format("DD MMM, HH:mm")} - ${(0,s.default)(t).format("DD MMM, HH:mm")}`,isHelper:!1};let a=E.PREVIEWER_DATEPICKER_HELPERS.find(e=>e.default);return{to:a.calcTo(),from:a.calcFrom(),text:a.text,isHelper:!0}}()),{search:S,setSearch:C,timestampStart:T,timestampEnd:k,setTimeRange:I,filters:D,setFilters:B}=(0,P.useLogsUrlState)();(0,l.useEffect)(()=>{T&&k&&b({to:k,from:T,text:`${(0,s.default)(T).format("DD MMM, HH:mm")} - ${(0,s.default)(k).format("DD MMM, HH:mm")}`,isHelper:!1})},[T,k]);let[q,G]=(0,M.useSelectedLog)(),{data:Y,isSuccess:J}=(0,O.useReadReplicasQuery)({projectRef:e}),V=d||E.LOGS_TABLES[n],{error:X,logData:Z,params:ee,newCount:et,isLoading:es,eventChartData:ea,isLoadingOlder:er,loadOlder:el,refresh:ei}=(0,L.default)({projectRef:e,table:V,filterOverride:o}),{data:en,isLoading:eo,error:ec}=U({projectRef:e,id:q??void 0,queryType:n,paramsToMerge:ee}),{showUpgradePrompt:ed,setShowUpgradePrompt:eu}=(0,$.useUpgradePrompt)(T),{getEntitlementNumericValue:em}=(0,A.useCheckEntitlements)("log.retention_days"),eh=em(),ex=async(e,{query:t,to:s,from:a})=>{"search-input-change"===e?(C(t||""),G(null)):"event-chart-bar-click"===e?I(a||"",s||""):"datepicker-change"===e&&((0,F.maybeShowUpgradePromptIfNotEntitled)(a||"",eh)?eu(!ed):I(a||"",s||""))};(0,l.useEffect)(()=>{T&&(0,F.maybeShowUpgradePromptIfNotEntitled)(T,eh)&&eu(!ed)},[T,f]),(0,l.useEffect)(()=>{void 0!==p?void 0!==Y?.find(e=>e.identifier===p)&&g.setSelectedDatabaseId(p):void 0!==g.selectedDatabaseId&&g.selectedDatabaseId!==e&&(E.LOG_ROUTES_WITH_REPLICA_SUPPORT.includes(x.pathname)?x.push({pathname:x.pathname,query:{...x.query,db:g.selectedDatabaseId}}):g.setSelectedDatabaseId(e))},[p,J]);let ep={className:h,csvData:Z,isLoading:es,newCount:et,onRefresh:()=>{if(N.isHelper){let e=E.PREVIEWER_DATEPICKER_HELPERS.find(e=>e.text===N.text);e&&I(e.calcFrom(),k)}ei()},onSearch:ex,defaultSearchValue:S,defaultToValue:k,defaultFromValue:T,queryUrl:`/project/${e}/logs/explorer?q=${encodeURIComponent(ee.sql||"")}&its=${encodeURIComponent(T)}&ite=${encodeURIComponent(k)}`,onSelectTemplate:e=>{B({...D,search_query:e.searchString})},filters:D,onFiltersChange:B,table:V,condensedLayout:c,isShowingEventChart:j,onToggleEventChart:()=>v(!j),onSelectedDatabaseChange:t=>{B({...D,database:t!==e?t:void 0});let{db:s,...a}=x.query;x.push({pathname:x.pathname,query:t!==e?{...x.query,db:t}:a})},selectedDatePickerValue:N,setSelectedDatePickerValue:b};return(0,t.jsxs)("div",{className:"flex-1 flex flex-col h-full",children:[(0,t.jsx)(w,{...ep}),u,(0,t.jsx)("div",{className:"transition-all duration-500 "+(j&&Z.length>0?"mb-2 mt-1 opacity-100":"h-0 opacity-0"),children:(0,t.jsx)("div",{className:c?"px-3":"",children:j&&(0,t.jsx)(z.LogsBarChart,{data:ea,onBarClick:e=>{var t;let a,r,l,i;if(!e?.timestamp)return;let{start:n,end:o}=(t=e.timestamp,l=(0,s.default)(t).toISOString(),(i=(k?(0,s.default)(k):(0,s.default)()).diff((0,s.default)(T),"hour",!0))>=12?(a=.5,r="hour"):i>=1?(a=2.5,r="minute"):i>=1/30?(a=1,r="minute"):(a=7.5,r="second"),{start:(0,s.default)(l).subtract(a,r).toISOString(),end:(0,s.default)(l).add(a,r).toISOString()});ex("event-chart-bar-click",{query:D.search_query?.toString(),to:o,from:n})},EmptyState:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-[67px]",children:[(0,t.jsx)("p",{className:"text-foreground-light text-xs",children:"No data"}),(0,t.jsx)("p",{className:"text-foreground-lighter text-xs",children:"It may take up to 24 hours for data to refresh"})]})})})}),(0,t.jsxs)("div",{className:"relative flex flex-col flex-grow flex-1 overflow-auto",children:[(0,t.jsx)(_.default,{active:es}),(0,t.jsx)(R.default,{active:es,children:(0,t.jsx)(K.default,{projectRef:e,isLoading:es,data:Z,queryType:n,isHistogramShowing:j,onHistogramToggle:()=>v(!j),error:X,EmptyState:m,onSelectedLogChange:e=>G(e?.id??null),selectedLog:en,isSelectedLogLoading:eo,selectedLogError:ec??void 0})})]}),!X&&Z.length>0&&(0,t.jsxs)("div",{className:"border-t flex flex-row items-center gap-3 p-2",children:[(0,t.jsx)(y.Button,{onClick:el,icon:(0,t.jsx)(a,{}),type:"default",loading:er,disabled:er,children:"Load older"}),(0,t.jsxs)("div",{className:"text-sm text-foreground-lighter",children:["Showing ",(0,t.jsx)("span",{className:"font-mono",children:Z.length})," results"]}),(0,t.jsx)("div",{className:"flex flex-row justify-end mt-2",children:(0,t.jsx)(W.default,{show:ed,setShowUpgradePrompt:eu})})]})]})}],555979)},532480,e=>{"use strict";let t=(0,e.i(388019).default)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);e.s(["default",()=>t])},833655,e=>{"use strict";var t=e.i(532480);e.s(["Info",()=>t.default])},330287,e=>{"use strict";var t=e.i(242882),s=e.i(234745),a=e.i(10429),r=e.i(346691);async function l({projectRef:e},t){if(!e)throw Error("Project ref is required");let{data:a,error:r}=await (0,s.get)("/platform/projects/{ref}/load-balancers",{params:{path:{ref:e}},signal:t});return r&&(0,s.handleError)(r),a}e.s(["useLoadBalancersQuery",0,({projectRef:e},{enabled:s=!0,...i}={})=>(0,t.useQuery)({queryKey:r.replicaKeys.loadBalancers(e),queryFn:({signal:t})=>l({projectRef:e},t),enabled:s&&void 0!==e&&a.IS_PLATFORM,...i})])},271332,e=>{"use strict";var t=e.i(478902),s=e.i(389959),a=e.i(843778),r=e.i(837710),l=e.i(253214);let i=(0,s.forwardRef)(({children:e,customFooter:i,description:n,hideFooter:o=!1,alignFooter:c="left",layout:d="horizontal",loading:u=!1,cancelText:m="Cancel",onConfirm:h=()=>{},onCancel:x=()=>{},confirmText:p="Confirm",showCloseButton:f=!0,footerBackground:g,variant:j="success",visible:y=!1,size:v="large",style:N,overlayStyle:b,contentStyle:S,triggerElement:E,header:C,modal:T,defaultOpen:k,...I},w)=>{let[R,_]=s.default.useState(!!y&&y);(0,s.useEffect)(()=>{_(y)},[y]);let O=i||(0,t.jsxs)("div",{className:"flex w-full space-x-2",style:{width:"100%",justifyContent:"vertical"===d?"center":"right"===c?"flex-end":"flex-start"},children:[(0,t.jsx)(r.Button,{type:"default",onClick:x,disabled:u,children:m}),(0,t.jsx)(r.Button,{onClick:h,disabled:u,loading:u,type:"danger"===j?"danger":"warning"===j?"warning":"primary",children:p})]});return(0,t.jsxs)(l.Dialog,{open:R,defaultOpen:k,onOpenChange:function(e){void 0===y||e?_(e):x()},modal:T,children:[E&&(0,t.jsx)(l.DialogTrigger,{children:E}),(0,t.jsxs)(l.DialogContent,{ref:w,hideClose:!f,...I,size:v,children:[C||n?(0,t.jsxs)(l.DialogHeader,{className:(0,a.cn)("border-b"),padding:"small",children:[C&&(0,t.jsx)(l.DialogTitle,{children:C}),n&&(0,t.jsx)(l.DialogDescription,{children:n})]}):null,e,!o&&(0,t.jsx)(l.DialogFooter,{padding:"small",children:O})]})]})}),n=(0,s.forwardRef)(({...e},s)=>(0,t.jsx)(l.DialogSection,{ref:s,...e,padding:"small",className:(0,a.cn)(e.className)})),o=(0,s.forwardRef)(({...e},s)=>(0,t.jsx)(l.DialogSectionSeparator,{ref:s,...e}));i.Content=n,i.Separator=o,e.s(["default",0,i])},40892,e=>{"use strict";var t=e.i(271332);e.s(["Modal",()=>t.default])},388034,e=>{"use strict";let t=(0,e.i(388019).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["default",()=>t])},61187,e=>{"use strict";var t=e.i(388034);e.s(["RefreshCw",()=>t.default])},520124,e=>{"use strict";var t=e.i(460988),s=e.i(389959);e.s(["useFillTimeseriesSorted",0,e=>{let{data:a,timestampKey:r,valueKey:l,defaultValue:i,startDate:n,endDate:o,minPointsToFill:c=20,interval:d}=e;return(0,s.useMemo)(()=>{var e;if(!a[0]?.[r])return{data:a,error:null,isError:!1};try{return{data:(e=(0,t.fillTimeseries)(a,r,l,i,n,o,c,d),[...e].sort((e,t)=>new Date(e[r]).getTime()-new Date(t[r]).getTime())),error:null,isError:!1}}catch(e){return{data:[],error:e instanceof Error?e:Error(String(e)),isError:!0}}},[JSON.stringify(a),r,JSON.stringify(l),i,n,o,c,d])}])},223600,e=>{"use strict";var t=e.i(478902),s=e.i(370410),a=e.i(816467),r=e.i(389959),l=e.i(837710),i=e.i(843778),n=e.i(375761);let o=(0,r.forwardRef)(({text:e,asyncText:o,iconOnly:c=!1,children:d,onClick:u,copyLabel:m="Copy",copiedLabel:h="Copied",...x},p)=>{let[f,g]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(!f)return;let e=setTimeout(()=>g(!1),2e3);return()=>clearTimeout(e)},[f]),(0,t.jsx)(l.Button,{ref:p,onClick:t=>{let s=o?o():e;g(!0),(0,n.copyToClipboard)(s),u?.(t)},...x,className:(0,i.cn)({"px-1":c},x.className),icon:f?(0,t.jsx)(s.Check,{strokeWidth:2,className:"text-brand"}):x.icon??(0,t.jsx)(a.Copy,{}),children:!c&&(0,t.jsx)(t.Fragment,{children:d??(f?h:m)})})});o.displayName="CopyButton",e.s(["default",0,o])},979377,e=>{"use strict";var t=e.i(478902),s=e.i(210419),a=e.i(265735),r=e.i(837710),l=e.i(40892),i=e.i(993394);e.s(["default",0,({show:e,setShowUpgradePrompt:n,title:o="Log retention",description:c="Logs can be retained up to a duration of 3 months depending on the plan that your project is on.",source:d="logsRetentionUpgradePrompt"})=>{let{data:u}=(0,a.useSelectedOrganizationQuery)();return(0,t.jsxs)(l.Modal,{hideFooter:!0,visible:e,size:"medium",header:o,onCancel:()=>n(!1),children:[(0,t.jsx)(l.Modal.Content,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("p",{className:"text-sm",children:c}),(0,t.jsxs)("div",{className:"border-control bg-surface-300 rounded border",children:[(0,t.jsxs)("div",{className:"flex items-center px-4 pt-2 pb-1",children:[(0,t.jsx)("p",{className:"text-foreground-light w-[40%] text-sm",children:"Plan"}),(0,t.jsx)("p",{className:"text-foreground-light w-[60%] text-sm",children:"Retention duration"})]}),(0,t.jsxs)("div",{className:"py-1",children:[(0,t.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,t.jsx)("p",{className:"w-[40%] text-sm",children:"Free"}),(0,t.jsx)("p",{className:"w-[60%] text-sm",children:i.TIER_QUERY_LIMITS.FREE.text})]}),(0,t.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,t.jsx)("p",{className:"w-[40%] text-sm",children:"Pro"}),(0,t.jsx)("p",{className:"w-[60%] text-sm",children:i.TIER_QUERY_LIMITS.PRO.text})]}),(0,t.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,t.jsx)("p",{className:"w-[40%] text-sm",children:"Team"}),(0,t.jsx)("p",{className:"w-[60%] text-sm",children:i.TIER_QUERY_LIMITS.TEAM.text})]}),(0,t.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,t.jsx)("p",{className:"w-[40%] text-sm",children:"Enterprise"}),(0,t.jsx)("p",{className:"w-[60%] text-sm",children:i.TIER_QUERY_LIMITS.ENTERPRISE.text})]})]})]})]})}),(0,t.jsx)(l.Modal.Separator,{}),(0,t.jsxs)(l.Modal.Content,{className:"flex justify-end gap-3",children:[(0,t.jsx)(r.Button,{type:"default",onClick:()=>n(!1),children:"Close"}),(0,t.jsx)(r.Button,{asChild:!0,size:"tiny",children:(0,t.jsx)(s.default,{href:`/org/${u?.slug}/billing?panel=subscriptionPlan&source=${d}`,children:"Upgrade"})})]})]})}])},218786,e=>{"use strict";var t=e.i(478902);e.i(223600),e.i(460988);var s=e.i(867637),a=e.i(833655);e.i(55956);var r=e.i(843778);function l(e){let t=JSON.stringify(e,null,2);return(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var t="number text-tomato-900";return/^"/.test(e)?t=/:$/.test(e)?"key text-foreground":"string text-brand-600":/true|false/.test(e)?t="boolean text-blue-900":/null/.test(e)&&(t="null text-amber-1100"),'<span class="'+t+'">'+e+"</span>"}).split(`
`).map(e=>`<span class="line text-xs">${e}</span>`).join("\n")}e.s(["ResponseCodeFormatter",0,({value:e})=>{if(!e)return(0,t.jsx)("div",{children:(0,t.jsx)("label",{className:"text-xs text-border-stronger",children:"No data"})});let s=({children:e,className:s})=>(0,t.jsx)("div",{className:"flex h-full items-center",children:(0,t.jsx)("div",{className:(0,r.cn)("relative flex h-6 items-center rounded-md justify-center px-2 py-1 text-center",s),children:(0,t.jsx)("label",{className:"block font-mono text-sm",children:e})})});switch(e.toString().split("")[0]){case"1":return(0,t.jsx)(s,{children:e});case"2":return(0,t.jsx)(s,{className:"bg-surface-100 text-brand",children:e});case"5":return(0,t.jsx)(s,{className:"bg-red-300 text-red-1100",children:e});case"4":case"3":return(0,t.jsx)(s,{className:"bg-amber-300 text-amber-1100",children:e});default:return(0,t.jsx)(s,{className:"bg-surface-100 text-foreground-lighter",children:e})}},"RowLayout",0,({children:e})=>(0,t.jsx)("div",{className:"flex h-full w-full items-center gap-4",children:e}),"SeverityFormatter",0,({value:e,uppercase:r=!0})=>{if(!e)return(0,t.jsx)("div",{children:(0,t.jsx)("label",{className:"text-xs text-border-stronger",children:"No data"})});let l=e.toUpperCase(),i=r?l:e,n=({className:e,children:s})=>(0,t.jsx)("div",{className:`w-24 flex items-center h-full ${e}`,children:s});switch(l){case"UNCAUGHTEXCEPTION":case"PANIC":case"FATAL":case"ERROR":return(0,t.jsxs)(n,{className:"gap-1",children:[(0,t.jsx)("div",{className:" p-0.5 rounded !text-red-900",children:(0,t.jsx)(s.AlertCircle,{size:14,strokeWidth:2})}),(0,t.jsx)("span",{className:"!text-red-900 !block titlecase",children:i})]});case"INFO":case"DEBUG":return(0,t.jsxs)(n,{className:"gap-1",children:[(0,t.jsx)("div",{className:" p-0.5 rounded !text-blue-900",children:(0,t.jsx)(s.AlertCircle,{size:14,strokeWidth:2})}),(0,t.jsx)("span",{className:"!text-blue-900 !block titlecase",children:i})]});case"LOG":return(0,t.jsxs)(n,{className:"gap-1",children:[(0,t.jsx)("div",{className:" p-0.5 rounded !text-blue-900",children:(0,t.jsx)(a.Info,{size:14,strokeWidth:2})}),(0,t.jsx)("span",{className:"!text-blue-900 !block titlecase",children:i})]});case"WARNING":return(0,t.jsxs)(n,{className:"gap-1",children:[(0,t.jsx)("div",{className:" p-0.5 rounded !text-amber-900",children:(0,t.jsx)(s.AlertCircle,{size:14,strokeWidth:2})}),(0,t.jsx)("span",{className:"!text-amber-900 !block titlecase",children:i})]});default:return(0,t.jsx)(n,{children:(0,t.jsx)("div",{className:"relative rounded px-2 py-1 text-center h-6 flex justify-center items-center bg-surface-100",children:(0,t.jsx)("label",{className:"block font-mono text-sm text-foreground-lighter",children:i})})})}},"TextFormatter",0,({value:e,className:s})=>(0,t.jsx)("span",{className:(0,r.cn)("font-mono text-xs truncate select-text cursor-text",s),children:e}),"jsonSyntaxHighlight",()=>l])},238921,e=>{"use strict";var t=e.i(478902),s=e.i(55956),a=e.i(389959),r=e.i(151675),l=e.i(942032),i=e.i(30772),n=e.i(214765),o=e.i(941327),c=e.i(462273),d=e.i(843778);let u="hsl(var(--background-overlay-hover))",m="hsl(var(--brand-default))",h="hsl(var(--destructive-default))",x="hsl(var(--warning-default))";e.s(["LogsBarChart",0,({data:e,onBarClick:p,EmptyState:f,DateTimeFormat:g="MMM D, YYYY, hh:mma",isFullHeight:j=!1,chartConfig:y,hideZeroValues:v=!1})=>{let[N,b]=(0,a.useState)(null);if(0===e.length)return f||null;let S=(0,s.default)(e[0].timestamp).format(g),E=(0,s.default)(e[e?.length-1]?.timestamp).format(g);return(0,t.jsxs)("div",{"data-testid":"logs-bar-chart",className:(0,d.cn)("flex flex-col gap-y-3",j?"h-full":"h-24"),children:[(0,t.jsx)(c.ChartContainer,{className:"h-full",config:y??{error_count:{label:"Errors"},ok_count:{label:"Ok"},warning_count:{label:"Warnings"}},children:(0,t.jsxs)(i.BarChart,{data:e,onMouseMove:e=>{e.activeTooltipIndex!==N&&b(e.activeTooltipIndex)},onMouseLeave:()=>b(null),onClick:e=>{let t=e?.activePayload?.[0]?.payload;p&&p(t,e)},children:[(0,t.jsx)(o.YAxis,{tick:!1,width:0,axisLine:{stroke:u},tickLine:{stroke:u}}),(0,t.jsx)(n.XAxis,{dataKey:"timestamp",interval:e.length-2,tick:!1,axisLine:{stroke:u},tickLine:{stroke:u}}),(0,t.jsx)(c.ChartTooltip,{animationDuration:0,position:{y:16},content:e=>{if(!e.active||!e.payload||0===e.payload.length)return null;let a=v?e.payload.filter(e=>0!==Number(e.value)):e.payload;return 0===a.length?null:(0,t.jsx)(c.ChartTooltipContent,{active:e.active,payload:a,label:e.label,className:"text-foreground-light -mt-5 !transition-none",labelFormatter:e=>(0,s.default)(e).format(g)})}}),(0,t.jsx)(r.Bar,{dataKey:"error_count",fill:h,maxBarSize:24,stackId:"stack",children:e?.map((e,s)=>(0,t.jsx)(l.Cell,{className:"cursor-pointer transition-colors",fill:N===s||null===N?h:"hsl(var(--destructive-500))"},`error-${s}`))}),(0,t.jsx)(r.Bar,{dataKey:"warning_count",fill:x,maxBarSize:24,stackId:"stack",children:e?.map((e,s)=>(0,t.jsx)(l.Cell,{className:"cursor-pointer transition-colors",fill:N===s||null===N?x:"hsl(var(--warning-500))"},`warning-${s}`))}),(0,t.jsx)(r.Bar,{dataKey:"ok_count",fill:m,maxBarSize:24,stackId:"stack",children:e?.map((e,s)=>(0,t.jsx)(l.Cell,{className:"cursor-pointer transition-colors",fill:N===s||null===N?m:"hsl(var(--brand-500))"},`success-${s}`))})]})}),e&&(0,t.jsxs)("div",{className:"text-foreground-lighter -mt-10 flex items-center justify-between text-[10px] font-mono",children:[(0,t.jsx)("span",{children:S}),(0,t.jsx)("span",{children:E})]})]})}])},456598,e=>{"use strict";var t=e.i(460988),s=e.i(389959);e.s(["default",0,(e,a)=>(0,s.useMemo)(()=>0!==e.length&&(0,t.isUnixMicro)(e[0][a])?e?.map(e=>(e[a]=(0,t.unixMicroToIsoTimestamp)(e[a]),e)):e,[JSON.stringify(e)])])},281192,e=>{"use strict";var t=e.i(533488);let s={},a=e=>(0,t.createParser)({parse:t=>t??e,serialize:e=>e||""});function r(){let[e,r]=(0,t.useQueryState)("s",a("")),[l,i]=(0,t.useQueryState)("its",a("")),[n,o]=(0,t.useQueryState)("ite",a("")),[c,d]=(0,t.useQueryState)("log",a("")),[u,m]=(0,t.useQueryState)("f",(0,t.createParser)({parse:e=>{if(!e)return s;try{return JSON.parse(e)}catch(e){return s}},serialize:e=>{if(!e)return"";try{return JSON.stringify(e)}catch(e){return""}}})),h=u||s,x=e=>{r(e||"")},p=e=>{m(e||s)};return{search:e||"",timestampStart:l||"",timestampEnd:n||"",selectedLogId:c||null,filters:h,setSearch:x,setTimeRange:(e,t)=>{i(e||""),o(t||"")},setSelectedLogId:e=>{d(e||"")},setFilters:p,updateFilter:(e,t)=>{p({...h,[e]:t})},reset:()=>{x(""),i(""),o(""),d(""),m(s)}}}e.s(["useLogsUrlState",()=>r])},450049,e=>{"use strict";var t=e.i(867088),s=e.i(242882),a=e.i(993394),r=e.i(460988),l=e.i(234745),i=e.i(55956),n=e.i(389959),o=e.i(520124),c=e.i(281192),d=e.i(456598);e.s(["default",0,function({projectRef:e,table:u,filterOverride:m,limit:h}){let x=(0,a.getDefaultHelper)(a.PREVIEWER_DATEPICKER_HELPERS),[p,f]=(0,n.useState)(new Date().toISOString()),{timestampStart:g,timestampEnd:j,filters:y,search:v}=(0,c.useLogsUrlState)(),N=(0,n.useMemo)(()=>g||x.calcFrom(),[g,x]),b=(0,n.useMemo)(()=>j||x.calcTo(),[j,x]),S=(0,n.useMemo)(()=>({...y,...m,...v?{search_query:v}:{}}),[JSON.stringify(y),JSON.stringify(m),v]),E=(0,n.useMemo)(()=>({iso_timestamp_start:N,iso_timestamp_end:b,sql:(0,r.genDefaultQuery)(u,S,h)}),[N,b,u,S,h]),C=(0,n.useMemo)(()=>["projects",e,"logs",E],[e,E]),{data:T,isSuccess:k,isLoading:I,isRefetching:w,error:R,fetchNextPage:_,isFetchingNextPage:O,refetch:L}=(0,t.useInfiniteQuery)({queryKey:C,queryFn:async({signal:t,pageParam:s})=>{let{data:a,error:r}=await (0,l.get)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:e},query:{...E,iso_timestamp_end:s||E.iso_timestamp_end}},signal:t});if(r)throw r;return a},refetchOnWindowFocus:!1,initialPageParam:void 0,getNextPageParam(e){if((e.result?.length??0)===0)return;let t=e.result.length,{timestamp:s}=e.result[t-1];return i.default.utc(Number(s/1e3)).toISOString()}}),{logData:P,error:M,oldestTimestamp:D}=(0,n.useMemo)(()=>{let e=[],t=R?R.message:null;T?.pages?.forEach(s=>{s?.result&&(e=[...e,...s.result]),!t&&s?.error&&(t=s.error)});let s=e.length>0?e[e.length-1]?.timestamp:void 0;return{logData:e,error:t,oldestTimestamp:s}},[T?.pages]),F=(0,n.useMemo)(()=>(0,r.genCountQuery)(u,S),[u,S]),B=(0,n.useMemo)(()=>["projects",e,"logs-count",{projectRef:e,sql:F,iso_timestamp_start:p,iso_timestamp_end:b,table:u,mergedFilters:S}],[e,F,p,b,u,S]),{data:q}=(0,s.useQuery)({queryKey:B,queryFn:async({signal:t})=>{let{data:s,error:a}=await (0,l.get)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:e},query:{sql:F,iso_timestamp_start:p,iso_timestamp_end:b}},signal:t});if(a)throw a;return s},refetchOnWindowFocus:!1,refetchInterval:6e4,enabled:!!(!M&&T&&T?.pages?.length>0)}),U=q?.result?.[0]?.count??0,A=(0,n.useMemo)(()=>(0,r.genChartQuery)(u,E,S),[u,E,S]),H=(0,n.useMemo)(()=>["projects",e,"logs-chart",{projectRef:e,sql:A,iso_timestamp_start:N,iso_timestamp_end:b}],[e,A,N,b]),{data:$,refetch:Q}=(0,s.useQuery)({queryKey:H,queryFn:async({signal:t})=>{let{data:s,error:a}=await (0,l.get)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:e},query:{iso_timestamp_start:N,iso_timestamp_end:b,sql:A}},signal:t});if(a)throw a;return s},refetchOnWindowFocus:!1}),z=(0,n.useCallback)(async()=>{f(new Date().toISOString()),Q(),L()},[L,Q]),K=(0,d.default)($?.result??[],"timestamp"),{data:W,error:G}=(0,o.useFillTimeseriesSorted)({data:K,timestampKey:"timestamp",valueKey:"count",defaultValue:0,startDate:N,endDate:b??new Date().toISOString()});return{newCount:U,logData:P,isSuccess:k,isLoading:I||w,isLoadingOlder:O,error:M||G,filters:S,params:E,oldestTimestamp:D?String(D):void 0,eventChartData:W,refresh:z,loadOlder:()=>_()}}])}]);

//# debugId=332cbc5c-4855-7b31-f204-58e640f1ae8c
//# sourceMappingURL=fcbedc93444e8e47.js.map