;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="755397a6-734d-5af4-1896-7a170b064142")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,22312,e=>{"use strict";var r=e.i(478902),i=e.i(366652),s=e.i(389959);e.i(128328);var t=e.i(158639),a=e.i(167892),o=e.i(513826),n=e.i(388531),l=e.i(722740),d=e.i(10429),c=e.i(710483),u=e.i(746301),m=e.i(532728),h=e.i(902858),p=e.i(210419),g=e.i(408891),x=e.i(355901),f=e.i(531837),j=e.i(215312),y=e.i(102703),v=e.i(726398),b=e.i(794231),_=e.i(38429),S=e.i(356003),w=e.i(234745),N=e.i(711950),C=e.i(617976);async function z({slug:e,email:r,roleId:i,projects:s}){let t={email:r,role_id:i};void 0!==s&&(t.role_scoped_projects=s);let{data:a,error:o}=await (0,w.post)("/platform/organizations/{slug}/members/invitations",{params:{path:{slug:e}},body:t});return o&&(0,w.handleError)(o),a}let T=({onSuccess:e,onError:r,...i}={})=>{let s=(0,S.useQueryClient)();return(0,_.useMutation)({mutationFn:e=>z(e),async onSuccess(r,i,t){let{slug:a}=i;await Promise.all([s.invalidateQueries({queryKey:C.organizationKeys.rolesV2(a)}),s.invalidateQueries({queryKey:N.organizationKeys.members(a)})]),await e?.(r,i,t)},async onError(e,i,s){void 0===r?x.toast.error(`Failed to update member role: ${e.message}`):r(e,i,s)},...i})};var I=e.i(793595),P=e.i(540203),R=e.i(2579),O=e.i(912793),A=e.i(265735),E=e.i(432478),F=e.i(837710),Q=e.i(253214),k=e.i(24315),L=e.i(61863),M=e.i(428353),q=e.i(378277),D=e.i(451031),$=e.i(57492),K=e.i(831927),B=e.i(156722),V=e.i(449123),U=e.i(290811),H=e.i(538482);let G=(e,r,i)=>{let{permissions:s,organizationSlug:t}=(0,R.useGetPermissions)(i,e,void 0!==i&&void 0!==e),a=[],o=[];return r&&e&&r.forEach(e=>{(0,R.doPermissionsCheck)(s,h.PermissionAction.CREATE,"auth.subject_roles",{resource:{role_id:e.id}},t)&&a.push(e.id),(0,R.doPermissionsCheck)(s,h.PermissionAction.DELETE,"auth.subject_roles",{resource:{role_id:e.id}},t)&&o.push(e.id)}),{rolesAddable:a,rolesRemovable:o}},W=()=>{let{slug:e}=(0,t.useParams)(),{profile:i}=(0,E.useProfile)(),{data:a}=(0,A.useSelectedOrganizationQuery)(),{permissions:o}=(0,R.useGetPermissions)(),{organizationMembersCreate:l}=(0,O.useIsFeatureEnabled)(["organization_members:create"]),[c,u]=(0,s.useState)(!1),[_,S]=(0,s.useState)(!1),{data:w}=(0,I.useOrganizationMembersQuery)({slug:e}),{data:N,isSuccess:C}=(0,n.useOrganizationRolesV2Query)({slug:e}),z=N?.org_scoped_roles??[],W=a?.plan,Y=(0,P.useHasAccessToProjectLevelPermissions)(e),X=w?.find(e=>e.gotrue_id===i?.gotrue_id),Z=1===(X?.role_ids??[]).length&&z.some(e=>e.id===X?.role_ids[0]),{rolesAddable:J}=G(a?.slug,z,o??[]),ee=Z&&J.length>0&&z.some(({id:e})=>(0,R.doPermissionsCheck)(o,h.PermissionAction.CREATE,"user_invites",{resource:{role_id:e}},a?.slug)),{mutate:er,isPending:ei}=T(),es=f.object({email:f.string().email("Must be a valid email address").min(1,"Email is required"),role:f.string().min(1,"Role is required"),applyToOrg:f.boolean(),projectRef:f.string()}),et=(0,g.useForm)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,m.zodResolver)(es),defaultValues:{email:"",role:"",applyToOrg:!0,projectRef:""}}),{applyToOrg:ea,projectRef:eo}=et.watch(),en=async r=>{if(!e)return console.error("Slug is required");if(i?.id===void 0)return console.error("Profile ID required");let s=z.find(e=>"Developer"===e.name),t=(w??[]).find(e=>e.primary_email===r.email.toLowerCase());if(void 0!==t)if(t.invited_id)return(0,x.toast)("User has already been invited to this organization");else return(0,x.toast)("User is already in this organization");er({slug:e,email:r.email.toLowerCase(),roleId:Number(r.role),...!r.applyToOrg&&r.projectRef?{projects:[r.projectRef]}:{}},{onSuccess:()=>{x.toast.success("Successfully sent invitation to new member"),u(!c),et.reset({email:"",role:s?.id.toString()??"",applyToOrg:!0,projectRef:""})}})};return(0,s.useEffect)(()=>{if(C&&c){let e=z.find(e=>"Developer"===e.name);void 0!==e&&et.setValue("role",e.id.toString())}},[C,c]),(0,r.jsxs)(Q.Dialog,{open:c,onOpenChange:u,children:[(0,r.jsx)(Q.DialogTrigger,{asChild:!0,children:(0,r.jsx)(j.ButtonTooltip,{type:"primary",disabled:!ee,className:"pointer-events-auto flex-grow md:flex-grow-0",onClick:()=>u(!0),tooltip:{content:{side:"bottom",text:l?ee?void 0:"You need additional permissions to invite a member to this organization":"Inviting members is currently disabled"}},children:"Invite member"})}),(0,r.jsxs)(Q.DialogContent,{size:"medium",children:[(0,r.jsx)(Q.DialogHeader,{children:(0,r.jsx)(Q.DialogTitle,{children:"Invite a member to this organization"})}),(0,r.jsx)(Q.DialogSectionSeparator,{}),(0,r.jsx)(M.Form_Shadcn_,{...et,children:(0,r.jsxs)("form",{id:"organization-invitation",className:"flex flex-col gap-y-4",onSubmit:et.handleSubmit(en),children:[(0,r.jsxs)(Q.DialogSection,{className:"flex flex-col gap-y-4 pb-2",children:[Y&&(0,r.jsx)(L.FormField_Shadcn_,{name:"applyToOrg",control:et.control,render:({field:e})=>(0,r.jsx)(H.FormItemLayout,{layout:"flex",label:"Apply role to all projects in the organization",children:(0,r.jsx)(k.FormControl_Shadcn_,{children:(0,r.jsx)(U.Switch,{checked:e.value,onCheckedChange:e=>et.setValue("applyToOrg",e)})})})}),(0,r.jsx)(L.FormField_Shadcn_,{name:"role",control:et.control,render:({field:e})=>(0,r.jsx)(H.FormItemLayout,{label:"Member role",children:(0,r.jsx)(k.FormControl_Shadcn_,{children:(0,r.jsxs)(V.Select_Shadcn_,{value:e.value,onValueChange:e=>et.setValue("role",e),children:[(0,r.jsx)(B.SelectTrigger_Shadcn_,{className:"text-sm capitalize",children:z.find(r=>r.id===Number(e.value))?.name??"Unknown"}),(0,r.jsx)(D.SelectContent_Shadcn_,{children:(0,r.jsx)($.SelectGroup_Shadcn_,{children:z.map(e=>{let i=J.includes(e.id);return(0,r.jsxs)(K.SelectItem_Shadcn_,{value:e.id.toString(),className:"text-sm [&>span:nth-child(2)]:w-full [&>span:nth-child(2)]:flex [&>span:nth-child(2)]:items-center [&>span:nth-child(2)]:justify-between",disabled:!i,children:[(0,r.jsx)("span",{children:e.name}),!i&&(0,r.jsx)("span",{children:"Additional permissions required to assign role"})]},e.id)})})})]})})})}),!ea&&(0,r.jsx)(L.FormField_Shadcn_,{name:"projectRef",control:et.control,render:({field:e})=>(0,r.jsx)(H.FormItemLayout,{label:"Select a project",description:"You can assign roles to multiple projects once the invite is accepted",children:(0,r.jsx)(k.FormControl_Shadcn_,{children:(0,r.jsx)(v.OrganizationProjectSelector,{fetchOnMount:!0,sameWidthAsTrigger:!0,checkPosition:"left",selectedRef:eo,open:_,setOpen:S,searchPlaceholder:"Search project...",onSelect:r=>e.onChange(r.ref),onInitialLoad:r=>e.onChange(r[0]?.ref??"")})})})}),(0,r.jsx)(L.FormField_Shadcn_,{name:"email",control:et.control,render:({field:e})=>(0,r.jsx)(H.FormItemLayout,{label:"Email address",children:(0,r.jsx)(k.FormControl_Shadcn_,{children:(0,r.jsx)(q.Input_Shadcn_,{autoFocus:!0,...e,autoComplete:"off",disabled:ei,placeholder:"Enter email address"})})})}),(0,r.jsx)(y.default,{defaultVisibility:!1,title:"Single Sign-on (SSO) login option available",hideCollapse:!1,description:(0,r.jsxs)("div",{className:"space-y-4 mb-1",children:[(0,r.jsx)("p",{children:"Supabase offers single sign-on (SSO) as a login option to provide additional account security for your team. This allows company administrators to enforce the use of an identity provider when logging into Supabase."}),(0,r.jsx)("p",{children:"This is only available for organizations on Team Plan or above."}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(F.Button,{asChild:!0,type:"default",children:(0,r.jsx)(p.default,{href:`${d.DOCS_URL}/guides/platform/sso`,target:"_blank",rel:"noreferrer",children:"Learn more"})}),(W?.id==="free"||W?.id==="pro")&&(0,r.jsx)(b.UpgradePlanButton,{plan:"Team",source:"inviteMemberSSO",featureProposition:"enable Single Sign-on (SSO)"})]})]})})]}),(0,r.jsx)(Q.DialogSectionSeparator,{}),(0,r.jsx)(Q.DialogSection,{className:"pt-0",children:(0,r.jsx)(F.Button,{block:!0,htmlType:"submit",loading:ei,children:"Send invitation"})})]})})]})]})};var Y=e.i(867637),X=e.i(382490),Z=e.i(567558),J=e.i(667852),ee=e.i(627069),er=e.i(787902),ei=e.i(492418),es=e.i(613580),et=e.i(108151),ea=e.i(710377),eo=e.i(370410),en=e.i(659016),el=e.i(975924),ed=e.i(912971),ec=e.i(22194),eu=e.i(519835),em=e.i(587433),eh=e.i(7038),ep=e.i(351844),eg=e.i(138618),ex=e.i(396831),ef=e.i(843778);function ej(e){let r=new Date(e);return!((new Date().valueOf()-r.valueOf())/1e3/60/60<24)}var ey=e.i(471998);let ev=(0,e.i(388019).default)("Redo2",[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]]);var eb=e.i(211570),e_=e.i(423782);async function eS({slug:e,id:r}){let{error:i}=await (0,w.del)("/platform/organizations/{slug}/members/invitations/{id}",{params:{path:{slug:e,id:r}}});return i&&(0,w.handleError)(i),!0}async function ew({slug:e,gotrueId:r}){let{data:i,error:s}=await (0,w.del)("/platform/organizations/{slug}/members/{gotrue_id}",{params:{path:{slug:e,gotrue_id:r}}});return s&&(0,w.handleError)(s),i}let eN=({onSuccess:e,onError:r,...i}={})=>{let s=(0,S.useQueryClient)();return(0,_.useMutation)({mutationFn:e=>ew(e),async onSuccess(r,i,t){let{slug:a}=i;await Promise.all([s.invalidateQueries({queryKey:N.organizationKeys.members(a)}),s.invalidateQueries({queryKey:N.organizationKeys.roles(a)})]),await e?.(r,i,t)},async onError(e,i,s){void 0===r?x.toast.error(`Failed to remove member: ${e.message}`):r(e,i,s)},...i})};var eC=e.i(154985),ez=e.i(874311),eT=e.i(466472),eI=e.i(271226),eP=e.i(947748),eR=e.i(811025),eO=e.i(124416);let eA=()=>{let e=(0,eI.useRouter)(),{slug:i}=(0,t.useParams)(),{profile:a}=(0,E.useProfile)(),{data:o}=(0,A.useSelectedOrganizationQuery)(),{organizationMembersDelete:l}=(0,O.useIsFeatureEnabled)(["organization_members:delete"]),[d,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1),[h,p]=(0,eO.useLocalStorageQuery)(eP.LOCAL_STORAGE_KEYS.LAST_VISITED_ORGANIZATION,""),{refetch:g}=(0,eR.useOrganizationsQuery)(),{data:f}=(0,I.useOrganizationMembersQuery)({slug:i}),{data:y}=(0,n.useOrganizationRolesV2Query)({slug:i}),v=y?.org_scoped_roles??[],b=f?.find(e=>e.gotrue_id===a?.gotrue_id),_=b?.role_ids?.[0],S=v.find(e=>e.id===_),w=S?.name==="Administrator",N=o?.is_owner,C=!N||N&&((e=[],r=[])=>e.filter(e=>{let[i]=e.role_ids??[],s=r.find(e=>e.id===i);return s?.name==="Owner"&&!e.invited_at}).length>1)(f,v),{mutate:z}=eN({onSuccess:async()=>{c(!1),m(!1),await g(),x.toast.success(`Successfully left ${o?.name}`),p(""),e.push("/organizations")},onError:e=>{c(!1),x.toast.error(`Failed to leave organization: ${e?.message}`)}}),T=async()=>i?a?void(c(!0),z({slug:i,gotrueId:a.gotrue_id})):console.error("Profile is required"):console.error("Org slug is required");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.ButtonTooltip,{type:"default",disabled:!C||!l||d,onClick:()=>m(!0),tooltip:{content:{side:"bottom",text:C?l?void 0:"Unable to leave organization":"An organization requires at least 1 owner"}},children:"Leave team"}),(0,r.jsx)(eT.default,{size:"medium",visible:u,title:"Confirm to leave organization",confirmLabel:"Leave",variant:"warning",alert:{title:"All of your user content will be permanently removed.",description:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Leaving the organization will delete all of your saved content in the projects of the organization, which includes:"}),(0,r.jsxs)("ul",{className:"list-disc pl-4",children:[(0,r.jsxs)("li",{children:["SQL snippets ",(0,r.jsx)("span",{className:"text-foreground",children:"(both private and shared)"})]}),(0,r.jsx)("li",{children:"Custom reports"}),(0,r.jsx)("li",{children:"Log Explorer queries"})]}),(N||w)&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("p",{children:(0,r.jsx)("span",{className:"text-foreground",children:"Leaving won't remove your payment method or stop payments."})}),(0,r.jsxs)("ul",{className:"list-disc pl-4",children:[(0,r.jsx)("li",{children:"The current payment method will remain active and may still be charged after you leave."}),(0,r.jsx)("li",{children:"The billing address will remain unchanged."})]})]})]})},onCancel:()=>m(!1),onConfirm:()=>T(),children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to leave this organization? This is permanent."})})]})};var eE=e.i(822574),eF=e.i(88816),eQ=e.i(206413),ek=e.i(592360),eL=e.i(178527),eM=e.i(774234),eq=e.i(554855),eD=e.i(925282),e$=e.i(725137),eK=e.i(877555);async function eB({slug:e,gotrueId:r,roleId:i,projects:s}){let t={role_id:i};void 0!==s&&(t.role_scoped_projects=s);let{data:a,error:o}=await (0,w.patch)("/platform/organizations/{slug}/members/{gotrue_id}",{params:{path:{slug:e,gotrue_id:r}},body:t,headers:{Version:"2"}});return o&&(0,w.handleError)(o),a}async function eV({slug:e,gotrueId:r,roleId:i}){let{data:s,error:t}=await (0,w.del)("/platform/organizations/{slug}/members/{gotrue_id}/roles/{role_id}",{params:{path:{slug:e,gotrue_id:r,role_id:i}}});return t&&(0,w.handleError)(t),s}async function eU({slug:e,gotrueId:r,roleId:i,roleName:s,projects:t}){let{data:a,error:o}=await (0,w.put)("/platform/organizations/{slug}/members/{gotrue_id}/roles/{role_id}",{params:{path:{slug:e,gotrue_id:r,role_id:i}},body:{name:s,role_scoped_projects:t}});return o&&(0,w.handleError)(o),a}var eH=e.i(492460);let eG=(e,r)=>{let{org_scoped_roles:i,project_scoped_roles:s}=r;return e.role_ids.map(e=>{let r=i.find(r=>r.id===e);if(void 0!==r)return{ref:void 0,name:void 0,roleId:r.id};let t=s.find(r=>r.id===e);if(void 0!==t)return t.projects.map(e=>({ref:e.ref,name:e.name,roleId:t.id,baseRoleId:t.base_role_id}))}).filter(Boolean).flat().filter(e=>"baseRoleId"in e?void 0!==e.ref:e).sort((e,r)=>(e?.name??"").localeCompare(r?.name??""))},eW=({visible:e,member:i,projectsRoleConfiguration:a,onClose:o})=>{let{slug:d}=(0,t.useParams)(),c=(0,S.useQueryClient)(),{data:u}=(0,A.useSelectedOrganizationQuery)(),{data:m}=(0,n.useOrganizationRolesV2Query)({slug:u?.slug}),{data:h}=(0,l.useOrgProjectsInfiniteQuery)({slug:d}),p=(0,s.useMemo)(()=>h?.pages.flatMap(e=>e.projects),[h?.pages])||[],[g,f]=(0,s.useState)(!1),{mutateAsync:j}=(({onSuccess:e,onError:r,...i}={})=>{let s=(0,S.useQueryClient)();return(0,_.useMutation)({mutationFn:e=>eB(e),async onSuccess(r,i,t){let{slug:a,skipInvalidation:o}=i;o||await Promise.all([s.invalidateQueries({queryKey:C.organizationKeys.rolesV2(a)}),s.invalidateQueries({queryKey:N.organizationKeys.members(a)})]),await e?.(r,i,t)},async onError(e,i,s){void 0===r?x.toast.error(`Failed to update member role: ${e.message}`):r(e,i,s)},...i})})(),{mutateAsync:y}=(({onSuccess:e,onError:r,...i}={})=>{let s=(0,S.useQueryClient)();return(0,_.useMutation)({mutationFn:e=>eV(e),async onSuccess(r,i,t){let{slug:a,skipInvalidation:o}=i;o||await Promise.all([s.invalidateQueries({queryKey:C.organizationKeys.rolesV2(a)}),s.invalidateQueries({queryKey:N.organizationKeys.members(a)})]),await e?.(r,i,t)},async onError(e,i,s){void 0===r?x.toast.error(`Failed to unassign member role: ${e.message}`):r(e,i,s)},...i})})({onError:()=>{}}),{mutateAsync:v}=(({onSuccess:e,onError:r,...i}={})=>{let s=(0,S.useQueryClient)();return(0,_.useMutation)({mutationFn:e=>eU(e),async onSuccess(r,i,t){let{slug:a,skipInvalidation:o}=i;o||await Promise.all([s.invalidateQueries({queryKey:C.organizationKeys.rolesV2(a)}),s.invalidateQueries({queryKey:N.organizationKeys.members(a)})]),await e?.(r,i,t)},async onError(e,i,s){void 0===r?x.toast.error(`Failed to update member role: ${e.message}`):r(e,i,s)},...i})})(),b=m?.org_scoped_roles??[],{org_scoped_roles:w,project_scoped_roles:z}=m??{org_scoped_roles:[],project_scoped_roles:[]},T=((e=[],r=[])=>{let i=[],s=[],t=[];return e.forEach(e=>{let s=r.find(r=>e.ref===r.ref);void 0===s?i.push(e):s.roleId!==e.roleId&&t.push({ref:s.ref,name:s.name,originalRole:e.roleId,originalBaseRole:e.baseRoleId,updatedRole:s.roleId})}),r.forEach(r=>{void 0===e.find(e=>r.ref===e.ref)&&s.push(r)}),{removed:i,added:s,updated:t}})(void 0!==m?eG(i,m):[],a),I=async()=>{if(void 0===d)return console.error("Slug is required");f(!0);let e=i.gotrue_id,r=i.role_ids.map(e=>[...w,...z].find(r=>r.id===e)).map(e=>(e?.projects??[]).length>0?{...e,projects:e?.projects.filter(({ref:e})=>p.some(r=>r.ref===e))??[]}:e).filter(Boolean);if(1===a.length&&void 0===a[0].ref)try{await j({slug:d,gotrueId:e,roleId:a[0].roleId}),x.toast.success(`Successfully updated role for ${i.username}`),o(!0)}catch(e){x.toast.error(`Failed to update role: ${e.message}`)}finally{f(!1);return}let{toRemove:s,toAssign:t,toUpdate:n}=((e,r)=>{let{removed:i,added:s,updated:t}=r,a=[],o=[],n=[],l=(0,eH.default)(s,"roleId"),d=(0,eH.default)(i,"roleId"),c=(0,eH.default)(t,"originalRole"),u=(0,eH.default)(t,"updatedRole"),m=e.filter(e=>(e?.projects??[]).length>0).map(e=>e.base_role_id);return e.forEach(e=>{let r=e.projects.map(e=>e.ref);if(0===r.length)return a.push(e.id);let o=r.every(e=>{let r=i.map(e=>e.ref).some(r=>r===e),s=t.map(e=>e.ref).some(r=>r===e);return r||s}),m=s.some(r=>r.roleId===e.base_role_id),h=t.some(r=>r.updatedRole===e.base_role_id);if(o&&!m&&!h)return a.push(e.id);let p=l[e.base_role_id]?.map(e=>e.ref)??[],g=d[e.id]?.map(e=>e.ref)??[],x=c[e.id]?.map(e=>e.ref)??[],f=u[e.base_role_id]?.map(e=>e.ref)??[],j=r.filter(e=>!g.includes(e)).filter(e=>!x.includes(e)).concat(p).concat(f);(0,eE.default)(r,j)||n.push({roleId:e.id,refs:j})}),Object.keys(l).forEach(e=>{m.includes(Number(e))||o.push({roleId:Number(e),refs:l[e].map(e=>e.ref).filter(e=>void 0!==e)})}),Object.keys(u).forEach(e=>{m.includes(Number(e))||o.push({roleId:Number(e),refs:u[e].map(e=>e.ref).filter(e=>void 0!==e)})}),{toRemove:a.sort((e,r)=>e-r),toAssign:o.map(e=>({...e,refs:e.refs.sort((e,r)=>e.localeCompare(r))})),toUpdate:n.map(e=>({...e,refs:e.refs.sort((e,r)=>e.localeCompare(r))}))}})(r,T);try{for(let{roleId:r,refs:i}of t)await j({slug:d,gotrueId:e,roleId:r,projects:i,skipInvalidation:!0});for(let r of s)await y({slug:d,gotrueId:e,roleId:r,skipInvalidation:!0});for(let{roleId:r,refs:i}of n)await v({slug:d,gotrueId:e,roleId:r,roleName:z.find(e=>e.id===r)?.name,projects:i,skipInvalidation:!0});await Promise.all([c.invalidateQueries({queryKey:C.organizationKeys.rolesV2(d)}),c.invalidateQueries({queryKey:N.organizationKeys.members(d)})]),x.toast.success(`Successfully updated role for ${i.username}`),o(!0)}catch(e){x.toast.error(`Failed to update role: ${e.message}`)}finally{f(!1);return}};return(0,r.jsx)(eT.default,{size:"medium",visible:e,loading:g,title:"Confirm to change roles of member",confirmLabel:"Update roles",confirmLabelLoading:"Updating",onCancel:()=>o(),onConfirm:I,children:(0,r.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:["You are making the following changes to the role of"," ",(0,r.jsx)("span",{className:"text-foreground",children:i.username})," in the organization"," ",(0,r.jsx)("span",{className:"text-foreground",children:u?.name}),":"]}),(0,r.jsxs)("div",{className:"flex flex-col gap-y-2",children:[0!==T.removed.length&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm",children:["Removing ",T.removed.length," role",T.removed.length>1?"s":""," for user:"]}),(0,r.jsx)("ul",{className:"list-disc pl-6",children:T.removed.map((e,i)=>{let s=w.find(r=>r.id===e.roleId)??z.find(r=>r.id===e.roleId),t=(s?.name??"Unknown").split("_")[0];return(0,r.jsxs)("li",{className:"text-sm text-foreground-light",children:[(0,r.jsx)("span",{className:"text-foreground",children:t})," on"," ",(0,r.jsx)("span",{className:"text-foreground",children:e?.name??"organization"})]},`update-${i}`)})})]}),0!==T.added.length&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm",children:["Adding ",T.added.length," role",T.added.length>1?"s":""," for user:"]}),(0,r.jsx)("ul",{className:"list-disc pl-6",children:T.added.map((e,i)=>{let s=b.find(r=>r.id===e.roleId);return(0,r.jsxs)("li",{className:"text-sm text-foreground-light",children:[(0,r.jsx)("span",{className:"text-foreground",children:s?.name})," on"," ",(0,r.jsx)("span",{className:"text-foreground",children:e?.name??"organization"})]},`update-${i}`)})})]}),0!==T.updated.length&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm",children:["Updating ",T.updated.length," role",T.updated.length>1?"s":""," for user:"]}),(0,r.jsx)("ul",{className:"list-disc pl-6",children:T.updated.map((e,i)=>{let s=w.find(r=>r.id===e.originalRole)??z.find(r=>r.id===e.originalRole),t=w.find(r=>r.id===e.updatedRole),a=(s?.name??"Unknown").split("_")[0];return(0,r.jsxs)("li",{className:"text-sm text-foreground-light",children:["From ",(0,r.jsx)("span",{className:"text-foreground",children:a})," to"," ",(0,r.jsx)("span",{className:"text-foreground",children:t?.name??"Unknown"})," on"," ",(0,r.jsx)("span",{className:"text-foreground",children:e?.name??"organization"})]},`update-${i}`)})})]})]}),(0,r.jsx)("p",{className:"text-sm text-foreground",children:"By changing the role of this member their permissions will change."})]})})},eY=({visible:e,member:i,onClose:a})=>{let{slug:c}=(0,t.useParams)(),{data:u}=(0,A.useSelectedOrganizationQuery)(),m=(0,P.useHasAccessToProjectLevelPermissions)(c),{data:h}=(0,eC.usePermissionsQuery)(),{data:p,isSuccess:g}=(0,n.useOrganizationRolesV2Query)({slug:c}),{data:x}=(0,l.useOrgProjectsInfiniteQuery)({slug:c}),f=x?.pages[0].pagination.count??0,y=(0,s.useMemo)(()=>x?.pages.flatMap(e=>e.projects),[x?.pages])||[],b=p?.org_scoped_roles??[],_=p?.project_scoped_roles??[],{rolesAddable:S,rolesRemovable:w}=G(u?.slug,b.concat(_),h??[]),N=b.every(e=>!S.includes(e.id)),[C,z]=(0,s.useState)(!1),[T,I]=(0,s.useState)(!1),[R,O]=(0,s.useState)([]),E=void 0!==p?eG(i,p):[],Q=1===E.length&&b.find(e=>e.id===E[0].roleId)?"org-scope":"project-scope",k=1===R.length&&R[0]?.ref===void 0,L=R.length>0,M=b.find(e=>"Developer"===e.name)?.id,q=y.filter(e=>!R.some(r=>r.ref===e.ref)),H=y.length-q.length,W=(0,eE.default)(R,E);return(0,s.useEffect)(()=>{e&&g&&O(eG(i,p))},[e,g]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e$.Sheet,{open:e,onOpenChange:()=>a(),children:(0,r.jsx)(e$.SheetContent,{showClose:!1,size:"default",className:"bg-surface-200 p-0 flex flex-row gap-0 md:w-[600px] lg:w-[600px] w-full",children:(0,r.jsxs)("div",{className:"flex flex-col grow w-full",children:[(0,r.jsxs)(e$.SheetHeader,{className:"py-3 flex flex-row justify-between gap-x-4 items-center border-b bg-transparent",children:[(0,r.jsxs)("p",{className:"truncate",title:`Manage access for ${i.username}`,children:["Manage access for ",i.username]}),(0,r.jsx)(o.DocsButton,{href:`${d.DOCS_URL}/guides/platform/access-control`})]}),(0,r.jsxs)(e$.SheetSection,{className:"h-full overflow-auto flex flex-col",children:[m&&(0,r.jsxs)("div",{className:"flex items-center gap-x-4 border-b border-border pb-4",children:[(0,r.jsx)(U.Switch,{disabled:N,checked:k,onCheckedChange:e=>{let r=M??b[0].id;e?"org-scope"===Q?O(E):O([{ref:void 0,name:void 0,roleId:r}]):"project-scope"===Q?O(E):O(y.map(e=>({ref:e.ref,name:e.name,roleId:r})))}}),(0,r.jsx)("p",{className:"text-sm",children:"Apply roles to all projects in the organization"})]}),0===R.length&&(0,r.jsxs)(eL.Alert_Shadcn_,{children:[(0,r.jsx)(eK.WarningIcon,{}),(0,r.jsx)(ek.AlertTitle_Shadcn_,{children:"Team members need to be assigned at least one role"}),(0,r.jsx)(eQ.AlertDescription_Shadcn_,{children:"You may not remove all roles from a team member"})]}),!k&&R.length>0&&R.length<f&&(0,r.jsxs)(eD.Collapsible_Shadcn_,{className:"bg-alternative border rounded-lg py-4 group",children:[(0,r.jsxs)(eq.CollapsibleTrigger_Shadcn_,{className:"w-full text-left px-4 flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm",children:W?`This member only has access to ${H} project${H>1?"s":""}`:`This member will only have access to ${H} project${H>1?"s":""}`}),(0,r.jsx)(eF.ChevronDown,{size:14,className:"transition group-data-[state=open]:-rotate-180"})]}),(0,r.jsxs)(eM.CollapsibleContent_Shadcn_,{className:"text-foreground-light text-sm px-4",children:[(0,r.jsxs)("p",{children:[i.username," ",W?"does":"will"," not have access to the following ",q.length," project",q.length>1?"s":"",":"]}),(0,r.jsx)("ul",{className:"list-disc pl-6",children:q.map(e=>(0,r.jsx)("li",{children:e.name},e.ref))})]})]}),(0,r.jsx)("div",{className:"flex flex-col divide-y divide-border",children:R.map(e=>{let i=void 0===e.ref?"All projects":e.name,s=b.find(r=>void 0!==e.baseRoleId?r.id===e.baseRoleId:r.id===e.roleId),t=w.includes(s?.id??0);return(0,r.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,r.jsx)("p",{className:"text-sm",children:i}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[N?(0,r.jsxs)(es.Tooltip,{children:[(0,r.jsx)(es.TooltipTrigger,{asChild:!0,children:(0,r.jsx)("div",{className:"flex items-center justify-between rounded-md border border-button bg-button px-3 py-2 text-sm h-10 w-56 text-foreground-light",children:s?.name??"Unknown"})}),(0,r.jsx)(es.TooltipContent,{side:"bottom",children:"Additional permissions required to update role"})]}):(0,r.jsxs)(V.Select_Shadcn_,{value:(e?.baseRoleId??e.roleId).toString(),onValueChange:r=>{void 0!==e.ref?O(R.map(i=>i.ref===e.ref?{ref:i.ref,name:i.name,roleId:Number(r)}:i)):O([{ref:void 0,roleId:Number(r)}])},children:[(0,r.jsx)(B.SelectTrigger_Shadcn_,{className:(0,ef.cn)(" w-40",s?.name===void 0&&"text-foreground-light"),children:s?.name??"Please select a role"}),(0,r.jsx)(D.SelectContent_Shadcn_,{children:(0,r.jsx)($.SelectGroup_Shadcn_,{children:(b??[]).map(e=>{let i=S.includes(e.id);return(0,r.jsx)(K.SelectItem_Shadcn_,{value:e.id.toString(),className:"text-sm hover:bg-selection cursor-pointer",disabled:!i,children:e.name},e.id)})})})]}),!k&&(0,r.jsx)(j.ButtonTooltip,{type:"text",disabled:!t,className:"px-1",icon:(0,r.jsx)(el.X,{}),onClick:()=>{var r;void 0!==(r=e?.ref)&&O(R.filter(e=>e.ref!==r))},tooltip:{content:{side:"bottom",text:t?"Remove access to project":"Additional permission required to remove role from member"}}})]})]},`${e.ref}-${e.roleId}`)})}),!k&&(0,r.jsx)(v.OrganizationProjectSelector,{open:T,setOpen:I,modal:!0,onSelect:e=>{O(R.concat({ref:e.ref,name:e.name,roleId:M??b[0].id})),I(!1)},renderTrigger:()=>(0,r.jsx)(F.Button,{type:"default",className:"w-min",children:"Add project"}),renderRow:e=>{let i=R.some(r=>r.ref===e.ref);return(0,r.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,r.jsx)("span",{className:"truncate",children:e.name}),i&&(0,r.jsx)("p",{className:"w-[45%] text-right",children:"Already assigned"})]})},isOptionDisabled:e=>R.some(r=>r.ref===e.ref)})]}),(0,r.jsxs)(e$.SheetFooter,{className:"flex items-center !justify-end px-5 py-4 w-full border-t",children:[(0,r.jsx)(F.Button,{type:"default",disabled:!1,onClick:()=>a(),children:"Cancel"}),(0,r.jsx)(F.Button,{loading:!1,disabled:!L||W,onClick:()=>{z(!0)},children:"Save roles"})]})]})})}),(0,r.jsx)(eW,{visible:C,member:i,projectsRoleConfiguration:R,onClose:e=>{z(!1),e&&a()}})]})},eX=({member:e})=>{let{slug:i}=(0,t.useParams)(),{profile:a}=(0,E.useProfile)(),[o,l]=(0,s.useState)(!1),[d,c]=(0,s.useState)(!1),u=(0,O.useIsFeatureEnabled)("organization_members:delete"),{data:m}=(0,A.useSelectedOrganizationQuery)(),{data:p}=(0,eC.usePermissionsQuery)(),{data:g}=(0,n.useOrganizationRolesV2Query)({slug:i}),{data:f}=(0,I.useOrganizationMembersQuery)({slug:i}),y=e.gotrue_id==a?.gotrue_id,v=g?.org_scoped_roles??[],b=g?.project_scoped_roles??[],w=!!e.invited_id,z=f?.find(e=>e.gotrue_id===a?.gotrue_id),P=1===(z?.role_ids??[]).length&&v.some(e=>e.id===z?.role_ids[0]),{rolesRemovable:Q}=G(m?.slug,v.concat(b),p??[]),k=e.role_ids?.[0]??-1,L=e.role_ids.every(e=>Q.includes(e)),{can:M}=(0,R.useAsyncCheckPermissions)(h.PermissionAction.CREATE,"user_invites",{resource:{role_id:k}}),{can:q}=(0,R.useAsyncCheckPermissions)(h.PermissionAction.DELETE,"user_invites",{resource:{role_id:k}}),{mutate:D,isPending:$}=eN({onSuccess:()=>{x.toast.success(`Successfully removed ${e.primary_email}`),c(!1)}}),{mutate:K,isPending:B}=T({onSuccess:()=>{x.toast.success("Resent the invitation.")},onError:e=>{x.toast.error(`Failed to resend invitation: ${e.message}`)}}),{mutate:V,isPending:U}=(({onSuccess:e,onError:r,...i}={})=>{let s=(0,S.useQueryClient)();return(0,_.useMutation)({mutationFn:e=>eS(e),async onSuccess(r,i,t){let{slug:a,skipInvalidation:o}=i;o||await Promise.all([s.invalidateQueries({queryKey:C.organizationKeys.rolesV2(a)}),s.invalidateQueries({queryKey:N.organizationKeys.members(a)})]),await e?.(r,i,t)},async onError(e,i,s){void 0===r?x.toast.error(`Failed to delete invitation: ${e.message}`):r(e,i,s)},...i})})(),H=$||U||B;return y?(0,r.jsx)("div",{className:"flex items-center justify-end",children:(0,r.jsx)(eA,{})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-end gap-x-2",children:[(0,r.jsx)(j.ButtonTooltip,{type:"default",disabled:w||!L,onClick:()=>l(!0),tooltip:{content:{side:"bottom",text:w?"Role can only be changed after the user has accepted the invite":L?void 0:"You need additional permissions to manage this team member"}},children:"Manage access"}),(0,r.jsxs)(ez.DropdownMenu,{children:[(0,r.jsx)(ez.DropdownMenuTrigger,{asChild:!0,children:(0,r.jsx)(F.Button,{type:"text",className:"px-1.5",disabled:H,loading:H,icon:(0,r.jsx)(ey.MoreVertical,{})})}),(0,r.jsx)(ez.DropdownMenuContent,{side:"bottom",align:"end",className:"w-40",children:(0,r.jsx)(r.Fragment,{children:w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(e_.DropdownMenuItemTooltip,{className:"gap-x-2",disabled:!(M&&P),onClick:()=>{let r,s;return r=(e?.role_ids??[])[0],s=e.invited_id,i?s?void V({slug:i,id:s,skipInvalidation:!0},{onSuccess:()=>{if(!e.primary_email)return x.toast.error("Email is required");let s=b.find(e=>e.id===r);if(void 0!==s){let r=s.projects.map(({ref:e})=>e);K({slug:i,email:e.primary_email,roleId:s.base_role_id,projects:r})}else K({slug:i,email:e.primary_email,roleId:r})}}):console.error("Member invited ID is required"):console.error("Slug is required")},tooltip:{content:{side:"left",text:"Additional permissions required to resend invitation"}},children:[(0,r.jsx)(ev,{size:14}),(0,r.jsx)("p",{children:"Resend invitation"})]}),(0,r.jsx)(ez.DropdownMenuSeparator,{}),(0,r.jsxs)(e_.DropdownMenuItemTooltip,{className:"gap-x-2",disabled:!(q&&P),onClick:()=>{let r;return r=e.invited_id,i?r?void V({slug:i,id:r},{onSuccess:()=>x.toast.success("Successfully revoked the invitation.")}):console.error("Member invited ID is required"):console.error("Slug is required")},tooltip:{content:{side:"left",text:"Additional permissions required to cancel invitation"}},children:[(0,r.jsx)(eb.Trash,{size:14}),(0,r.jsx)("p",{children:"Cancel invitation"})]})]}):u&&(0,r.jsxs)(e_.DropdownMenuItemTooltip,{className:"gap-x-2",disabled:!L,onClick:()=>c(!0),tooltip:{content:{side:"left",text:"Additional permissions required to remove member"}},children:[(0,r.jsx)(eb.Trash,{size:12}),(0,r.jsx)("p",{children:"Remove member"})]})})})]})]}),(0,r.jsx)(eT.default,{size:"large",visible:d,loading:$,title:"Confirm to remove member",confirmLabel:"Remove",variant:"warning",alert:{title:"All user content from this member will be permanently removed.",description:(0,r.jsxs)("div",{children:["Removing a member will delete all of the user's saved content in all projects of this organization, which includes:",(0,r.jsxs)("ul",{className:"list-disc pl-4 my-2",children:[(0,r.jsxs)("li",{children:["SQL snippets"," ",(0,r.jsxs)("span",{className:"text-foreground",children:["(both ",(0,r.jsx)("span",{className:"underline",children:"private"})," and"," ",(0,r.jsx)("span",{className:"underline",children:"shared"})," snippets)"]})]}),(0,r.jsx)("li",{children:"Custom reports"}),(0,r.jsx)("li",{children:"Log Explorer queries"})]}),(0,r.jsx)("p",{className:"mt-4 text-foreground-lighter",children:"If you'd like to retain the member's shared SQL snippets, right click on them and \"Duplicate query\" in the SQL Editor before removing this member."})]})},onCancel:()=>c(!1),onConfirm:()=>{i?e.gotrue_id?D({slug:i,gotrueId:e.gotrue_id}):console.error("gotrue_id is required"):console.error("slug is required")},children:(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to remove"," ",(0,r.jsx)("span",{className:"text-foreground",children:e.primary_email})," from"," ",(0,r.jsx)("span",{className:"text-foreground",children:m?.name}),"?"]})}),(0,r.jsx)(eY,{visible:o,member:e,onClose:()=>l(!1)})]})},eZ={vercel:"vercel-marketplace"},eJ=({member:e})=>{let{slug:i}=(0,t.useParams)(),{profile:a}=(0,E.useProfile)(),{data:o}=(0,A.useSelectedOrganizationQuery)(),{data:d,isPending:c}=(0,n.useOrganizationRolesV2Query)({slug:o?.slug}),u=(d?.project_scoped_roles??[]).length>0,{data:m}=(0,l.useOrgProjectsInfiniteQuery)({slug:i}),h=(0,s.useMemo)(()=>m?.pages.flatMap(e=>e.projects),[m?.pages])||[],g=!!e.invited_id,x=e.username===e.primary_email,f=!!e.primary_email?.endsWith("customer.fly.io"),j=g||x||f?void 0:(0,eu.getGitHubProfileImgUrl)(e.username);return(0,r.jsxs)(ei.TableRow,{children:[(0,r.jsx)(ei.TableCell,{children:(0,r.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,r.jsx)(ec.ProfileImage,{alt:e.primary_email??e.username??"",src:j,className:"border rounded-full w-[32px] h-[32px] md:w-[40px] md:h-[40px]",placeholder:(0,r.jsx)("div",{className:(0,ef.cn)("w-[32px] h-[32px] md:w-[40px] md:h-[40px]","bg-surface-100 border border-overlay rounded-full text-foreground-lighter flex items-center justify-center"),children:(0,r.jsx)(en.User,{size:20,strokeWidth:1.5})})}),(0,r.jsxs)("div",{className:"flex item-center gap-x-2",children:[(0,r.jsx)("p",{className:"text-foreground-light truncate",children:e.primary_email}),e.gotrue_id===a?.gotrue_id&&(0,r.jsx)(em.Badge,{children:"You"})]}),e.metadata?.origin&&(0,r.jsx)(ed.default,{organization:{managed_by:eZ[e.metadata.origin]??"supabase"},tooltipText:"This user is managed by Vercel Marketplace."})]})}),(0,r.jsxs)(ei.TableCell,{children:[g&&e.invited_at&&(0,r.jsx)(em.Badge,{variant:ej(e.invited_at)?"destructive":"warning",children:ej(e.invited_at)?"Expired":"Invited"}),e.is_sso_user&&(0,r.jsx)(em.Badge,{variant:"default",children:"SSO"})]}),(0,r.jsx)(ei.TableCell,{children:(0,r.jsx)("div",{className:"flex items-center justify-center",children:e.mfa_enabled?(0,r.jsx)(eo.Check,{className:"text-brand",strokeWidth:2,size:20}):(0,r.jsx)(el.X,{className:"text-foreground-light",strokeWidth:1.5,size:20})})}),(0,r.jsx)(ei.TableCell,{className:"max-w-64",children:c?(0,r.jsx)(et.ShimmeringLoader,{className:"w-32"}):e.role_ids.map(e=>{let i=(d?.org_scoped_roles??[]).find(r=>r.id===e),s=(d?.project_scoped_roles??[]).find(r=>r.id===e),t=i||s,a=(t?.name??"").split("_")[0],o=t?.projects.length===0?h?.map(e=>e.name)??[]:(t?.projects??[]).map(({ref:e})=>h?.find(r=>r.ref===e)?.name??"").filter(e=>e.length>0);return(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)("p",{children:a}),u&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"â€¢"}),1===o.length?(0,r.jsx)("span",{className:"text-foreground truncate",title:o[0],children:o[0]}):(0,r.jsxs)(eg.HoverCard_Shadcn_,{openDelay:200,children:[(0,r.jsx)(ep.HoverCardTrigger_Shadcn_,{asChild:!0,children:(0,r.jsx)("span",{className:"text-foreground",children:t?.projects.length===0?"Organization":`${o.length} project${o.length>1?"s":""}`})}),(0,r.jsxs)(eh.HoverCardContent_Shadcn_,{className:"p-0",children:[(0,r.jsxs)("p",{className:"p-2 text-xs",children:[a," role applies to ",o.length," project",o.length>1?"s":""]}),(0,r.jsx)("div",{className:"border-t flex flex-col py-1",children:(0,r.jsx)(ex.ScrollArea,{className:(0,ef.cn)(o.length>5?"h-[130px]":""),children:o.map(e=>{let i=h?.find(r=>r.name===e)?.ref;return(0,r.jsxs)(p.default,{href:`/project/${i}`,className:"px-2 py-1 group hover:bg-surface-300 hover:text-foreground transition flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs truncate max-w-[60%]",children:e}),(0,r.jsxs)("span",{className:"text-xs text-foreground flex items-center gap-x-1 opacity-0 group-hover:opacity-100 transition",children:["Go to project",(0,r.jsx)(ea.ArrowRight,{size:14})]})]},e)})})})]})]})]})]},`role-${e}`)})}),(0,r.jsx)(ei.TableCell,{children:(0,r.jsx)(eX,{member:e})})]})},e0=({searchString:e})=>{let{slug:i}=(0,t.useParams)(),{profile:a}=(0,E.useProfile)(),{data:o=[],error:l,isPending:u,isError:m,isSuccess:h}=(0,I.useOrganizationMembersQuery)({slug:i}),{data:p,error:g,isSuccess:x,isError:f}=(0,n.useOrganizationRolesV2Query)({slug:i}),j=(0,s.useMemo)(()=>e?o.filter(r=>r.invited_at?r.primary_email?.includes(e):r.gotrue_id?r.username.includes(e)||r.primary_email?.includes(e):void 0):o,[o,e]),[[y],v]=(0,J.default)(j,e=>e.gotrue_id===a?.gotrue_id),b=o.find(e=>e.gotrue_id===a?.gotrue_id),_=(p?.org_scoped_roles??[]).map(e=>e.id).includes(b?.role_ids?.[0]??-1),S=(_?v:v.filter(e=>!("invited_id"in e))).sort((e,r)=>(e.primary_email??"").localeCompare(r.primary_email??""));return(0,r.jsxs)(r.Fragment,{children:[u&&(0,r.jsx)(et.GenericSkeletonLoader,{}),m&&(0,r.jsx)(Z.default,{error:l,subject:"Failed to retrieve organization members"}),f&&(0,r.jsx)(Z.default,{error:g,subject:"Failed to retrieve organization roles"}),h&&(0,r.jsx)("div",{className:"rounded w-full overflow-hidden overflow-x-scroll",children:(0,r.jsx)(ee.Card,{children:(0,r.jsx)(er.Loading,{active:!j,children:(0,r.jsxs)(ei.Table,{children:[(0,r.jsx)(ei.TableHeader,{children:(0,r.jsxs)(ei.TableRow,{children:[(0,r.jsx)(ei.TableHead,{children:"User"},"header-user"),(0,r.jsx)(ei.TableHead,{className:"w-24"},"header-status"),(0,r.jsx)(ei.TableHead,{className:"text-center w-32",children:"Enabled MFA"},"header-mfa"),(0,r.jsxs)(ei.TableHead,{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Role"}),(0,r.jsxs)(es.Tooltip,{children:[(0,r.jsx)(es.TooltipTrigger,{asChild:!0,children:(0,r.jsx)(F.Button,{asChild:!0,type:"text",className:"px-1",children:(0,r.jsx)("a",{target:"_blank",rel:"noreferrer",href:`${d.DOCS_URL}/guides/platform/access-control`,children:(0,r.jsx)(X.HelpCircle,{size:14,className:"text-foreground-light"})})})}),(0,r.jsx)(es.TooltipContent,{side:"bottom",children:"How to configure access control?"})]})]},"header-role"),(0,r.jsx)(ei.TableHead,{},"header-action")]})}),(0,r.jsx)(ei.TableBody,{children:[...x&&h&&!_?[(0,r.jsx)(ei.TableRow,{children:(0,r.jsx)(ei.TableCell,{colSpan:12,className:"!p-0",children:(0,r.jsx)(c.Admonition,{type:"note",title:"You are currently assigned with project scoped roles in this organization",description:"All other members within the organization will not be visible to you",className:"bg-alternative border-0 rounded-none"})})},"project-scope-notice")]:[],...y?[(0,r.jsx)(eJ,{member:y},y.gotrue_id)]:[],...S.map(e=>(0,r.jsx)(eJ,{member:e},e.gotrue_id)),...e.length>0&&0===j.length?[(0,r.jsx)(ei.TableRow,{className:"bg-panel-secondary-light",children:(0,r.jsx)(ei.TableCell,{colSpan:12,children:(0,r.jsxs)("div",{className:"flex items-center space-x-3 opacity-75",children:[(0,r.jsx)(Y.AlertCircle,{size:16,strokeWidth:2}),(0,r.jsxs)("p",{className:"text-foreground-light",children:['No users matched the search query "',e,'"']})]})})},"no-results")]:[],(0,r.jsx)(ei.TableRow,{className:"bg-panel-secondary-light",children:(0,r.jsx)(ei.TableCell,{colSpan:12,children:(0,r.jsxs)("p",{className:"text-foreground-light",children:[e?`${j.length} of `:"",o.length||"0"," ",1==o.length?"user":"users"]})})},"footer")]})]})})})})]})},e1=()=>{let{slug:e}=(0,t.useParams)(),[m,h]=(0,s.useState)(""),{data:p}=(0,n.useOrganizationRolesV2Query)({slug:e}),g=(p?.project_scoped_roles??[]).length>0,{data:x}=(0,l.useOrgProjectsInfiniteQuery)({slug:e}),f=x?.pages[0].pagination.count??0;return(0,r.jsx)(a.ScaffoldContainer,{children:(0,r.jsxs)(a.ScaffoldSection,{isFullWidth:!0,className:"!py-8 gap-y-8",children:[(0,r.jsx)(a.ScaffoldTitle,{children:"Team"}),(0,r.jsxs)(a.ScaffoldFilterAndContent,{children:[(0,r.jsxs)(a.ScaffoldActionsContainer,{className:"w-full flex-col md:flex-row gap-2 justify-between",children:[(0,r.jsx)(u.Input,{size:"tiny",autoComplete:"off",icon:(0,r.jsx)(i.Search,{}),value:m,onChange:e=>h(e.target.value),name:"email",id:"email",placeholder:"Filter members"}),(0,r.jsxs)(a.ScaffoldActionsGroup,{className:"w-full md:w-auto",children:[(0,r.jsx)(o.DocsButton,{href:`${d.DOCS_URL}/guides/platform/access-control`}),(0,r.jsx)(W,{})]})]}),g&&f>1e3&&(0,r.jsx)(c.Admonition,{type:"warning",title:"This page may not render properly due to the number of projects your account has access to",description:"We're actively looking into optimizing this page and will make things available as soon as we can!"}),(0,r.jsx)(a.ScaffoldSectionContent,{className:"w-full",children:(0,r.jsx)(e0,{searchString:m})})]})]})})};var e2=e.i(448710),e4=e.i(121958),e5=e.i(818843);let e3=()=>{let{isPending:e}=(0,eC.usePermissionsQuery)(),{data:i}=(0,A.useSelectedOrganizationQuery)();return void 0===i&&e?(0,r.jsx)(e5.LogoLoader,{}):(0,r.jsx)(e1,{})};e3.getLayout=e=>(0,r.jsx)(e2.default,{children:(0,r.jsx)(e4.default,{children:e})}),e.s(["default",0,e3],22312)},396821,(e,r,i)=>{let s="/org/[slug]/team";(window.__NEXT_P=window.__NEXT_P||[]).push([s,()=>e.r(22312)]),r.hot&&r.hot.dispose(function(){window.__NEXT_P.push([s])})}]);

//# debugId=755397a6-734d-5af4-1896-7a170b064142
//# sourceMappingURL=e072b4ecc87560e8.js.map