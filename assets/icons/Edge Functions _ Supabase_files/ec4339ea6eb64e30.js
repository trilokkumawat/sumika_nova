;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="ffb5c98e-d489-1535-c5ba-a48ece02aafe")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,797275,344665,181933,e=>{"use strict";var t=e.i(902858),a=e.i(615515),r=e.i(621018);let n=e=>`${(0,r.default)(e)}_keys`,s=e=>`${(0,r.default)(e)}_fdw`;e.s(["getAnalyticsBucketFDWName",0,s,"getAnalyticsBucketFDWServerName",0,e=>`${(0,r.default)(e)}_fdw_server`,"getAnalyticsBucketPublicationName",0,e=>`analytics_${(0,r.default)(e)}_publication`,"getAnalyticsBucketS3KeyName",0,n,"getAnalyticsBucketsDestinationName",0,e=>`${(0,r.default)(e)}_destination`,"getNamespaceTableNameFromPostgresTableName",0,e=>`${(0,r.default)(`${e.schema}.${e.name}`)}_changelog`],344665);var i=e.i(146217),o=e.i(108892),l=e.i(377451),u=e.i(760377),c=e.i(2579),d=e.i(635494),p=e.i(895604);e.s(["useIcebergWrapperCreateMutation",0,()=>{let{data:e}=(0,d.useSelectedProjectQuery)(),{can:r}=(0,c.useAsyncCheckPermissions)(t.PermissionAction.SECRETS_READ,"*"),{data:m}=(0,o.useAPIKeysQuery)({projectRef:e?.ref,reveal:!0},{enabled:r}),{secretKey:f,serviceKey:g}=(0,o.getKeys)(m),{data:h}=(0,l.useProjectSettingsV2Query)({projectRef:e?.ref}),b=h?.app_config?.protocol??"https",y=h?.app_config?.storage_endpoint||h?.app_config?.endpoint,v=f?.api_key??g?.api_key??"SUPABASE_CLIENT_API_KEY",x=a.WRAPPERS.find(e=>"iceberg_wrapper"===e.name),{can:w}=(0,c.useAsyncCheckPermissions)(t.PermissionAction.STORAGE_ADMIN_WRITE,"*"),{mutateAsync:_,isPending:k}=(0,p.useS3AccessKeyCreateMutation)(),{mutateAsync:j,isPending:A}=(0,u.useFDWCreateMutation)();return{mutateAsync:async({bucketName:t})=>{let a=await _({projectRef:e?.ref,description:n(t)}),r=s(t),o={projectRef:e?.ref,connectionString:e?.connectionString,wrapperMeta:x,formState:{wrapper_name:r,server_name:`${r}_server`,vault_aws_access_key_id:a?.access_key,vault_aws_secret_access_key:a?.secret_key,vault_token:v,warehouse:t,"s3.endpoint":(0,i.getConnectionURL)(e?.ref??"",b,y),catalog_uri:(0,i.getCatalogURI)(e?.ref??"",b,y)},mode:"skip",tables:[],sourceSchema:"",targetSchema:""};await j(o)},isPending:A||k,hasPermission:w}}],797275);var m=e.i(933275),f=e.i(450972);e.s(["useIcebergWrapperExtension",0,()=>{let{data:e}=(0,d.useSelectedProjectQuery)(),{data:t,isPending:a}=(0,f.useDatabaseExtensionsQuery)({projectRef:e?.ref,connectionString:e?.connectionString}),r=m.INTEGRATIONS.find(e=>"iceberg_wrapper"===e.id);if(!r||"wrapper"!==r.type)return{extension:void 0,state:"not-found"};let n=r.meta,s=t?.find(e=>"wrappers"===e.name),i=!!s?.installed_version,o=(s?.installed_version??"")>=(n?.minimumExtensionVersion??"");return{extension:s,state:a?"loading":i?o?"installed":"needs-upgrade":"not-installed"}}],181933)},237311,e=>{"use strict";var t=e.i(242882),a=e.i(25862),r=e.i(234745),n=e.i(635494);e.i(10429);var s=e.i(837508),i=e.i(937163);async function o({projectRef:e},t){if(!e)throw Error("projectRef is required");let{data:a,error:n}=await (0,r.get)("/platform/storage/{ref}/analytics-buckets",{params:{path:{ref:e}},signal:t});return n&&(0,r.handleError)(n),a.data}e.s(["useAnalyticsBucketsQuery",0,({projectRef:e},{enabled:r=!0,...l}={})=>{let{data:u}=(0,n.useSelectedProjectQuery)(),c=u?.status===s.PROJECT_STATUS.ACTIVE_HEALTHY,d=(0,a.useIsAnalyticsBucketsEnabled)({projectRef:u?.ref});return(0,t.useQuery)({queryKey:i.storageKeys.analyticsBuckets(e),queryFn:({signal:t})=>o({projectRef:e},t),enabled:r&&void 0!==e&&c&&d,...l})}])},743116,e=>{"use strict";var t=e.i(458602);e.s(["AnalyticsBucket",()=>t.default])},363744,(e,t,a)=>{t.exports=function(e){return function(t){return null==e?void 0:e[t]}}},217264,(e,t,a)=>{t.exports=function(e,t,a,r){var n=-1,s=null==e?0:e.length;for(r&&s&&(a=e[++n]);++n<s;)a=t(a,e[n],n,e);return a}},228613,(e,t,a)=>{t.exports=e.r(363744)({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"})},901549,(e,t,a)=>{var r=e.r(228613),n=e.r(896955),s=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,i=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");t.exports=function(e){return(e=n(e))&&e.replace(s,r).replace(i,"")}},295464,(e,t,a)=>{var r=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;t.exports=function(e){return e.match(r)||[]}},184140,(e,t,a)=>{var r=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;t.exports=function(e){return r.test(e)}},395330,(e,t,a)=>{var r="\ud800-\udfff",n="\\u2700-\\u27bf",s="a-z\\xdf-\\xf6\\xf8-\\xff",i="A-Z\\xc0-\\xd6\\xd8-\\xde",o="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",l="['’]",u="["+o+"]",c="["+s+"]",d="[^"+r+o+"\\d+"+n+s+i+"]",p="(?:\ud83c[\udde6-\uddff]){2}",m="[\ud800-\udbff][\udc00-\udfff]",f="["+i+"]",g="(?:"+c+"|"+d+")",h="(?:"+f+"|"+d+")",b="(?:"+l+"(?:d|ll|m|re|s|t|ve))?",y="(?:"+l+"(?:D|LL|M|RE|S|T|VE))?",v="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\ud83c[\udffb-\udfff])?",x="[\\ufe0e\\ufe0f]?",w="(?:\\u200d(?:"+["[^"+r+"]",p,m].join("|")+")"+x+v+")*",_="(?:"+["["+n+"]",p,m].join("|")+")"+(x+v+w),k=RegExp([f+"?"+c+"+"+b+"(?="+[u,f,"$"].join("|")+")",h+"+"+y+"(?="+[u,f+g,"$"].join("|")+")",f+"?"+g+"+"+b,f+"+"+y,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])|\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])|\\d+",_].join("|"),"g");t.exports=function(e){return e.match(k)||[]}},777699,(e,t,a)=>{var r=e.r(295464),n=e.r(184140),s=e.r(896955),i=e.r(395330);t.exports=function(e,t,a){return(e=s(e),void 0===(t=a?void 0:t))?n(e)?i(e):r(e):e.match(t)||[]}},226581,(e,t,a)=>{var r=e.r(217264),n=e.r(901549),s=e.r(777699),i=RegExp("['’]","g");t.exports=function(e){return function(t){return r(s(n(t).replace(i,"")),e,"")}}},621018,(e,t,a)=>{t.exports=e.r(226581)(function(e,t,a){return e+(a?"_":"")+t.toLowerCase()})},760377,e=>{"use strict";var t=e.i(38429),a=e.i(356003),r=e.i(355901),n=e.i(497761),s=e.i(534499),i=e.i(714403),o=e.i(774184),l=e.i(742578),u=e.i(584258);function c({wrapperMeta:e,formState:t,mode:a,tables:r,sourceSchema:n,targetSchema:s,schemaOptions:i=[]}){let o=r.filter(e=>e.is_new_schema).map(e=>`create schema if not exists ${e.schema_name};`).join("\n"),l=`
    create foreign data wrapper "${t.wrapper_name}"
    handler "${e.handlerName}"
    validator "${e.validatorName}";
  `,u=e.server.options.filter(e=>e.encrypted),c=e.server.options.filter(e=>!e.encrypted),d=u.map(e=>{let a=`${t.wrapper_name}_${e.name}`,r=(t[e.name]||"").replace(/'/g,"''");return`
      do $$
      begin
        -- Old wrappers has an implicit dependency on pgsodium. For new wrappers
        -- we use Vault directly.
        if (select extversion from pg_extension where extname = 'wrappers') in (
          '0.1.0',
          '0.1.1',
          '0.1.4',
          '0.1.5',
          '0.1.6',
          '0.1.7',
          '0.1.8',
          '0.1.9',
          '0.1.10',
          '0.1.11',
          '0.1.12',
          '0.1.14',
          '0.1.15',
          '0.1.16',
          '0.1.17',
          '0.1.18',
          '0.1.19',
          '0.2.0',
          '0.3.0',
          '0.3.1',
          '0.4.0',
          '0.4.1',
          '0.4.2',
          '0.4.3',
          '0.4.4',
          '0.4.5'
        ) then
          create extension if not exists pgsodium;

          perform pgsodium.create_key(
            name := '${a}'
          );

          perform vault.create_secret(
            new_secret := '${r}',
            new_name   := '${a}',
            new_key_id := (select id from pgsodium.valid_key where name = '${a}')
          );
        else
          perform vault.create_secret(
            new_secret := '${r}',
            new_name := '${a}'
          );
        end if;
      end $$;
    `}).join("\n"),p=[...u.filter(e=>t[e.name]).map(e=>`${e.name} ''%s''`),...c.filter(e=>t[e.name]).map(e=>`"${e.name}" ''${t[e.name].replace(/'/g,"''''")}''`)].join(","),m=`
    do $$
    declare
      -- Old wrappers has an implicit dependency on pgsodium. For new wrappers
      -- we use Vault directly.
      is_using_old_wrappers bool;
      ${u.map(e=>`v_${e.name} text;`).join("\n")}
    begin
      is_using_old_wrappers := (select extversion from pg_extension where extname = 'wrappers') in (
        '0.1.0',
        '0.1.1',
        '0.1.4',
        '0.1.5',
        '0.1.6',
        '0.1.7',
        '0.1.8',
        '0.1.9',
        '0.1.10',
        '0.1.11',
        '0.1.12',
        '0.1.14',
        '0.1.15',
        '0.1.16',
        '0.1.17',
        '0.1.18',
        '0.1.19',
        '0.2.0',
        '0.3.0',
        '0.3.1',
        '0.4.0',
        '0.4.1',
        '0.4.2',
        '0.4.3',
        '0.4.4',
        '0.4.5'
      );
      ${u.map(e=>`
              if is_using_old_wrappers then
                select id into v_${e.name} from pgsodium.valid_key where name = '${t.wrapper_name}_${e.name}' limit 1;
              else
                select id into v_${e.name} from vault.secrets where name = '${t.wrapper_name}_${e.name}' limit 1;
              end if;
            `).join("\n")}
    
      execute format(
        E'create server "${t.server_name}" foreign data wrapper "${t.wrapper_name}" options (${p});',
        ${u.filter(e=>t[e.name]).map(e=>`v_${e.name}`).join(",\n")}
      );
    end $$;
  `,f=r.map(e=>{let a=e.columns;return`
        create foreign table "${e.schema_name}"."${e.table_name}" (
          ${a.map(e=>`"${e.name}" ${e.type}`).join(",\n          ")}
        )
        server ${t.server_name}
        options (
          ${Object.entries(e).filter(([e,t])=>"table_name"!==e&&"schema_name"!==e&&"columns"!==e&&"index"!==e&&"is_new_schema"!==e&&!!t).map(([e,t])=>`${e} '${t}'`).join(",\n          ")}
        );
      `}).join("\n\n"),g=[...i,"strict 'true'"].join(", "),h=`
  import foreign schema "${n}" from server ${t.server_name} into ${s} options (${g});
`;return`
    ${o}

    ${l}

    ${d}

    ${m}

    ${"tables"===a?f:""}

    ${"schema"===a?h:""}
  `}async function d({projectRef:e,connectionString:t,...a}){let r=(0,o.wrapWithTransaction)(c(a)),{result:n}=await (0,i.executeSql)({projectRef:e,connectionString:t,sql:r});return n}e.s(["getCreateFDWSql",()=>c,"useFDWCreateMutation",0,({onSuccess:e,onError:i,...o}={})=>{let c=(0,a.useQueryClient)();return(0,t.useMutation)({mutationFn:e=>d(e),async onSuccess(t,a,r){let{projectRef:i}=a;await Promise.all([c.invalidateQueries({queryKey:u.fdwKeys.list(i),refetchType:"all"}),c.invalidateQueries({queryKey:n.entityTypeKeys.list(i)}),c.invalidateQueries({queryKey:s.foreignTableKeys.list(i)}),c.invalidateQueries({queryKey:l.vaultSecretsKeys.list(i)})]),await e?.(t,a,r)},async onError(e,t,a){void 0===i?r.toast.error(`Failed to create ${t.wrapperMeta.label} foreign data wrapper: ${e.message}`):i(e,t,a)},...o})}])},74244,e=>{"use strict";let t=(0,e.i(388019).default)("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);e.s(["Timer",()=>t],74244)},880791,e=>{"use strict";let t=(0,e.i(388019).default)("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]);e.s(["Webhook",()=>t],880791)},933275,722310,829298,e=>{"use strict";var t=e.i(478902),a=e.i(388019);let r=(0,a.default)("Clock5",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 14.5 16",key:"1pcbox"}]]);e.s(["Clock5",()=>r],722310);var n=e.i(796238),s=e.i(74244);let i=(0,a.default)("Vault",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}],["path",{d:"m7.9 7.9 2.7 2.7",key:"hpeyl3"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}],["path",{d:"m13.4 10.6 2.7-2.7",key:"264c1n"}],["circle",{cx:"7.5",cy:"16.5",r:".5",fill:"currentColor",key:"nkw3mc"}],["path",{d:"m7.9 16.1 2.7-2.7",key:"p81g5e"}],["circle",{cx:"16.5",cy:"16.5",r:".5",fill:"currentColor",key:"fubopw"}],["path",{d:"m13.4 13.4 2.7 2.7",key:"abhel3"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);e.s(["Vault",()=>i],829298);var o=e.i(880791),l=e.i(679152),u=e.i(994110),c=e.i(10429),d=e.i(843778),p=e.i(108151),m=e.i(210419),f=e.i(635494),g=e.i(837710),h=e.i(710483);let b=({minimumVersion:e="15.6"})=>{let{data:a}=(0,f.useSelectedProjectQuery)();return(0,t.jsxs)(h.Admonition,{type:"warning",className:"mt-4",title:"Database upgrade needed",childProps:{description:{className:"flex flex-col gap-y-2"}},children:[(0,t.jsx)("div",{className:"prose text-sm max-w-full",children:(0,t.jsxs)("p",{children:["This integration requires the ",(0,t.jsx)("code",{children:"pgmq"})," extension which is not available on this version of Postgres. The extension is available on version ",e," and higher."]})}),(0,t.jsx)(g.Button,{color:"primary",className:"w-fit",children:(0,t.jsx)(m.default,{href:`/project/${a?.ref}/settings/infrastructure`,children:"Upgrade database"})})]})};var y=e.i(615515);let v=()=>(0,t.jsx)("div",{className:"p-10",children:(0,t.jsx)(p.GenericSkeletonLoader,{})}),x={name:"Supabase",websiteUrl:"https://supabase.com"},w=[{id:"queues",type:"postgres_extension",requiredExtensions:["pgmq"],missingExtensionsAlert:(0,t.jsx)(b,{minimumVersion:"15.6.1.143"}),name:"Queues",icon:({className:e,...a}={})=>(0,t.jsx)(n.Layers,{className:(0,d.cn)("inset-0 p-2 text-black w-full h-full",e),...a}),description:"Lightweight message queue in Postgres",docsUrl:"https://github.com/tembo-io/pgmq",author:{name:"pgmq",websiteUrl:"https://github.com/tembo-io/pgmq"},navigation:[{route:"overview",label:"Overview"},{route:"queues",label:"Queues",hasChild:!0,childIcon:(0,t.jsx)(n.Layers,{size:12,strokeWidth:1.5,className:(0,d.cn)("text-foreground w-full h-full")})},{route:"settings",label:"Settings"}],navigate:(t,a="overview",r)=>{if(r)return(0,l.default)(()=>e.A(274794).then(e=>e.QueuePage),{loadableGenerated:{modules:[571538]},loading:v});switch(a){case"overview":return(0,l.default)(()=>e.A(909495).then(e=>e.QueuesOverviewTab),{loadableGenerated:{modules:[698380]},loading:v});case"queues":return(0,l.default)(()=>e.A(548863).then(e=>e.QueuesTab),{loadableGenerated:{modules:[79703]},loading:v});case"settings":return(0,l.default)(()=>e.A(283398).then(e=>e.QueuesSettings),{loadableGenerated:{modules:[541970]},loading:v})}return null}},{id:"cron",type:"postgres_extension",requiredExtensions:["pg_cron"],name:"Cron",icon:({className:e,...a}={})=>(0,t.jsx)(r,{className:(0,d.cn)("inset-0 p-2 text-black w-full h-full",e),...a}),description:"Schedule recurring Jobs in Postgres",docsUrl:"https://github.com/citusdata/pg_cron",author:{name:"Citus Data",websiteUrl:"https://github.com/citusdata/pg_cron"},navigation:[{route:"overview",label:"Overview"},{route:"jobs",label:"Jobs",hasChild:!0,childIcon:(0,t.jsx)(s.Timer,{size:12,strokeWidth:1.5,className:(0,d.cn)("text-foreground w-full h-full")})}],navigate:(t,a="overview",r)=>{if(r)return(0,l.default)(()=>e.A(609157).then(e=>e.CronJobPage),{loadableGenerated:{modules:[323205]},loading:v});switch(a){case"overview":return(0,l.default)(()=>e.A(529471).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{modules:[159380]},loading:v});case"jobs":return(0,l.default)(()=>e.A(579437).then(e=>e.CronjobsTab),{loadableGenerated:{modules:[524943]},loading:v})}return null}},{id:"vault",type:"postgres_extension",requiredExtensions:["supabase_vault"],missingExtensionsAlert:(0,t.jsx)(b,{}),name:"Vault",status:"beta",icon:({className:e,...a}={})=>(0,t.jsx)(i,{className:(0,d.cn)("inset-0 p-2 text-black w-full h-full",e),...a}),description:"Application level encryption for your project",docsUrl:c.DOCS_URL,author:x,navigation:[{route:"overview",label:"Overview"},{route:"secrets",label:"Secrets"}],navigate:(t,a="overview",r)=>{switch(a){case"overview":return(0,l.default)(()=>e.A(529471).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{modules:[159380]},loading:v});case"secrets":return(0,l.default)(()=>e.A(707643).then(e=>e.SecretsManagement),{loadableGenerated:{modules:[935100]},loading:v})}return null}},{id:"webhooks",type:"postgres_extension",name:"Database Webhooks",icon:({className:e,...a}={})=>(0,t.jsx)(o.Webhook,{className:(0,d.cn)("inset-0 p-2 text-black w-full h-full",e),...a}),description:"Send real-time data from your database to another system when a table event occurs",docsUrl:c.DOCS_URL,author:x,requiredExtensions:[],navigation:[{route:"overview",label:"Overview"},{route:"webhooks",label:"Webhooks"}],navigate:(t,a="overview",r)=>{switch(a){case"overview":return(0,l.default)(()=>e.A(467186).then(e=>e.WebhooksOverviewTab),{loadableGenerated:{modules:[6777]},loading:v});case"webhooks":return(0,l.default)(()=>e.A(639206).then(e=>e.WebhooksListTab),{loadableGenerated:{modules:[791713]},loading:v})}return null}},{id:"graphiql",type:"postgres_extension",requiredExtensions:["pg_graphql"],name:"GraphQL",icon:({className:e,...a}={})=>(0,t.jsx)(u.default,{fill:!0,src:`${c.BASE_PATH}/img/graphql.svg`,alt:"GraphiQL",className:(0,d.cn)("p-2",e),...a}),description:"Run GraphQL queries through our interactive in-browser IDE",docsUrl:c.DOCS_URL,author:x,navigation:[{route:"overview",label:"Overview"},{route:"graphiql",label:"GraphiQL"}],navigate:(t,a="overview",r)=>{switch(a){case"overview":return(0,l.default)(()=>e.A(529471).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{modules:[159380]},loading:v});case"graphiql":return(0,l.default)(()=>e.A(500556).then(e=>e.GraphiQLTab),{loadableGenerated:{modules:[321608]},loading:v})}return null}}],_=[...y.WRAPPERS.map(a=>({id:a.name,type:"wrapper",name:`${a.label} Wrapper`,icon:({className:e,...r}={})=>(0,t.jsx)(u.default,{fill:!0,src:a.icon,alt:a.name,className:(0,d.cn)("p-2",e),...r}),requiredExtensions:["wrappers","supabase_vault"],description:a.description,docsUrl:a.docsUrl,meta:a,author:x,navigation:[{route:"overview",label:"Overview"},{route:"wrappers",label:"Wrappers"}],navigate:(t,a="overview",r)=>{switch(a){case"overview":return(0,l.default)(()=>e.A(596207).then(e=>e.WrapperOverviewTab),{loadableGenerated:{modules:[865243]},loading:v});case"wrappers":return(0,l.default)(()=>e.A(354946).then(e=>e.WrappersTab),{loadableGenerated:{modules:[674412]},loading:v})}return null}})),...w,{id:"stripe_sync_engine",type:"custom",requiredExtensions:["pgmq","supabase_vault","pg_cron","pg_net"],missingExtensionsAlert:(0,t.jsx)(b,{minimumVersion:"15.6.1.143"}),name:"Stripe Sync Engine",status:"alpha",icon:({className:e,...a}={})=>(0,t.jsx)(u.default,{fill:!0,src:`${c.BASE_PATH}/img/icons/stripe-icon.svg`,alt:"Stripe Logo",className:(0,d.cn)("p-2",e),...a}),description:"Continuously sync your payments, customer, and other data from Stripe to your Postgres database",docsUrl:"https://github.com/stripe-experiments/sync-engine/",author:{name:"Stripe",websiteUrl:"https://www.stripe.com"},navigation:[{route:"overview",label:"Overview"},{route:"settings",label:"Settings"}],navigate:(t,a="overview",r)=>{switch(a){case"overview":return(0,l.default)(()=>e.A(208268).then(e=>e.StripeSyncInstallationPage),{loadableGenerated:{modules:[799765]},loading:v});case"settings":return(0,l.default)(()=>e.A(98740).then(e=>e.StripeSyncSettingsPage),{loadableGenerated:{modules:[795776]},loading:v})}return null}}];e.s(["INTEGRATIONS",0,_],933275)},774184,e=>{"use strict";function t(e){return`
    begin;
 
    ${e}
    
    commit;
  `}function a(e){return`
    begin;
 
    ${e}
    
    rollback;
  `}e.s(["wrapWithRollback",()=>a,"wrapWithTransaction",()=>t])},534499,e=>{"use strict";let t={list:e=>["projects",e,"foreignTables"],listBySchema:(e,a)=>[...t.list(e),a]};e.s(["foreignTableKeys",0,t])},742578,e=>{"use strict";e.s(["vaultSecretsKeys",0,{list:e=>["projects",e,"secrets"],getDecryptedValue:(e,t)=>["projects",e,"secrets",t]}])},25862,e=>{"use strict";var t=e.i(242882),a=e.i(234745),r=e.i(10429),n=e.i(78162);async function s({projectRef:e},t){if(!e)throw Error("projectRef is required");let{data:r,error:n}=await (0,a.get)("/platform/projects/{ref}/config/storage",{params:{path:{ref:e}},signal:t});return n&&(404===n.code?(0,a.handleError)({...n,message:"Storage configuration not found."}):(0,a.handleError)(n)),r}let i=({projectRef:e},{enabled:a=!0,...i}={})=>(0,t.useQuery)({queryKey:n.configKeys.storage(e),queryFn:({signal:t})=>s({projectRef:e},t),enabled:a&&r.IS_PLATFORM&&void 0!==e,...i});e.s(["useIsAnalyticsBucketsEnabled",0,({projectRef:e})=>{let{data:t}=i({projectRef:e});return!!t?.features.icebergCatalog?.enabled},"useIsVectorBucketsEnabled",0,({projectRef:e})=>{let{data:t}=i({projectRef:e});return!!t?.features.vectorBuckets?.enabled},"useProjectStorageConfigQuery",0,i])},895604,65749,e=>{"use strict";var t=e.i(38429),a=e.i(356003),r=e.i(355901),n=e.i(234745);let s={credentials:e=>["projects",e,"storage-credentials"]};e.s(["storageCredentialsKeys",0,s],65749);let i=async({description:e,projectRef:t})=>{if(!t)throw Error("projectRef is required");let{data:a,error:r}=await (0,n.post)("/platform/storage/{ref}/credentials",{params:{path:{ref:t}},body:{description:e}});return r&&(0,n.handleError)(r),a};function o({onSuccess:e,onError:n,...l}={}){let u=(0,a.useQueryClient)();return(0,t.useMutation)({mutationFn:e=>i(e),async onSuccess(t,a,r){let{projectRef:n}=a;await u.invalidateQueries({queryKey:s.credentials(n)}),await e?.(t,a,r)},async onError(e,t,a){void 0===n?r.toast.error(`Failed to create S3 access key: ${e.message}`):n(e,t,a)},...l})}e.s(["useS3AccessKeyCreateMutation",()=>o],895604)},256771,e=>{"use strict";var t=e.i(478902),a=e.i(532728),r=e.i(408891),n=e.i(355901),s=e.i(417403);e.i(128328);var i=e.i(158639),o=e.i(937942),l=e.i(610144),u=e.i(38429),c=e.i(356003),d=e.i(234745),p=e.i(937163);async function m({projectRef:e,bucketName:t}){if(!e)throw Error("projectRef is required");if(!t)throw Error("Bucket name is required");let{data:a,error:r}=await (0,d.post)("/platform/storage/{ref}/analytics-buckets",{params:{path:{ref:e}},body:{bucketName:t}});return r&&(0,d.handleError)(r),a}var f=e.i(237311),g=e.i(797275),h=e.i(162082),b=e.i(265735),y=e.i(635494),v=e.i(10429),x=e.i(837710),w=e.i(843778),_=e.i(253214),k=e.i(428353),j=e.i(24315),A=e.i(61863),S=e.i(378277),$=e.i(725137),E=e.i(710483),C=e.i(538482),I=e.i(181933);let T=/^(?:xn--|sthree-|amzn-s3-demo-|aws)/,P=/(?:-s3alias|--ol-s3|--x-s3|--table-s3)$/,q=/^[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/,R=s.default.object({name:s.default.string().trim().min(3,"Bucket name should be at least 3 characters").max(63,"Bucket name should be up to 63 characters").refine(e=>!e.endsWith(" "),"The name of the bucket cannot end with a whitespace").refine(e=>"public"!==e,'"public" is a reserved name. Please choose another name')}).superRefine((e,t)=>{if(T.test(e.name)){let[a]=e.name.match(T)??[];return t.addIssue({path:["name"],code:s.default.ZodIssueCode.custom,message:`Bucket name cannot start with "${a}"`})}if(P.test(e.name)){let[a]=e.name.match(P)??[];return t.addIssue({path:["name"],code:s.default.ZodIssueCode.custom,message:`Bucket name cannot end with "${a}"`})}if(/[A-Z]/.test(e.name))return t.addIssue({path:["name"],code:s.default.ZodIssueCode.custom,message:"Bucket name can only be lowercase characters"});if(!q.test(e.name)){if(!/^[a-z0-9]/.test(e.name))return t.addIssue({path:["name"],code:s.default.ZodIssueCode.custom,message:"Bucket name must start with a lowercase letter or number."});if(!/[a-z0-9]$/.test(e.name))return t.addIssue({path:["name"],code:s.default.ZodIssueCode.custom,message:"Bucket name must end with a lowercase letter or number."});let[a]=e.name.match(/[^a-z0-9-]/)??[];return t.addIssue({path:["name"],code:s.default.ZodIssueCode.custom,message:a?`Bucket name cannot contain the "${a}" character`:"Bucket name contains an invalid special character"})}}),N="create-analytics-storage-bucket-form";e.s(["CreateAnalyticsBucketForm",0,({type:e="dialog",onOpenChange:s})=>{let{ref:d}=(0,i.useParams)(),{data:T}=(0,b.useSelectedOrganizationQuery)(),{data:P}=(0,y.useSelectedProjectQuery)(),{extension:q,state:O}=(0,I.useIcebergWrapperExtension)(),{data:U=[]}=(0,f.useAnalyticsBucketsQuery)({projectRef:d}),B="needs-upgrade"===O,{mutate:L}=(0,h.useSendEventMutation)(),{mutateAsync:Q,isPending:W}=(({onSuccess:e,onError:t,...a}={})=>{let r=(0,c.useQueryClient)();return(0,u.useMutation)({mutationFn:e=>m(e),async onSuccess(t,a,n){let{projectRef:s}=a;await r.invalidateQueries({queryKey:p.storageKeys.analyticsBuckets(s)}),await e?.(t,a,n)},async onError(e,a,r){void 0===t?n.toast.error(`Failed to create analytics bucket: ${e.message}`):t(e,a,r)},...a})})({onError:()=>{}}),{mutateAsync:G,isPending:D}=(0,g.useIcebergWrapperCreateMutation)(),{mutateAsync:F,isPending:K}=(0,l.useDatabaseExtensionEnableMutation)(),z=K||D||W,M=(0,r.useForm)({resolver:(0,a.zodResolver)(R),defaultValues:{name:""}}),Z=async e=>{if(!d)return console.error("Project ref is required");if(!P)return console.error("Project details is required");if(!q)return console.error("Unable to find wrappers extension");if(U.some(t=>t.name===e.name))return n.toast.error("Bucket name already exists");try{await Q({projectRef:d,bucketName:e.name}),"not-installed"===O&&await F({projectRef:P?.ref,connectionString:P?.connectionString,name:q.name,schema:q.schema??"extensions",version:q.default_version}),await G({bucketName:e.name}),L({action:"storage_bucket_created",properties:{bucketType:"analytics"},groups:{project:d??"Unknown",organization:T?.slug??"Unknown"}}),M.reset(),n.toast.success(`Created bucket “${e.name}”`),s(!1)}catch(e){n.toast.error(`Failed to create bucket: ${e.message}`)}},V="dialog"===e?_.DialogSection:$.SheetSection,H="dialog"===e?_.DialogFooter:$.SheetFooter;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V,{className:"flex flex-col !p-0 flex-grow",children:(0,t.jsx)(k.Form_Shadcn_,{...M,children:(0,t.jsxs)("form",{id:N,onSubmit:M.handleSubmit(Z),children:[(0,t.jsx)(A.FormField_Shadcn_,{name:"name",control:M.control,render:({field:e})=>(0,t.jsx)(C.FormItemLayout,{name:"name",className:"p-5",label:"Bucket name",labelOptional:"Cannot be changed after creation",description:"Must be between 3 – 63 characters. Only lowercase letters, numbers, and hyphens are allowed.",children:(0,t.jsx)(j.FormControl_Shadcn_,{children:(0,t.jsx)(S.Input_Shadcn_,{id:"name","data-1p-ignore":!0,"data-lpignore":"true","data-form-type":"other","data-bwignore":!0,...e,placeholder:"Enter bucket name"})})})},"name"),B?(0,t.jsx)(E.Admonition,{type:"warning",className:(0,w.cn)("border-x-0 rounded-none","dialog"===e&&"border-b-0"),title:"Wrappers extension must be updated for Iceberg Wrapper support",children:(0,t.jsxs)("p",{className:"prose max-w-full text-sm !leading-normal",children:["Update the ",(0,t.jsx)("code",{className:"text-code-inline",children:"wrappers"})," extension by upgrading your project from your"," ",(0,t.jsx)(o.InlineLink,{href:`/project/${d}/settings/infrastructure`,children:"project settings"})," ","before creating an Analytics bucket."," ",(0,t.jsx)(o.InlineLink,{href:`${v.DOCS_URL}/guides/database/extensions/wrappers/iceberg`,children:"Learn more"}),"."]})}):(0,t.jsx)(E.Admonition,{type:"default",className:(0,w.cn)("border-x-0 rounded-none","dialog"===e&&"border-b-0"),children:(0,t.jsxs)("p",{className:"!leading-normal",children:["Supabase will install the"," ","installed"!==O?"Wrappers extension and ":"","Iceberg Wrapper integration on your behalf."," ",(0,t.jsx)(o.InlineLink,{href:`${v.DOCS_URL}/guides/database/extensions/wrappers/iceberg`,children:"Learn more"}),"."]})})]})})}),(0,t.jsxs)(H,{children:[(0,t.jsx)(x.Button,{type:"default",disabled:z,onClick:()=>s(!1),children:"Cancel"}),(0,t.jsx)(x.Button,{form:N,htmlType:"submit",loading:z,disabled:B||z,children:"Create bucket"})]})]})}],256771)}]);

//# debugId=ffb5c98e-d489-1535-c5ba-a48ece02aafe
//# sourceMappingURL=111123c881ae8265.js.map