;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="4d3b1219-70bf-d34f-ca65-80ea78b03692")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25123,e=>{"use strict";var t=e.i(265735);function s(){let{data:e}=(0,t.useSelectedOrganizationQuery)();return e?{plan:e?.plan,usageBillingEnabled:e?.usage_billing_enabled,isLoading:!1,isSuccess:!0}:{plan:null,usageBillingEnabled:null,isLoading:!0,isSuccess:!1}}e.s(["useCurrentOrgPlan",()=>s])},929461,e=>{"use strict";var t=e.i(242882),s=e.i(234745),r=e.i(718727);async function a({projectRef:e,type:t,name:r,limit:a=10},l){if(void 0===e)throw Error("projectRef is required for getContent");let{data:i,error:n}=await (0,s.get)("/platform/projects/{ref}/content",{params:{path:{ref:e},query:{type:t,name:r,limit:a.toString()}},signal:l});return n&&(0,s.handleError)(n),{cursor:i.cursor,content:i.data}}e.s(["useContentQuery",0,({projectRef:e,type:s,name:l,limit:i},{enabled:n=!0,...o}={})=>(0,t.useQuery)({queryKey:r.contentKeys.list(e,{type:s,name:l,limit:i}),queryFn:({signal:t})=>a({projectRef:e,type:s,name:l,limit:i},t),enabled:n&&void 0!==e,...o})])},586011,e=>{"use strict";var t=e.i(38429),s=e.i(356003),r=e.i(355901),a=e.i(234745),l=e.i(718727);async function i({projectRef:e,ids:t},s){let{data:r,error:l}=await (0,a.del)("/platform/projects/{ref}/content",{headers:{Version:"2"},params:{path:{ref:e},query:{ids:t.join(",")}},signal:s});return l&&(0,a.handleError)(l),r.map(e=>e.id)}e.s(["useContentDeleteMutation",0,({onSuccess:e,onError:a,...n}={})=>{let o=(0,s.useQueryClient)();return(0,t.useMutation)({mutationFn:e=>i(e),async onSuccess(t,s,r){let{projectRef:a}=s;await Promise.all([o.invalidateQueries({queryKey:l.contentKeys.allContentLists(a)}),o.invalidateQueries({queryKey:l.contentKeys.infiniteList(a)})]),await e?.(t,s,r)},async onError(e,t,s){void 0===a?r.toast.error(`Failed to delete contents: ${e.message}`):a(e,t,s)},...n})}])},271332,e=>{"use strict";var t=e.i(478902),s=e.i(389959),r=e.i(843778),a=e.i(837710),l=e.i(253214);let i=(0,s.forwardRef)(({children:e,customFooter:i,description:n,hideFooter:o=!1,alignFooter:c="left",layout:d="horizontal",loading:u=!1,cancelText:p="Cancel",onConfirm:m=()=>{},onCancel:x=()=>{},confirmText:h="Confirm",showCloseButton:f=!0,footerBackground:g,variant:j="success",visible:y=!1,size:v="large",style:b,overlayStyle:N,contentStyle:S,triggerElement:C,header:w,modal:I,defaultOpen:k,...E},R)=>{let[T,_]=s.default.useState(!!y&&y);(0,s.useEffect)(()=>{_(y)},[y]);let P=i||(0,t.jsxs)("div",{className:"flex w-full space-x-2",style:{width:"100%",justifyContent:"vertical"===d?"center":"right"===c?"flex-end":"flex-start"},children:[(0,t.jsx)(a.Button,{type:"default",onClick:x,disabled:u,children:p}),(0,t.jsx)(a.Button,{onClick:m,disabled:u,loading:u,type:"danger"===j?"danger":"warning"===j?"warning":"primary",children:h})]});return(0,t.jsxs)(l.Dialog,{open:T,defaultOpen:k,onOpenChange:function(e){void 0===y||e?_(e):x()},modal:I,children:[C&&(0,t.jsx)(l.DialogTrigger,{children:C}),(0,t.jsxs)(l.DialogContent,{ref:R,hideClose:!f,...E,size:v,children:[w||n?(0,t.jsxs)(l.DialogHeader,{className:(0,r.cn)("border-b"),padding:"small",children:[w&&(0,t.jsx)(l.DialogTitle,{children:w}),n&&(0,t.jsx)(l.DialogDescription,{children:n})]}):null,e,!o&&(0,t.jsx)(l.DialogFooter,{padding:"small",children:P})]})]})}),n=(0,s.forwardRef)(({...e},s)=>(0,t.jsx)(l.DialogSection,{ref:s,...e,padding:"small",className:(0,r.cn)(e.className)})),o=(0,s.forwardRef)(({...e},s)=>(0,t.jsx)(l.DialogSectionSeparator,{ref:s,...e}));i.Content=n,i.Separator=o,e.s(["default",0,i])},40892,e=>{"use strict";var t=e.i(271332);e.s(["Modal",()=>t.default])},441345,e=>{"use strict";var t=e.i(343563);e.s(["Form",()=>t.default])},95069,e=>{"use strict";let t=(0,e.i(388019).default)("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]);e.s(["ChevronsDown",()=>t],95069)},498377,e=>{"use strict";var t=e.i(478902),s=e.i(416050),r=e.i(95069),a=e.i(774803),l=e.i(366652),i=e.i(210419),n=e.i(389959),o=e.i(843778),c=e.i(925282),d=e.i(774234),u=e.i(554855),p=e.i(874311),m=e.i(378277);e.i(903248);var x=e.i(613580),h=e.i(792459);e.i(108151);let f=(0,n.forwardRef)(({...e},s)=>(0,t.jsx)(c.Collapsible_Shadcn_,{ref:s,...e,className:(0,o.cn)("w-full px-2 group",e.className)})),g=(0,n.forwardRef)(({...e},r)=>(0,t.jsxs)(u.CollapsibleTrigger_Shadcn_,{ref:r,...e,className:(0,o.cn)("w-full flex gap-1 items-center group px-3 text-sm font-normal font-mono uppercase text-lighter tracking-wide",e.className),children:[(0,t.jsx)(s.ChevronRight,{className:"transition-all text-foreground-muted group-data-[state=open]:rotate-90",size:16,strokeWidth:1.5}),(0,t.jsx)("span",{className:"group-hover:not-disabled:text-foreground",children:e.title})]})),j=(0,n.forwardRef)(({...e},s)=>(0,t.jsx)(d.CollapsibleContent_Shadcn_,{ref:s,...e,className:(0,o.cn)("w-full flex flex-col gap-0",e.className)})),y=(0,n.forwardRef)((e,s)=>(0,t.jsx)("div",{ref:s,...e,className:(0,o.cn)("h-px bg-border-muted",e.className)})),v=(0,n.forwardRef)(({className:e,isActive:s,forceHoverState:r,...a},l)=>(0,t.jsx)(i.default,{ref:l,...a,"aria-current":s,className:(0,o.cn)("text-sm","h-7 pl-3 pr-2","flex items-center justify-between rounded-md group relative",s?"bg-selection":"hover:bg-surface-200",r&&"bg-surface-200",s?"text-foreground":"text-foreground-light hover:text-foreground",e)})),b=(0,n.forwardRef)(({isActive:e=!0,forceHoverState:s,isPreview:r,isOpened:a=!0,...l},n)=>(0,t.jsxs)(i.default,{ref:n,...l,"aria-current":e,className:(0,o.cn)((0,h.TreeViewItemVariant)({isSelected:e&&!r,isOpened:a&&!r,isPreview:r}),"px-4",l.className),children:[!r&&e&&(0,t.jsx)("div",{className:"absolute left-0 h-full w-0.5 bg-foreground"}),l.children]})),N=(0,n.forwardRef)((e,s)=>(0,t.jsx)("div",{ref:s,...e,className:(0,o.cn)("flex px-2 gap-2 items-center",e.className)})),S=(0,n.forwardRef)(({children:e,isLoading:s=!1,...r},i)=>(0,t.jsxs)("label",{htmlFor:r.name,className:"relative w-full",children:[(0,t.jsx)("span",{className:"sr-only",children:r["aria-labelledby"]}),(0,t.jsx)(m.Input_Shadcn_,{ref:i,type:"text",className:(0,o.cn)("h-[32px] md:h-[28px] w-full","text-base md:text-xs","pl-7","pr-7","w-full","rounded",r.className),...r}),e,s?(0,t.jsx)(a.Loader2,{className:"animate-spin absolute left-2 text-foreground-muted",style:{top:7},size:14,strokeWidth:1.5}):(0,t.jsx)(l.Search,{className:"absolute left-2 top-0 bottom-0 my-auto text-foreground-muted",size:14,strokeWidth:1.5})]})),C=(0,n.forwardRef)(({value:e,onValueChange:s,contentClassName:a,triggerClassName:l,...i},n)=>(0,t.jsxs)(p.DropdownMenu,{modal:!1,children:[(0,t.jsxs)(x.Tooltip,{delayDuration:0,children:[(0,t.jsx)(p.DropdownMenuTrigger,{asChild:!0,className:(0,o.cn)("absolute right-1 top-[.4rem] md:top-[.3rem]","text-foreground transition-colors hover:text-foreground data-[state=open]:text-foreground",l),children:(0,t.jsx)(x.TooltipTrigger,{children:(0,t.jsx)(r.ChevronsDown,{size:18,strokeWidth:1})})}),(0,t.jsx)(x.TooltipContent,{side:"bottom",children:"Sort By"})]}),(0,t.jsx)(p.DropdownMenuContent,{side:"bottom",align:"end",className:(0,o.cn)("w-48",a),children:(0,t.jsx)(p.DropdownMenuRadioGroup,{value:e,onValueChange:s,children:i.children})})]})),w=(0,n.forwardRef)((e,s)=>(0,t.jsx)(p.DropdownMenuRadioItem,{ref:s,...e})),I=(0,n.forwardRef)(({illustration:e,title:s,description:r,actions:a,...l},i)=>(0,t.jsx)("div",{ref:i,...l,className:(0,o.cn)("border border-muted bg-surface-100 dark:bg-surface-75 flex flex-col gap-y-3 items-center justify-center rounded-md px-5 py-4",l.className),children:(0,t.jsxs)("div",{className:"w-full flex flex-col gap-y-1 items-center",children:[e,s&&(0,t.jsx)("p",{className:"text-xs text-foreground-light",children:s}),r&&(0,t.jsx)("p",{className:"text-xs text-foreground-lighter text-center",children:r}),a&&(0,t.jsx)("div",{className:"mt-2",children:a}),l.children]})}));e.s(["InnerSideBarEmptyPanel",()=>I,"InnerSideBarFilterSearchInput",()=>S,"InnerSideBarFilterSortDropdown",()=>C,"InnerSideBarFilterSortDropdownItem",()=>w,"InnerSideBarFilters",()=>N,"InnerSideMenuCollapsible",()=>f,"InnerSideMenuCollapsibleContent",()=>j,"InnerSideMenuCollapsibleTrigger",()=>g,"InnerSideMenuDataItem",()=>b,"InnerSideMenuItem",()=>v,"InnerSideMenuSeparator",()=>y])},223173,674742,843819,928253,993032,e=>{"use strict";var t=e.i(478902);e.i(481541);var s=e.i(126200);e.s(["Datadog",()=>s.default],674742);var s=s,r=e.i(841231);e.s(["Grafana",()=>r.default],843819);var r=r,a=e.i(660253);e.s(["Sentry",()=>a.default],928253);var a=a,l=e.i(33034),l=l,i=e.i(388019);let n=(0,i.default)("Braces",[["path",{d:"M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5c0 1.1.9 2 2 2h1",key:"ezmyqa"}],["path",{d:"M16 21h1a2 2 0 0 0 2-2v-5c0-1.1.9-2 2-2a2 2 0 0 1-2-2V5a2 2 0 0 0-2-2h-1",key:"e1hn23"}]]);e.s(["BracesIcon",()=>n],993032);let o=(0,i.default)("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),c={height:24,width:24,className:"text-foreground-light"},d=[{value:"webhook",name:"Custom Endpoint",description:"Forward logs as a POST request to a custom HTTP endpoint",icon:(0,t.jsx)(n,{...c})},{value:"datadog",name:"Datadog",description:"Datadog is a monitoring service for cloud-scale applications",icon:(0,t.jsx)(s.default,{...c,fill:"currentColor",strokeWidth:0})},{value:"loki",name:"Loki",description:"Loki is an open-source log aggregation system designed to store and query logs from multiple sources",icon:(0,t.jsx)(r.default,{...c,fill:"currentColor",strokeWidth:0})},{value:"s3",name:"Amazon S3",description:"Forward logs to an S3 bucket",icon:(0,t.jsx)(o,{...c})},{value:"sentry",name:"Sentry",description:"Sentry is an application monitoring service that helps developers identify and debug performance issues and errors",icon:(0,t.jsx)(a.default,{...c,fill:"currentColor",strokeWidth:0})},{value:"axiom",name:"Axiom",description:"Axiom is a data platform designed to efficiently collect, store, and analyze event and telemetry data at massive scale.",icon:(0,t.jsx)(l.default,{...c,fill:"currentColor",strokeWidth:0})}];d.map(e=>e.value),e.s(["DATADOG_REGIONS",0,[{label:"AP1",value:"AP1"},{label:"AP2",value:"AP2"},{label:"EU",value:"EU"},{label:"US1",value:"US1"},{label:"US1-FED",value:"US1-FED"},{label:"US3",value:"US3"},{label:"US5",value:"US5"}],"LOG_DRAIN_TYPES",0,d],223173)},388034,e=>{"use strict";let t=(0,e.i(388019).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["default",()=>t])},61187,e=>{"use strict";var t=e.i(388034);e.s(["RefreshCw",()=>t.default])},532480,e=>{"use strict";let t=(0,e.i(388019).default)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);e.s(["default",()=>t])},833655,e=>{"use strict";var t=e.i(532480);e.s(["Info",()=>t.default])},330287,e=>{"use strict";var t=e.i(242882),s=e.i(234745),r=e.i(10429),a=e.i(346691);async function l({projectRef:e},t){if(!e)throw Error("Project ref is required");let{data:r,error:a}=await (0,s.get)("/platform/projects/{ref}/load-balancers",{params:{path:{ref:e}},signal:t});return a&&(0,s.handleError)(a),r}e.s(["useLoadBalancersQuery",0,({projectRef:e},{enabled:s=!0,...i}={})=>(0,t.useQuery)({queryKey:a.replicaKeys.loadBalancers(e),queryFn:({signal:t})=>l({projectRef:e},t),enabled:s&&void 0!==e&&r.IS_PLATFORM,...i})])},520124,e=>{"use strict";var t=e.i(460988),s=e.i(389959);e.s(["useFillTimeseriesSorted",0,e=>{let{data:r,timestampKey:a,valueKey:l,defaultValue:i,startDate:n,endDate:o,minPointsToFill:c=20,interval:d}=e;return(0,s.useMemo)(()=>{var e;if(!r[0]?.[a])return{data:r,error:null,isError:!1};try{return{data:(e=(0,t.fillTimeseries)(r,a,l,i,n,o,c,d),[...e].sort((e,t)=>new Date(e[a]).getTime()-new Date(t[a]).getTime())),error:null,isError:!1}}catch(e){return{data:[],error:e instanceof Error?e:Error(String(e)),isError:!0}}},[JSON.stringify(r),a,JSON.stringify(l),i,n,o,c,d])}])},223600,e=>{"use strict";var t=e.i(478902),s=e.i(370410),r=e.i(816467),a=e.i(389959),l=e.i(837710),i=e.i(843778),n=e.i(375761);let o=(0,a.forwardRef)(({text:e,asyncText:o,iconOnly:c=!1,children:d,onClick:u,copyLabel:p="Copy",copiedLabel:m="Copied",...x},h)=>{let[f,g]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(!f)return;let e=setTimeout(()=>g(!1),2e3);return()=>clearTimeout(e)},[f]),(0,t.jsx)(l.Button,{ref:h,onClick:t=>{let s=o?o():e;g(!0),(0,n.copyToClipboard)(s),u?.(t)},...x,className:(0,i.cn)({"px-1":c},x.className),icon:f?(0,t.jsx)(s.Check,{strokeWidth:2,className:"text-brand"}):x.icon??(0,t.jsx)(r.Copy,{}),children:!c&&(0,t.jsx)(t.Fragment,{children:d??(f?m:p)})})});o.displayName="CopyButton",e.s(["default",0,o])},979377,e=>{"use strict";var t=e.i(478902),s=e.i(210419),r=e.i(265735),a=e.i(837710),l=e.i(40892),i=e.i(993394);e.s(["default",0,({show:e,setShowUpgradePrompt:n,title:o="Log retention",description:c="Logs can be retained up to a duration of 3 months depending on the plan that your project is on.",source:d="logsRetentionUpgradePrompt"})=>{let{data:u}=(0,r.useSelectedOrganizationQuery)();return(0,t.jsxs)(l.Modal,{hideFooter:!0,visible:e,size:"medium",header:o,onCancel:()=>n(!1),children:[(0,t.jsx)(l.Modal.Content,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("p",{className:"text-sm",children:c}),(0,t.jsxs)("div",{className:"border-control bg-surface-300 rounded border",children:[(0,t.jsxs)("div",{className:"flex items-center px-4 pt-2 pb-1",children:[(0,t.jsx)("p",{className:"text-foreground-light w-[40%] text-sm",children:"Plan"}),(0,t.jsx)("p",{className:"text-foreground-light w-[60%] text-sm",children:"Retention duration"})]}),(0,t.jsxs)("div",{className:"py-1",children:[(0,t.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,t.jsx)("p",{className:"w-[40%] text-sm",children:"Free"}),(0,t.jsx)("p",{className:"w-[60%] text-sm",children:i.TIER_QUERY_LIMITS.FREE.text})]}),(0,t.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,t.jsx)("p",{className:"w-[40%] text-sm",children:"Pro"}),(0,t.jsx)("p",{className:"w-[60%] text-sm",children:i.TIER_QUERY_LIMITS.PRO.text})]}),(0,t.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,t.jsx)("p",{className:"w-[40%] text-sm",children:"Team"}),(0,t.jsx)("p",{className:"w-[60%] text-sm",children:i.TIER_QUERY_LIMITS.TEAM.text})]}),(0,t.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,t.jsx)("p",{className:"w-[40%] text-sm",children:"Enterprise"}),(0,t.jsx)("p",{className:"w-[60%] text-sm",children:i.TIER_QUERY_LIMITS.ENTERPRISE.text})]})]})]})]})}),(0,t.jsx)(l.Modal.Separator,{}),(0,t.jsxs)(l.Modal.Content,{className:"flex justify-end gap-3",children:[(0,t.jsx)(a.Button,{type:"default",onClick:()=>n(!1),children:"Close"}),(0,t.jsx)(a.Button,{asChild:!0,size:"tiny",children:(0,t.jsx)(s.default,{href:`/org/${u?.slug}/billing?panel=subscriptionPlan&source=${d}`,children:"Upgrade"})})]})]})}])},218786,e=>{"use strict";var t=e.i(478902);e.i(223600),e.i(460988);var s=e.i(867637),r=e.i(833655);e.i(55956);var a=e.i(843778);function l(e){let t=JSON.stringify(e,null,2);return(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var t="number text-tomato-900";return/^"/.test(e)?t=/:$/.test(e)?"key text-foreground":"string text-brand-600":/true|false/.test(e)?t="boolean text-blue-900":/null/.test(e)&&(t="null text-amber-1100"),'<span class="'+t+'">'+e+"</span>"}).split(`
`).map(e=>`<span class="line text-xs">${e}</span>`).join("\n")}e.s(["ResponseCodeFormatter",0,({value:e})=>{if(!e)return(0,t.jsx)("div",{children:(0,t.jsx)("label",{className:"text-xs text-border-stronger",children:"No data"})});let s=({children:e,className:s})=>(0,t.jsx)("div",{className:"flex h-full items-center",children:(0,t.jsx)("div",{className:(0,a.cn)("relative flex h-6 items-center rounded-md justify-center px-2 py-1 text-center",s),children:(0,t.jsx)("label",{className:"block font-mono text-sm",children:e})})});switch(e.toString().split("")[0]){case"1":return(0,t.jsx)(s,{children:e});case"2":return(0,t.jsx)(s,{className:"bg-surface-100 text-brand",children:e});case"5":return(0,t.jsx)(s,{className:"bg-red-300 text-red-1100",children:e});case"4":case"3":return(0,t.jsx)(s,{className:"bg-amber-300 text-amber-1100",children:e});default:return(0,t.jsx)(s,{className:"bg-surface-100 text-foreground-lighter",children:e})}},"RowLayout",0,({children:e})=>(0,t.jsx)("div",{className:"flex h-full w-full items-center gap-4",children:e}),"SeverityFormatter",0,({value:e,uppercase:a=!0})=>{if(!e)return(0,t.jsx)("div",{children:(0,t.jsx)("label",{className:"text-xs text-border-stronger",children:"No data"})});let l=e.toUpperCase(),i=a?l:e,n=({className:e,children:s})=>(0,t.jsx)("div",{className:`w-24 flex items-center h-full ${e}`,children:s});switch(l){case"UNCAUGHTEXCEPTION":case"PANIC":case"FATAL":case"ERROR":return(0,t.jsxs)(n,{className:"gap-1",children:[(0,t.jsx)("div",{className:" p-0.5 rounded !text-red-900",children:(0,t.jsx)(s.AlertCircle,{size:14,strokeWidth:2})}),(0,t.jsx)("span",{className:"!text-red-900 !block titlecase",children:i})]});case"INFO":case"DEBUG":return(0,t.jsxs)(n,{className:"gap-1",children:[(0,t.jsx)("div",{className:" p-0.5 rounded !text-blue-900",children:(0,t.jsx)(s.AlertCircle,{size:14,strokeWidth:2})}),(0,t.jsx)("span",{className:"!text-blue-900 !block titlecase",children:i})]});case"LOG":return(0,t.jsxs)(n,{className:"gap-1",children:[(0,t.jsx)("div",{className:" p-0.5 rounded !text-blue-900",children:(0,t.jsx)(r.Info,{size:14,strokeWidth:2})}),(0,t.jsx)("span",{className:"!text-blue-900 !block titlecase",children:i})]});case"WARNING":return(0,t.jsxs)(n,{className:"gap-1",children:[(0,t.jsx)("div",{className:" p-0.5 rounded !text-amber-900",children:(0,t.jsx)(s.AlertCircle,{size:14,strokeWidth:2})}),(0,t.jsx)("span",{className:"!text-amber-900 !block titlecase",children:i})]});default:return(0,t.jsx)(n,{children:(0,t.jsx)("div",{className:"relative rounded px-2 py-1 text-center h-6 flex justify-center items-center bg-surface-100",children:(0,t.jsx)("label",{className:"block font-mono text-sm text-foreground-lighter",children:i})})})}},"TextFormatter",0,({value:e,className:s})=>(0,t.jsx)("span",{className:(0,a.cn)("font-mono text-xs truncate select-text cursor-text",s),children:e}),"jsonSyntaxHighlight",()=>l])},124532,e=>{"use strict";var t=e.i(478902),s=e.i(843778);function r({title:e,description:r,illustration:a,actions:l,className:i}){return(0,t.jsxs)("div",{className:(0,s.cn)("rounded-lg border p-4 space-y-3","bg-muted/10 border-border/50","text-left [&_*]:text-left [&_div]:items-start",i),children:[a&&(0,t.jsx)("div",{className:"flex justify-start items-start",children:a}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h3",{className:"font-medium text-sm text-foreground",children:e}),(0,t.jsx)("p",{className:"text-xs text-foreground-light",children:r})]}),l&&(0,t.jsx)("div",{className:"flex justify-start items-start gap-x-2",children:l})]})}e.s(["FeaturePreviewSidebarPanel",()=>r])},275887,e=>{"use strict";let t=(0,e.i(388019).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>t],275887)},737051,e=>{"use strict";e.i(128328);var t=e.i(657588),s=e.i(265735);e.s(["useIsETLPrivateAlpha",0,()=>{let{data:e}=(0,s.useSelectedOrganizationQuery)(),r=(0,t.useFlag)("etlPrivateAlpha"),a="string"==typeof r?r.split(",").map(e=>e.trim()):[];return(0,t.useFlag)("etlPrivateAlphaOverride")||a.includes(e?.slug??"")}])},237664,e=>{"use strict";e.s(["replicationKeys",0,{sources:e=>["projects",e,"sources"],destinations:e=>["projects",e,"destinations"],destinationById:(e,t)=>["projects",e,"destinations",t],publications:(e,t)=>["projects",e,"sources",t,"publications"],tables:(e,t)=>["projects",e,"sources",t,"tables"],pipelines:e=>["projects",e,"pipelines"],pipelineById:(e,t)=>["projects",e,"pipelines",t],pipelinesStatus:(e,t)=>["projects",e,"pipelines",t,"status"],pipelinesReplicationStatus:(e,t)=>["projects",e,"pipelines",t,"replication-status"],pipelinesVersion:(e,t)=>["projects",e,"pipelines",t,"version"]}])},344409,633089,e=>{"use strict";var t=e.i(242882),s=e.i(234745),r=e.i(237664),a=e.i(741391);e.i(56031);var l=e.i(237948);let i=(e,t)=>!(t instanceof l.ResponseError&&503===t.code&&t.message.includes("feature flag is required"))&&e<a.MAX_RETRY_FAILURE_COUNT;async function n({projectRef:e},t){if(!e)throw Error("projectRef is required");let{data:r,error:a}=await (0,s.get)("/platform/replication/{ref}/sources",{params:{path:{ref:e}},signal:t});return a&&(0,s.handleError)(a),r}e.s(["checkReplicationFeatureFlagRetry",0,i],633089),e.s(["useReplicationSourcesQuery",0,({projectRef:e},{enabled:s=!0,...a}={})=>(0,t.useQuery)({queryKey:r.replicationKeys.sources(e),queryFn:({signal:t})=>n({projectRef:e},t),enabled:s&&void 0!==e,refetchOnMount:!1,refetchOnWindowFocus:!1,retry:i,...a})],344409)},281050,e=>{"use strict";var t=e.i(50470);e.s(["CircleHelpIcon",()=>t.default])},421605,276708,e=>{"use strict";var t=e.i(478902),s=e.i(271226),r=e.i(389959),a=e.i(355901);e.i(128328);var l=e.i(158639),i=e.i(586011),n=e.i(420985),o=e.i(874311),c=e.i(466472),d=e.i(837710),u=e.i(441345),p=e.i(171997),m=e.i(40892);let x=({visible:e,onCancel:s,onSubmit:r,initialValues:a})=>(0,t.jsx)(m.Modal,{visible:e,onCancel:s,hideFooter:!0,header:"Update saved query",size:"medium",children:(0,t.jsx)(u.Form,{onReset:s,validateOnBlur:!0,initialValues:a,validate:function(e){let t={};return e.name||(t.name="Required"),t},onSubmit:r,children:({isSubmitting:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Modal.Content,{children:(0,t.jsx)(p.Input,{label:"Name",id:"name",name:"name"})}),(0,t.jsx)(m.Modal.Content,{children:(0,t.jsx)(p.Input.TextArea,{label:"Description",id:"description",placeholder:"Describe query",size:"medium",textAreaClassName:"resize-none"})}),(0,t.jsx)(m.Modal.Separator,{}),(0,t.jsxs)(m.Modal.Content,{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(d.Button,{htmlType:"reset",type:"default",onClick:s,disabled:e,children:"Cancel"}),(0,t.jsx)(d.Button,{htmlType:"submit",loading:e,disabled:e,children:"Save query"})]})]})})});var h=e.i(53071),f=e.i(211570);e.i(481541);var g=e.i(171137),j=e.i(275887),y=e.i(210419),v=e.i(843778);function b({label:e,icon:s,dropdownItems:r,href:a,isActive:l,onClick:i}){return(0,t.jsxs)("div",{className:(0,v.cn)({"bg-foreground-lighter/10":l},"relative flex [&:has([data-state=open])]:bg-foreground-lighter/10 [&:has([data-state=open])]:text-foreground hover:text-foreground hover:bg-foreground-lighter/10 transition-all text-foreground-light group"),children:[(0,t.jsxs)(y.default,{onClick:i,href:a,className:"h-7 flex-1 text-sm px-4 flex items-center gap-2 truncate",children:[(0,t.jsx)("span",{children:s}),(0,t.jsx)("span",{className:"truncate",children:e})]}),r&&(0,t.jsxs)(o.DropdownMenu,{children:[(0,t.jsx)(o.DropdownMenuTrigger,{asChild:!0,onClick:e=>{e.preventDefault()},children:(0,t.jsx)(d.Button,{type:"text",title:"Actions",className:"space-x-0 h-7 px-1.5 opacity-0 group-hover:opacity-100 !bg-transparent data-[state=open]:opacity-100",icon:(0,t.jsx)(j.MoreHorizontal,{size:14}),children:(0,t.jsx)("div",{className:"sr-only",children:"Actions"})})}),(0,t.jsx)(o.DropdownMenuContent,{className:"w-48",align:"end",children:r})]})]})}e.s(["LogsSidebarItem",()=>b],276708),e.s(["default",0,({item:e})=>{let d=(0,s.useRouter)(),{ref:u}=(0,l.useParams)(),[p,m]=(0,r.useState)(!1),[j,y]=(0,r.useState)(!1),{mutate:v}=(0,i.useContentDeleteMutation)({onSuccess:()=>{m(!1),a.toast.success("Successfully deleted query")},onError:e=>{a.toast.error(`Failed to delete saved query: ${e.message}`)}}),{mutate:N}=(0,n.useContentUpsertMutation)({onSuccess:()=>{y(!1),a.toast.success("Successfully updated query")},onError:e=>{a.toast.error(`Failed to update query: ${e.message}`)}}),S=async()=>{if(!u||"string"!=typeof u)return console.error("Invalid project reference");v({projectRef:u,ids:[e.id]})},C=async({name:t,description:s})=>{if(!u||"string"!=typeof u)return console.error("Invalid project reference");N({projectRef:u,payload:{...e,name:t,description:s||void 0,type:"log_sql",visibility:"user"}})},w=d.query.queryId===e.id;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b,{label:e.name,icon:(0,t.jsx)(g.SqlEditor,{size:"15"}),href:`/project/${u}/logs/explorer?queryId=${encodeURIComponent(e.id)}&q=${encodeURIComponent(e.content.sql)}`,isActive:w,dropdownItems:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.DropdownMenuItem,{onClick:()=>y(!0),children:[(0,t.jsx)(h.Edit,{size:14,className:"mr-2"}),"Edit query"]}),(0,t.jsx)(o.DropdownMenuSeparator,{}),(0,t.jsxs)(o.DropdownMenuItem,{onClick:()=>{m(!0)},children:[(0,t.jsx)(f.Trash,{size:14,className:"mr-2"}),"Delete query"]})]})}),(0,t.jsx)(c.default,{variant:"destructive",visible:p,confirmLabel:"Delete query",title:"Confirm to delete saved query",onCancel:()=>{m(!1)},onConfirm:S,children:(0,t.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to delete ",e.name,"?"]})}),(0,t.jsx)(x,{visible:j,initialValues:{name:e.name,description:e.description},onCancel:()=>{y(!1)},onSubmit:e=>{C(e)}})]})}],421605)},20318,e=>{"use strict";var t=e.i(478902),s=e.i(902858),r=e.i(693241),a=e.i(2579),l=e.i(951138),i=e.i(825713),n=e.i(416050),o=e.i(281050),c=e.i(479232),d=e.i(210419),u=e.i(271226),p=e.i(389959);e.i(128328);var m=e.i(86086),x=e.i(657588),h=e.i(158639),f=e.i(463333),g=e.i(737051),j=e.i(223173),y=e.i(421605),v=e.i(276708),b=e.i(215312),N=e.i(929461),S=e.i(344409),C=e.i(25123),w=e.i(912793),I=e.i(587433),k=e.i(837710),E=e.i(843778),R=e.i(925282),T=e.i(774234),_=e.i(554855),P=e.i(479095),L=e.i(498377),M=e.i(108151),O=e.i(124532);let D=({className:e})=>(0,t.jsx)("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 24 24",height:"15px",width:"15px",className:e,xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M10.9997 2.59833V13.9694H3.90013C3.23055 13.9694 2.83063 13.1846 3.25654 12.6326L10.9997 2.59833ZM12.9997 8.03061V2.33296C12.9997 0.521514 10.7034 -0.291434 9.58194 1.16185L1.67316 11.4108C0.246185 13.26 1.54768 15.9694 3.90013 15.9694H10.9997V21.6671C10.9997 23.4785 13.296 24.2915 14.4175 22.8382L22.3262 12.5892C23.7532 10.74 22.4517 8.03061 20.0993 8.03061H12.9997ZM12.9997 10.0306H20.0993C20.7688 10.0306 21.1688 10.8155 20.7429 11.3674L12.9997 21.4017V10.0306Z"})});function F({children:e,title:s,defaultOpen:r}){return(0,t.jsxs)(R.Collapsible_Shadcn_,{defaultOpen:r,children:[(0,t.jsxs)(_.CollapsibleTrigger_Shadcn_,{className:"flex items-center gap-x-2 px-4 [&[data-state=open]>svg]:!rotate-90 pb-2",children:[(0,t.jsx)(n.ChevronRight,{size:16,className:"text-foreground-light transition-transform duration-200"}),(0,t.jsx)("span",{className:"text-foreground-light font-mono text-sm uppercase",children:s})]}),(0,t.jsx)(T.CollapsibleContent_Shadcn_,{children:e})]})}function q(){let e=(0,u.useRouter)(),{ref:s}=(0,h.useParams)(),r=(0,x.useFlag)("unifiedLogs"),{selectFeaturePreview:a}=(0,f.useFeaturePreviewModal)(),{enable:l}=(0,f.useUnifiedLogsPreview)(),[i,n]=(0,p.useState)(""),{projectAuthAll:R,projectStorageAll:T,realtimeAll:_,logsTemplates:q,logsCollections:A}=(0,w.useIsFeatureEnabled)(["project_storage:all","project_auth:all","realtime:all","logs:templates","logs:collections"]),B=(0,g.useIsETLPrivateAlpha)(),{data:$,isPending:U}=(0,S.useReplicationSourcesQuery)({projectRef:s},{enabled:B,retry:!1,refetchOnMount:!1,refetchOnWindowFocus:!1}),z=B&&($?.sources?.length??0)>0&&!U,{plan:H}=(0,C.useCurrentOrgPlan)(),Q=H?.id==="free",{data:W,isPending:K}=(0,N.useContentQuery)({projectRef:s,type:"log_sql"}),V=[...W?.content??[]].filter(e=>"log_sql"===e.type).sort((e,t)=>e.name.localeCompare(t.name));function G(t){return e.asPath.includes(t)}let Y=[{name:"API Gateway",key:"edge-logs",url:`/project/${s}/logs/edge-logs`,items:[]},{name:"Postgres",key:"postgres-logs",url:`/project/${s}/logs/postgres-logs`,items:[]},{name:"PostgREST",key:"postgrest-logs",url:`/project/${s}/logs/postgrest-logs`,items:[]},m.IS_PLATFORM?{name:Q?"Pooler":"Shared Pooler",key:"pooler-logs",url:`/project/${s}/logs/pooler-logs`,items:[]}:null,!Q&&m.IS_PLATFORM?{name:"Dedicated Pooler",key:"dedicated-pooler-logs",url:`/project/${s}/logs/dedicated-pooler-logs`,items:[]}:null,R?{name:"Auth",key:"auth-logs",url:`/project/${s}/logs/auth-logs`,items:[]}:null,T?{name:"Storage",key:"storage-logs",url:`/project/${s}/logs/storage-logs`,items:[]}:null,_?{name:"Realtime",key:"realtime-logs",url:`/project/${s}/logs/realtime-logs`,items:[]}:null,{name:"Edge Functions",key:"edge-functions-logs",url:`/project/${s}/logs/edge-functions-logs`,items:[]},{name:"Cron",key:"pg_cron",url:`/project/${s}/logs/pgcron-logs`,items:[]},z?{name:"Replication",key:"replication_logs",url:`/project/${s}/logs/replication-logs`,items:[]}:null].filter(e=>null!==e),J=m.IS_PLATFORM?[{name:"Postgres Version Upgrade",key:"pg-upgrade-logs",url:`/project/${s}/logs/pg-upgrade-logs`,items:[]}]:[],Z=Y.filter(e=>e?.name.toLowerCase().includes(i.toLowerCase())),X=J.filter(e=>e?.name.toLowerCase().includes(i.toLowerCase()));return(0,t.jsxs)("div",{className:"pb-4 relative",children:[m.IS_PLATFORM&&!r&&(0,t.jsx)(O.FeaturePreviewSidebarPanel,{className:"mx-4 mt-4",illustration:(0,t.jsx)(I.Badge,{variant:"default",children:"Coming soon"}),title:"New logs",description:"Get early access",actions:(0,t.jsx)(d.default,{href:"https://forms.supabase.com/unified-logs-signup",target:"_blank",children:(0,t.jsx)(k.Button,{type:"default",size:"tiny",children:"Early access"})})}),r&&(0,t.jsx)(O.FeaturePreviewSidebarPanel,{className:"mx-4 mt-4",title:"Introducing unified logs",description:"A unified view across all services with improved filtering and real-time updates.",illustration:(0,t.jsx)(I.Badge,{variant:"success",children:"New"}),actions:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.Button,{size:"tiny",type:"default",onClick:()=>{l(),e.push(`/project/${s}/logs`)},children:"Enable preview"}),(0,t.jsx)(b.ButtonTooltip,{type:"default",className:"px-1.5",icon:(0,t.jsx)(o.CircleHelpIcon,{}),onClick:()=>a("supabase-ui-preview-unified-logs"),tooltip:{content:{side:"bottom",text:"More information"}}})]})}),(0,t.jsxs)("div",{className:(0,E.cn)("flex gap-x-2 items-center sticky top-0 bg-background-200 z-[1] px-4",q?"py-4":"pt-4"),children:[(0,t.jsx)(L.InnerSideBarFilters,{className:"w-full p-0 gap-0",children:(0,t.jsx)(L.InnerSideBarFilterSearchInput,{name:"search-collections",placeholder:"Search collections...","aria-labelledby":"Search collections",value:i,onChange:e=>n(e.target.value)})}),(0,t.jsx)(k.Button,{type:"default",icon:(0,t.jsx)(c.Plus,{className:"text-foreground"}),className:"w-[26px]",onClick:()=>e.push(`/project/${s}/logs/explorer`)})]}),q&&(0,t.jsx)("div",{className:"px-2",children:(0,t.jsx)(L.InnerSideMenuItem,{title:"Templates",isActive:G(`/project/${s}/logs/explorer/templates`),href:`/project/${s}/logs/explorer/templates`,children:"Templates"})}),(0,t.jsx)(P.Separator,{className:"my-4"}),A&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(F,{title:"Collections",defaultOpen:!0,children:Z.map(e=>{let s=G(e?.url??"");return(0,t.jsx)(v.LogsSidebarItem,{isActive:s,href:e?.url??"",icon:(0,t.jsx)(D,{className:"text-foreground-light"}),label:e?.name??""},e?.key??"")})}),J.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.Separator,{className:"my-4"}),(0,t.jsx)(F,{title:"Database operations",defaultOpen:!0,children:X.map(e=>(0,t.jsx)(v.LogsSidebarItem,{isActive:G(e.url),href:e.url,icon:(0,t.jsx)(D,{className:"text-foreground-light"}),label:e.name},e.key))})]}),(0,t.jsx)(P.Separator,{className:"my-4"})]}),(0,t.jsxs)(F,{title:"Queries",defaultOpen:!0,children:[K&&(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)(M.GenericSkeletonLoader,{})}),0===V.length&&(0,t.jsx)(L.InnerSideBarEmptyPanel,{className:"mx-4",title:"No queries created yet",description:"Create and save your queries to use them in the explorer",actions:(0,t.jsx)(k.Button,{asChild:!0,type:"default",children:(0,t.jsx)(d.default,{href:`/project/${s}/logs/explorer`,children:"Create query"})})}),V.map(e=>(0,t.jsx)(y.default,{item:e},e.id))]}),(0,t.jsx)(P.Separator,{className:"my-4"}),(0,t.jsx)(O.FeaturePreviewSidebarPanel,{className:"mx-4 mt-4",title:"Capture your logs",description:"Send logs to your preferred observability or storage platform.",illustration:(0,t.jsx)("div",{className:"flex items-center gap-4",children:j.LOG_DRAIN_TYPES.map(e=>p.default.cloneElement(e.icon,{height:20,width:20}))}),actions:(0,t.jsx)(k.Button,{asChild:!0,type:"default",children:(0,t.jsx)(d.default,{href:`/project/${s}/settings/log-drains`,children:"Go to Log Drains"})})})]})}let A=(0,l.withAuth)(({title:e,children:l})=>{let{isLoading:n,can:o}=(0,a.useAsyncCheckPermissions)(s.PermissionAction.ANALYTICS_READ,"logflare");if(!o){if(n)return(0,t.jsx)(i.ProjectLayout,{isLoading:!0});if(!n&&!o)return(0,t.jsx)(i.ProjectLayout,{children:(0,t.jsx)(r.default,{isFullPage:!0,resourceText:"access your project's logs"})})}return(0,t.jsx)(i.ProjectLayout,{title:e,product:"Logs & Analytics",productMenu:(0,t.jsx)(q,{}),children:l})});e.s(["default",0,A],20318)},238921,e=>{"use strict";var t=e.i(478902),s=e.i(55956),r=e.i(389959),a=e.i(151675),l=e.i(942032),i=e.i(30772),n=e.i(214765),o=e.i(941327),c=e.i(462273),d=e.i(843778);let u="hsl(var(--background-overlay-hover))",p="hsl(var(--brand-default))",m="hsl(var(--destructive-default))",x="hsl(var(--warning-default))";e.s(["LogsBarChart",0,({data:e,onBarClick:h,EmptyState:f,DateTimeFormat:g="MMM D, YYYY, hh:mma",isFullHeight:j=!1,chartConfig:y,hideZeroValues:v=!1})=>{let[b,N]=(0,r.useState)(null);if(0===e.length)return f||null;let S=(0,s.default)(e[0].timestamp).format(g),C=(0,s.default)(e[e?.length-1]?.timestamp).format(g);return(0,t.jsxs)("div",{"data-testid":"logs-bar-chart",className:(0,d.cn)("flex flex-col gap-y-3",j?"h-full":"h-24"),children:[(0,t.jsx)(c.ChartContainer,{className:"h-full",config:y??{error_count:{label:"Errors"},ok_count:{label:"Ok"},warning_count:{label:"Warnings"}},children:(0,t.jsxs)(i.BarChart,{data:e,onMouseMove:e=>{e.activeTooltipIndex!==b&&N(e.activeTooltipIndex)},onMouseLeave:()=>N(null),onClick:e=>{let t=e?.activePayload?.[0]?.payload;h&&h(t,e)},children:[(0,t.jsx)(o.YAxis,{tick:!1,width:0,axisLine:{stroke:u},tickLine:{stroke:u}}),(0,t.jsx)(n.XAxis,{dataKey:"timestamp",interval:e.length-2,tick:!1,axisLine:{stroke:u},tickLine:{stroke:u}}),(0,t.jsx)(c.ChartTooltip,{animationDuration:0,position:{y:16},content:e=>{if(!e.active||!e.payload||0===e.payload.length)return null;let r=v?e.payload.filter(e=>0!==Number(e.value)):e.payload;return 0===r.length?null:(0,t.jsx)(c.ChartTooltipContent,{active:e.active,payload:r,label:e.label,className:"text-foreground-light -mt-5 !transition-none",labelFormatter:e=>(0,s.default)(e).format(g)})}}),(0,t.jsx)(a.Bar,{dataKey:"error_count",fill:m,maxBarSize:24,stackId:"stack",children:e?.map((e,s)=>(0,t.jsx)(l.Cell,{className:"cursor-pointer transition-colors",fill:b===s||null===b?m:"hsl(var(--destructive-500))"},`error-${s}`))}),(0,t.jsx)(a.Bar,{dataKey:"warning_count",fill:x,maxBarSize:24,stackId:"stack",children:e?.map((e,s)=>(0,t.jsx)(l.Cell,{className:"cursor-pointer transition-colors",fill:b===s||null===b?x:"hsl(var(--warning-500))"},`warning-${s}`))}),(0,t.jsx)(a.Bar,{dataKey:"ok_count",fill:p,maxBarSize:24,stackId:"stack",children:e?.map((e,s)=>(0,t.jsx)(l.Cell,{className:"cursor-pointer transition-colors",fill:b===s||null===b?p:"hsl(var(--brand-500))"},`success-${s}`))})]})}),e&&(0,t.jsxs)("div",{className:"text-foreground-lighter -mt-10 flex items-center justify-between text-[10px] font-mono",children:[(0,t.jsx)("span",{children:S}),(0,t.jsx)("span",{children:C})]})]})}])},456598,e=>{"use strict";var t=e.i(460988),s=e.i(389959);e.s(["default",0,(e,r)=>(0,s.useMemo)(()=>0!==e.length&&(0,t.isUnixMicro)(e[0][r])?e?.map(e=>(e[r]=(0,t.unixMicroToIsoTimestamp)(e[r]),e)):e,[JSON.stringify(e)])])},281192,e=>{"use strict";var t=e.i(533488);let s={},r=e=>(0,t.createParser)({parse:t=>t??e,serialize:e=>e||""});function a(){let[e,a]=(0,t.useQueryState)("s",r("")),[l,i]=(0,t.useQueryState)("its",r("")),[n,o]=(0,t.useQueryState)("ite",r("")),[c,d]=(0,t.useQueryState)("log",r("")),[u,p]=(0,t.useQueryState)("f",(0,t.createParser)({parse:e=>{if(!e)return s;try{return JSON.parse(e)}catch(e){return s}},serialize:e=>{if(!e)return"";try{return JSON.stringify(e)}catch(e){return""}}})),m=u||s,x=e=>{a(e||"")},h=e=>{p(e||s)};return{search:e||"",timestampStart:l||"",timestampEnd:n||"",selectedLogId:c||null,filters:m,setSearch:x,setTimeRange:(e,t)=>{i(e||""),o(t||"")},setSelectedLogId:e=>{d(e||"")},setFilters:h,updateFilter:(e,t)=>{h({...m,[e]:t})},reset:()=>{x(""),i(""),o(""),d(""),p(s)}}}e.s(["useLogsUrlState",()=>a])},450049,e=>{"use strict";var t=e.i(867088),s=e.i(242882),r=e.i(993394),a=e.i(460988),l=e.i(234745),i=e.i(55956),n=e.i(389959),o=e.i(520124),c=e.i(281192),d=e.i(456598);e.s(["default",0,function({projectRef:e,table:u,filterOverride:p,limit:m}){let x=(0,r.getDefaultHelper)(r.PREVIEWER_DATEPICKER_HELPERS),[h,f]=(0,n.useState)(new Date().toISOString()),{timestampStart:g,timestampEnd:j,filters:y,search:v}=(0,c.useLogsUrlState)(),b=(0,n.useMemo)(()=>g||x.calcFrom(),[g,x]),N=(0,n.useMemo)(()=>j||x.calcTo(),[j,x]),S=(0,n.useMemo)(()=>({...y,...p,...v?{search_query:v}:{}}),[JSON.stringify(y),JSON.stringify(p),v]),C=(0,n.useMemo)(()=>({iso_timestamp_start:b,iso_timestamp_end:N,sql:(0,a.genDefaultQuery)(u,S,m)}),[b,N,u,S,m]),w=(0,n.useMemo)(()=>["projects",e,"logs",C],[e,C]),{data:I,isSuccess:k,isLoading:E,isRefetching:R,error:T,fetchNextPage:_,isFetchingNextPage:P,refetch:L}=(0,t.useInfiniteQuery)({queryKey:w,queryFn:async({signal:t,pageParam:s})=>{let{data:r,error:a}=await (0,l.get)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:e},query:{...C,iso_timestamp_end:s||C.iso_timestamp_end}},signal:t});if(a)throw a;return r},refetchOnWindowFocus:!1,initialPageParam:void 0,getNextPageParam(e){if((e.result?.length??0)===0)return;let t=e.result.length,{timestamp:s}=e.result[t-1];return i.default.utc(Number(s/1e3)).toISOString()}}),{logData:M,error:O,oldestTimestamp:D}=(0,n.useMemo)(()=>{let e=[],t=T?T.message:null;I?.pages?.forEach(s=>{s?.result&&(e=[...e,...s.result]),!t&&s?.error&&(t=s.error)});let s=e.length>0?e[e.length-1]?.timestamp:void 0;return{logData:e,error:t,oldestTimestamp:s}},[I?.pages]),F=(0,n.useMemo)(()=>(0,a.genCountQuery)(u,S),[u,S]),q=(0,n.useMemo)(()=>["projects",e,"logs-count",{projectRef:e,sql:F,iso_timestamp_start:h,iso_timestamp_end:N,table:u,mergedFilters:S}],[e,F,h,N,u,S]),{data:A}=(0,s.useQuery)({queryKey:q,queryFn:async({signal:t})=>{let{data:s,error:r}=await (0,l.get)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:e},query:{sql:F,iso_timestamp_start:h,iso_timestamp_end:N}},signal:t});if(r)throw r;return s},refetchOnWindowFocus:!1,refetchInterval:6e4,enabled:!!(!O&&I&&I?.pages?.length>0)}),B=A?.result?.[0]?.count??0,$=(0,n.useMemo)(()=>(0,a.genChartQuery)(u,C,S),[u,C,S]),U=(0,n.useMemo)(()=>["projects",e,"logs-chart",{projectRef:e,sql:$,iso_timestamp_start:b,iso_timestamp_end:N}],[e,$,b,N]),{data:z,refetch:H}=(0,s.useQuery)({queryKey:U,queryFn:async({signal:t})=>{let{data:s,error:r}=await (0,l.get)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:e},query:{iso_timestamp_start:b,iso_timestamp_end:N,sql:$}},signal:t});if(r)throw r;return s},refetchOnWindowFocus:!1}),Q=(0,n.useCallback)(async()=>{f(new Date().toISOString()),H(),L()},[L,H]),W=(0,d.default)(z?.result??[],"timestamp"),{data:K,error:V}=(0,o.useFillTimeseriesSorted)({data:W,timestampKey:"timestamp",valueKey:"count",defaultValue:0,startDate:b,endDate:N??new Date().toISOString()});return{newCount:B,logData:M,isSuccess:k,isLoading:E||R,isLoadingOlder:P,error:O||V,filters:S,params:C,oldestTimestamp:D?String(D):void 0,eventChartData:K,refresh:Q,loadOlder:()=>_()}}])},555979,e=>{"use strict";var t=e.i(478902),s=e.i(55956);let r=(0,e.i(388019).default)("Rewind",[["polygon",{points:"11 19 2 12 11 5 11 19",key:"14yba5"}],["polygon",{points:"22 19 13 12 22 5 22 19",key:"1pi1cj"}]]);var a=e.i(271226),l=e.i(389959);e.i(128328);var i=e.i(158639),n=e.i(543851),o=e.i(890054),c=e.i(61187),d=e.i(366652),u=e.i(454931),p=e.i(975924),m=e.i(210419),x=e.i(215312),h=e.i(282492),f=e.i(106579),g=e.i(330287),j=e.i(10429),y=e.i(837710),v=e.i(171997),b=e.i(613580),N=e.i(843778),S=e.i(748356),C=e.i(993394),w=e.i(237002),I=e.i(737018),k=e.i(767073);let E=({options:e,filters:s,onFiltersChange:r,buttonClassName:a,align:i="start",isLoading:n=!1})=>{let o=e.key,[c,d]=(0,l.useState)(!1),[u,p]=(0,l.useState)(s),m=()=>d(!c),x=(0,l.useMemo)(()=>{let e=u[o];return!!("object"==typeof e&&Object.values(e).some(Boolean))},[u,o]);return(0,l.useEffect)(()=>{c||p(s)},[c,s]),(0,t.jsxs)(k.Popover,{open:c,onOpenChange:m,children:[(0,t.jsx)(k.PopoverTrigger,{asChild:!0,children:(0,t.jsx)(y.Button,{type:x?"default":"outline",onClick:m,className:(0,N.cn)("min-w-20 border-dashed",{"border-solid":x},a),children:(0,t.jsx)("span",{children:e.label})})}),(0,t.jsx)(k.PopoverContent,{align:i,className:"p-0 w-60",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),r(u),d(!1)},children:[e.options.map((s,r)=>(0,t.jsxs)(I.Label,{htmlFor:`${e.key}.${s.key}`,className:"flex items-start hover:bg-overlay-hover overflow-hidden p-2 m-1 rounded-sm gap-3 transition-all duration-150 ease-in-out",children:[(0,t.jsx)("div",{children:(0,t.jsx)(w.Checkbox,{value:e.key,id:`${e.key}.${s.key}`,checked:!!u?.[e.key]?.[s.key],onCheckedChange:t=>{p({...u,[e.key]:{...u[e.key],[s.key]:t}})}})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:s.label}),(0,t.jsx)("span",{className:"text-sm text-foreground-lighter",children:s.description})]})]},s.key)),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-default p-2",children:[(0,t.jsx)(y.Button,{size:"tiny",type:"default",onClick:()=>{p({[o]:{}}),r({...s,[o]:{}})},htmlType:"button",children:"Clear"}),(0,t.jsx)(y.Button,{loading:n,type:"primary",htmlType:"submit",children:"Apply"})]})]})})]})},R=({isLoading:e,newCount:s,onRefresh:r,onSearch:w=()=>{},defaultSearchValue:I="",onExploreClick:k,queryUrl:R,condensedLayout:T,isShowingEventChart:_,onToggleEventChart:P,csvData:L,onFiltersChange:M,filters:O,table:D,onSelectedDatabaseChange:F,className:q,selectedDatePickerValue:A,setSelectedDatePickerValue:B})=>{let $=(0,a.useRouter)(),{ref:U}=(0,i.useParams)(),[z,H]=(0,l.useState)(""),Q=$.pathname.split("/").pop(),{data:W}=(0,g.useLoadBalancersQuery)({projectRef:U}),K=j.IS_PLATFORM&&C.LOG_ROUTES_WITH_REPLICA_SUPPORT.includes($.pathname),V=z!==I,G=e=>w("search-input-change",{query:e});return(0,l.useEffect)(()=>{z!==I&&H(I)},[I]),(0,t.jsxs)("div",{className:(0,N.cn)("flex w-full items-center justify-between overflow-x-scroll no-scrollbar",T?" p-3":"",q),children:[(0,t.jsxs)("div",{className:"flex flex-row items-center gap-x-2 mr-2",children:[(0,t.jsx)("form",{id:"log-panel-search",onSubmit:e=>{e.preventDefault(),G(z)},children:(0,t.jsx)(v.Input,{className:"w-60",size:"tiny",placeholder:"Search events",onChange:e=>H(e.target.value),onBlur:e=>{H(e.target.value),G(e.target.value)},icon:(0,t.jsx)("div",{className:"text-foreground-lighter",children:(0,t.jsx)(d.Search,{size:14})}),value:z,actions:(0,t.jsxs)("div",{className:"flex items-center gap-x-1 mr-0.5",children:[V&&(0,t.jsx)(x.ButtonTooltip,{icon:(0,t.jsx)("span",{children:"â†²"}),type:"text",className:"px-1 h-[20px]",onClick:()=>G(z),tooltip:{content:{side:"bottom",text:"Search for events"}}}),z.length>0&&(0,t.jsx)(x.ButtonTooltip,{icon:(0,t.jsx)(p.X,{}),type:"text",className:"p-[1px] h-[20px]",onClick:()=>G(""),tooltip:{content:{side:"bottom",text:"Clear search"}}})]})})}),(0,t.jsxs)(b.Tooltip,{children:[(0,t.jsx)(b.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(y.Button,{title:"refresh",type:"default",className:"px-1.5",icon:(0,t.jsxs)("div",{className:"relative",children:[s>0&&(0,t.jsxs)("div",{className:"absolute -top-3 right-3 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"absolute z-20",children:(0,t.jsx)("p",{style:{fontSize:"0.6rem"},className:"text-white",children:s>1e3?`${Math.floor(s/100)/10}K`:s})}),(0,t.jsx)("div",{className:"h-4 w-4 animate-ping rounded-full bg-green-800 opacity-60"}),(0,t.jsx)("div",{className:"z-60 absolute top-0 right-0 h-full w-full rounded-full bg-green-900 opacity-80"})]}),(0,t.jsx)(c.RefreshCw,{})]}),loading:e,disabled:e,onClick:r})}),(0,t.jsx)(b.TooltipContent,{side:"bottom",className:"text-xs",children:"Refresh logs"})]}),(0,t.jsx)(S.LogsDatePicker,{helpers:C.PREVIEWER_DATEPICKER_HELPERS,onSubmit:e=>{w("datepicker-change",{to:e.to,from:e.from}),B(e)},value:A}),void 0!==C.FILTER_OPTIONS[D]&&(0,t.jsx)("div",{className:"flex items-center",children:C.FILTER_OPTIONS[D]&&Object.values(C.FILTER_OPTIONS[D]).map((e,s)=>{let r=[];Object.values(C.FILTER_OPTIONS[D]).length>=2&&(0===s?r.push("rounded-tr-none rounded-br-none"):s===Object.values(C.FILTER_OPTIONS[D]).length-1?r.push("rounded-tl-none rounded-bl-none"):r.push("rounded-none"));let a=Object.values(C.FILTER_OPTIONS[D]).length-1;return(0,t.jsx)(E,{buttonClassName:r.join(" "),options:e,onFiltersChange:M,filters:O,align:0===s?"start":s===a?"end":"center"},`${e.key}-filter`)})}),(0,t.jsx)("div",{className:"flex items-center space-x-2",children:(0,t.jsx)(y.Button,{type:"default",onClick:()=>P(),icon:_?(0,t.jsx)(n.Eye,{}):(0,t.jsx)(o.EyeOff,{}),children:"Chart"})}),!!L&&(0,t.jsx)(f.DownloadResultsButton,{iconOnly:!0,type:"default",align:"center",results:L??[],fileName:`supabase-${Q}-${U}.csv`})]}),K?(0,t.jsxs)("div",{className:"flex items-center justify-center gap-x-2",children:[(0,t.jsxs)(b.Tooltip,{children:[(0,t.jsx)(b.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(y.Button,{asChild:!0,className:"px-1.5",type:"default",icon:(0,t.jsx)(u.Terminal,{}),children:(0,t.jsx)(m.default,{href:R})})}),(0,t.jsx)(b.TooltipContent,{side:"bottom",className:"text-xs",children:"Open query in Logs Explorer"})]}),(0,t.jsx)(h.DatabaseSelector,{onSelectId:F,additionalOptions:D===C.LogsTableName.EDGE&&(W??[]).length>0?[{id:`${U}-all`,name:"API Load Balancer"}]:[]})]}):(0,t.jsx)(y.Button,{asChild:!0,type:"default",onClick:k,children:(0,t.jsx)(m.default,{href:R,children:"Explore via query"})})]})};var T=e.i(744244),_=e.i(427432),P=e.i(150671),L=e.i(450049),M=e.i(281192),O=e.i(783804),D=e.i(242882),F=e.i(460988),q=e.i(234745),A=e.i(912793);let B=function({projectRef:e,id:t,queryType:s,paramsToMerge:r}){let a=s?C.LOGS_TABLES[s]:void 0,l=t&&a?(0,F.genSingleLogQuery)(a,t):"",i={...r,sql:l},n=!!(t&&a),{logsMetadata:o}=(0,A.useIsFeatureEnabled)(["logs:metadata"]),{data:c,error:d,isPending:u,isRefetching:p,refetch:m}=(0,D.useQuery)({queryKey:["projects",e,"single-log",t,s],queryFn:async({signal:t})=>{let{data:s,error:r}=await (0,q.get)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:e},query:i},signal:t});if(r)throw r;return s},enabled:n,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}),x=d?d.message:null,h=c?.result?c.result[0]:void 0;return{data:h?{...h,metadata:o?h?.metadata:void 0}:void 0,isLoading:n&&u||p,error:x,refresh:()=>m()}};var $=e.i(280590),U=e.i(265735),z=e.i(169240),H=e.i(189329),Q=e.i(238921),W=e.i(651068),K=e.i(979377);e.s(["LogsPreviewer",0,({projectRef:e,queryType:n,filterOverride:o,condensedLayout:c=!1,tableName:d,children:u,EmptyState:p,filterPanelClassName:m})=>{let x=(0,a.useRouter)(),{db:h}=(0,i.useParams)(),{data:f}=(0,U.useSelectedOrganizationQuery)(),g=(0,H.useDatabaseSelectorStateSnapshot)(),[j,v]=(0,l.useState)(!0),[b,N]=(0,l.useState)(function(){let e=x.query.iso_timestamp_start,t=x.query.iso_timestamp_end;if(e&&t)return{to:t,from:e,text:`${(0,s.default)(e).format("DD MMM, HH:mm")} - ${(0,s.default)(t).format("DD MMM, HH:mm")}`,isHelper:!1};let r=C.PREVIEWER_DATEPICKER_HELPERS.find(e=>e.default);return{to:r.calcTo(),from:r.calcFrom(),text:r.text,isHelper:!0}}()),{search:S,setSearch:w,timestampStart:I,timestampEnd:k,setTimeRange:E,filters:D,setFilters:q}=(0,M.useLogsUrlState)();(0,l.useEffect)(()=>{I&&k&&N({to:k,from:I,text:`${(0,s.default)(I).format("DD MMM, HH:mm")} - ${(0,s.default)(k).format("DD MMM, HH:mm")}`,isHelper:!1})},[I,k]);let[A,V]=(0,O.useSelectedLog)(),{data:G,isSuccess:Y}=(0,P.useReadReplicasQuery)({projectRef:e}),J=d||C.LOGS_TABLES[n],{error:Z,logData:X,params:ee,newCount:et,isLoading:es,eventChartData:er,isLoadingOlder:ea,loadOlder:el,refresh:ei}=(0,L.default)({projectRef:e,table:J,filterOverride:o}),{data:en,isLoading:eo,error:ec}=B({projectRef:e,id:A??void 0,queryType:n,paramsToMerge:ee}),{showUpgradePrompt:ed,setShowUpgradePrompt:eu}=(0,z.useUpgradePrompt)(I),{getEntitlementNumericValue:ep}=(0,$.useCheckEntitlements)("log.retention_days"),em=ep(),ex=async(e,{query:t,to:s,from:r})=>{"search-input-change"===e?(w(t||""),V(null)):"event-chart-bar-click"===e?E(r||"",s||""):"datepicker-change"===e&&((0,F.maybeShowUpgradePromptIfNotEntitled)(r||"",em)?eu(!ed):E(r||"",s||""))};(0,l.useEffect)(()=>{I&&(0,F.maybeShowUpgradePromptIfNotEntitled)(I,em)&&eu(!ed)},[I,f]),(0,l.useEffect)(()=>{void 0!==h?void 0!==G?.find(e=>e.identifier===h)&&g.setSelectedDatabaseId(h):void 0!==g.selectedDatabaseId&&g.selectedDatabaseId!==e&&(C.LOG_ROUTES_WITH_REPLICA_SUPPORT.includes(x.pathname)?x.push({pathname:x.pathname,query:{...x.query,db:g.selectedDatabaseId}}):g.setSelectedDatabaseId(e))},[h,Y]);let eh={className:m,csvData:X,isLoading:es,newCount:et,onRefresh:()=>{if(b.isHelper){let e=C.PREVIEWER_DATEPICKER_HELPERS.find(e=>e.text===b.text);e&&E(e.calcFrom(),k)}ei()},onSearch:ex,defaultSearchValue:S,defaultToValue:k,defaultFromValue:I,queryUrl:`/project/${e}/logs/explorer?q=${encodeURIComponent(ee.sql||"")}&its=${encodeURIComponent(I)}&ite=${encodeURIComponent(k)}`,onSelectTemplate:e=>{q({...D,search_query:e.searchString})},filters:D,onFiltersChange:q,table:J,condensedLayout:c,isShowingEventChart:j,onToggleEventChart:()=>v(!j),onSelectedDatabaseChange:t=>{q({...D,database:t!==e?t:void 0});let{db:s,...r}=x.query;x.push({pathname:x.pathname,query:t!==e?{...x.query,db:t}:r})},selectedDatePickerValue:b,setSelectedDatePickerValue:N};return(0,t.jsxs)("div",{className:"flex-1 flex flex-col h-full",children:[(0,t.jsx)(R,{...eh}),u,(0,t.jsx)("div",{className:"transition-all duration-500 "+(j&&X.length>0?"mb-2 mt-1 opacity-100":"h-0 opacity-0"),children:(0,t.jsx)("div",{className:c?"px-3":"",children:j&&(0,t.jsx)(Q.LogsBarChart,{data:er,onBarClick:e=>{var t;let r,a,l,i;if(!e?.timestamp)return;let{start:n,end:o}=(t=e.timestamp,l=(0,s.default)(t).toISOString(),(i=(k?(0,s.default)(k):(0,s.default)()).diff((0,s.default)(I),"hour",!0))>=12?(r=.5,a="hour"):i>=1?(r=2.5,a="minute"):i>=1/30?(r=1,a="minute"):(r=7.5,a="second"),{start:(0,s.default)(l).subtract(r,a).toISOString(),end:(0,s.default)(l).add(r,a).toISOString()});ex("event-chart-bar-click",{query:D.search_query?.toString(),to:o,from:n})},EmptyState:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-[67px]",children:[(0,t.jsx)("p",{className:"text-foreground-light text-xs",children:"No data"}),(0,t.jsx)("p",{className:"text-foreground-lighter text-xs",children:"It may take up to 24 hours for data to refresh"})]})})})}),(0,t.jsxs)("div",{className:"relative flex flex-col flex-grow flex-1 overflow-auto",children:[(0,t.jsx)(_.default,{active:es}),(0,t.jsx)(T.default,{active:es,children:(0,t.jsx)(W.default,{projectRef:e,isLoading:es,data:X,queryType:n,isHistogramShowing:j,onHistogramToggle:()=>v(!j),error:Z,EmptyState:p,onSelectedLogChange:e=>V(e?.id??null),selectedLog:en,isSelectedLogLoading:eo,selectedLogError:ec??void 0})})]}),!Z&&X.length>0&&(0,t.jsxs)("div",{className:"border-t flex flex-row items-center gap-3 p-2",children:[(0,t.jsx)(y.Button,{onClick:el,icon:(0,t.jsx)(r,{}),type:"default",loading:ea,disabled:ea,children:"Load older"}),(0,t.jsxs)("div",{className:"text-sm text-foreground-lighter",children:["Showing ",(0,t.jsx)("span",{className:"font-mono",children:X.length})," results"]}),(0,t.jsx)("div",{className:"flex flex-row justify-end mt-2",children:(0,t.jsx)(K.default,{show:ed,setShowUpgradePrompt:eu})})]})]})}],555979)}]);

//# debugId=4d3b1219-70bf-d34f-ca65-80ea78b03692
//# sourceMappingURL=ad07dbcdaeb87271.js.map