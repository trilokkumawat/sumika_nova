;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="066ea2f4-3171-dd86-7343-a19297a79cdf")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,298625,e=>{"use strict";var a=e.i(242882),t=e.i(714403),s=e.i(584258);async function n({projectRef:e,connectionString:a},s){let n=`
    select
      s.oid as "id",
      w.fdwname as "name",
      s.srvname as "server_name",
      s.srvoptions as "server_options",
      c.proname as "handler",
      (
        select jsonb_agg(
          jsonb_build_object(
            'id', c.oid::bigint,
            'schema', relnamespace::regnamespace::text,
            'name', c.relname,
            'columns', (
              select jsonb_agg(
                jsonb_build_object(
                  'name', a.attname,
                  'type', pg_catalog.format_type(a.atttypid, a.atttypmod)
                )
              )
              from pg_catalog.pg_attribute a
              where a.attrelid = c.oid and a.attnum > 0 and not a.attisdropped
            ),
            'options', t.ftoptions
          )
        )
        from pg_catalog.pg_class c
        join pg_catalog.pg_foreign_table t on c.oid = t.ftrelid
        where c.oid = any (select t.ftrelid from pg_catalog.pg_foreign_table t where t.ftserver = s.oid)
      ) as "tables"
    from pg_catalog.pg_foreign_server s
    join pg_catalog.pg_foreign_data_wrapper w on s.srvfdw = w.oid
    join pg_catalog.pg_proc c on w.fdwhandler = c.oid;
  `,{result:i}=await (0,t.executeSql)({projectRef:e,connectionString:a,sql:n,queryKey:["fdws"]},s);return i}e.s(["getFDWs",()=>n,"useFDWsQuery",0,({projectRef:e,connectionString:t},{enabled:i=!0,...r}={})=>(0,a.useQuery)({queryKey:s.fdwKeys.list(e),queryFn:({signal:a})=>n({projectRef:e,connectionString:t},a),enabled:i&&void 0!==e,...r})])},450972,e=>{"use strict";var a=e.i(248593),t=e.i(242882),s=e.i(234745),n=e.i(635494);e.i(10429);var i=e.i(837508),r=e.i(667286);async function l({projectRef:e,connectionString:t},n,i){if(!e)throw Error("projectRef is required");let r=new Headers(i);t&&r.set("x-connection-encrypted",t);let{data:l,error:c}=await (0,s.get)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":t,"x-pg-application-name":a.DEFAULT_PLATFORM_APPLICATION_NAME},path:{ref:e}},headers:r,signal:n});return c&&(0,s.handleError)(c),l}e.s(["useDatabaseExtensionsQuery",0,({projectRef:e,connectionString:a},{enabled:s=!0,...c}={})=>{let{data:o}=(0,n.useSelectedProjectQuery)(),d=o?.status===i.PROJECT_STATUS.ACTIVE_HEALTHY;return(0,t.useQuery)({queryKey:r.databaseExtensionsKeys.list(e),queryFn:({signal:t})=>l({projectRef:e,connectionString:a},t),enabled:s&&void 0!==e&&d,...c})}])},12214,e=>{"use strict";var a=e.i(615515);let t=e=>Object.fromEntries(e.map(e=>e.split("=")));function s(e,a){if("wasm_fdw_handler"===e.handlerName){let s=t(a?.server_options??[]);return e.server.options.find(e=>"fdw_package_name"===e.name)?.defaultValue===s.fdw_package_name}return e.handlerName===a?.handler}function n(e){return a.WRAPPERS.find(a=>s(a,e))}e.s(["convertKVStringArrayToJson",0,t,"formatWrapperTables",0,(e,t)=>(e?.tables??[]).map(s=>{let n=0,i=Object.fromEntries(s.options.map(e=>e.split("=")));switch(e.handler){case a.WRAPPER_HANDLERS.STRIPE:n=t?.tables.findIndex(e=>e.options.find(e=>"object"===e.name)?.defaultValue===i.object)??0;break;case a.WRAPPER_HANDLERS.FIREBASE:n="auth/users"===i.object?t?.tables.findIndex(e=>e.options.find(e=>"auth/users"===e.defaultValue))??0:t?.tables.findIndex(e=>"Firestore Collection"===e.label)??0;case a.WRAPPER_HANDLERS.S3:case a.WRAPPER_HANDLERS.AIRTABLE:case a.WRAPPER_HANDLERS.LOGFLARE:case a.WRAPPER_HANDLERS.BIG_QUERY:case a.WRAPPER_HANDLERS.CLICK_HOUSE:}return{...i,index:n,id:s.id,columns:s.columns,is_new_schema:!1,schema:s.schema,schema_name:s.schema,table_name:s.name}}),"getWrapperMetaForWrapper",()=>n,"makeValidateRequired",0,e=>{let a=new Set(e.filter(e=>e.required).map(e=>e.name)),t=new Set(Array.from(a).filter(e=>e.includes("."))),s=Array.from(t);return e=>Object.fromEntries(Object.entries(e).flatMap(([e,a])=>Array.isArray(a)?[[e,a],...a.map((a,t)=>[`${e}.${t}`,a])]:[[e,a]]).filter(([e,n])=>{let[i,r]=e.split(".");if(void 0!==r&&a.has(i)&&Object.keys(n).some(e=>t.has(`${i}.${e}`))){let e=s.find(e=>e.startsWith(`${i}.`));return!!e&&!n[e.split(".")[1]]}return a.has(i)&&(Array.isArray(n)?n.length<1:!n)}).map(([e])=>"table_name"===e?[e,"Please provide a name for your table"]:"columns"===e?[e,"Please select at least one column"]:[e,"This field is required"]))},"wrapperMetaComparator",()=>s])},584258,e=>{"use strict";e.s(["fdwKeys",0,{list:e=>["projects",e,"fdws"]}])},3259,100387,e=>{"use strict";var a=e.i(478902),t=e.i(153545),s=e.i(933505);e.s(["ChevronRightIcon",()=>s.default],100387);var s=s,n=e.i(389959),i=e.i(843778);let r=n.forwardRef(({...e},t)=>(0,a.jsx)("nav",{ref:t,"aria-label":"breadcrumb",...e}));r.displayName="Breadcrumb";let l=n.forwardRef(({className:e,...t},s)=>(0,a.jsx)("ol",{ref:s,className:(0,i.cn)("flex flex-wrap items-center gap-0.5 break-words text-sm text-muted-foreground sm:gap-1.5",e),...t}));l.displayName="BreadcrumbList";let c=n.forwardRef(({className:e,...t},s)=>(0,a.jsx)("li",{ref:s,className:(0,i.cn)("inline-flex text-foreground-lighter items-center gap-1.5 leading-5",e),...t}));c.displayName="BreadcrumbItem";let o=n.forwardRef(({asChild:e,className:s,...n},r)=>{let l=e?t.Slot:"a";return(0,a.jsx)(l,{ref:r,className:(0,i.cn)("transition-colors underline lg:no-underline hover:text-foreground",s),...n})});o.displayName="BreadcrumbLink";let d=n.forwardRef(({className:e,...t},s)=>(0,a.jsx)("span",{ref:s,role:"link","aria-disabled":"true","aria-current":"page",className:(0,i.cn)("no-underline text-foreground",e),...t}));d.displayName="BreadcrumbPage";let u=({children:e,className:t,...n})=>(0,a.jsx)("li",{role:"presentation","aria-hidden":"true",className:(0,i.cn)("[&>svg]:size-3.5 text-foreground-muted",t),...n,children:e??(0,a.jsx)(s.default,{})});u.displayName="BreadcrumbSeparator";let m=({className:e,...t})=>(0,a.jsxs)("span",{className:(0,i.cn)("flex h-4 w-4 items-center justify-center",e),...t,children:[(0,a.jsx)("svg",{role:"presentation","aria-hidden":"true",width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M3.625 7.5C3.625 8.12132 3.12132 8.625 2.5 8.625C1.87868 8.625 1.375 8.12132 1.375 7.5C1.375 6.87868 1.87868 6.375 2.5 6.375C3.12132 6.375 3.625 6.87868 3.625 7.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM12.5 8.625C13.1213 8.625 13.625 8.12132 13.625 7.5C13.625 6.87868 13.1213 6.375 12.5 6.375C11.8787 6.375 11.375 6.87868 11.375 7.5C11.375 8.12132 11.8787 8.625 12.5 8.625Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}),(0,a.jsx)("span",{className:"sr-only",children:"More"})]});m.displayName="BreadcrumbEllipsis",e.s(["Breadcrumb",()=>r,"BreadcrumbEllipsis",()=>m,"BreadcrumbItem",()=>c,"BreadcrumbLink",()=>o,"BreadcrumbList",()=>l,"BreadcrumbPage",()=>d,"BreadcrumbSeparator",()=>u],3259)},744061,418638,e=>{"use strict";var a=e.i(478902),t=e.i(938933),s=e.i(843778);function n({children:e,className:t,tag:s="div",style:n}){let i=`${s}`;return(0,a.jsx)(i,{style:n,children:e})}n.Title=function({className:e,level:t=1,children:s,style:n}){let i=`h${t}`;return(0,a.jsx)(i,{style:n,children:s})},n.Text=function({className:e,children:t,style:s,type:n,disabled:i,mark:r,code:l,keyboard:c,underline:o,strikethrough:d,strong:u,small:m}){return l?(0,a.jsx)("code",{style:s,children:t}):r?(0,a.jsx)("mark",{style:s,children:t}):c?(0,a.jsx)("kbd",{style:s,children:t}):u?(0,a.jsx)("strong",{style:s,children:t}):(0,a.jsx)("span",{style:s,children:t})},n.Link=function({children:e,target:t="_blank",href:s,className:n,onClick:i,style:r}){return(0,a.jsx)("a",{onClick:i,href:s,target:t,rel:"noopener noreferrer",style:r,children:e})},e.s(["default",0,n],418638);var i=e.i(389959);let r=(0,i.createContext)({type:"text"}),l=e=>{let{type:t}=e;return(0,a.jsx)(r.Provider,{value:{type:t},children:e.children})},c=()=>{let e=(0,i.useContext)(r);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function o({children:e,className:t,ulClassName:s,style:n,type:i="text"}){return(0,a.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:t,style:n,children:(0,a.jsx)(l,{type:i,children:(0,a.jsx)("ul",{className:s,children:e})})})}o.Item=function({children:e,icon:n,active:i,rounded:r,onClick:l,doNotCloseOverlay:o=!1,showActiveBar:d=!1,style:u}){let m=(0,t.default)("menu"),{type:h}=c(),p=[m.item.base];p.push(m.item.variants[h].base),i?p.push(m.item.variants[h].active):p.push(m.item.variants[h].normal);let x=[m.item.content.base];i?x.push(m.item.content.active):x.push(m.item.content.normal);let f=[m.item.icon.base];return i?f.push(m.item.icon.active):f.push(m.item.icon.normal),(0,a.jsxs)("li",{role:"menuitem",className:(0,s.cn)("outline-none",p),style:u,onClick:l,"aria-current":i?"page":void 0,children:[n&&(0,a.jsx)("div",{className:`${f.join(" ")} min-w-fit`,children:n}),(0,a.jsx)("span",{className:x.join(" "),children:e})]})},o.Group=function({children:e,icon:s,title:n}){let i=(0,t.default)("menu"),{type:r}=c();return(0,a.jsxs)("div",{className:[i.group.base,i.group.variants[r]].join(" "),children:[s&&(0,a.jsx)("span",{className:i.group.icon,children:s}),(0,a.jsx)("span",{className:i.group.content,children:n}),e]})},o.Misc=function({children:e}){return(0,a.jsx)("div",{children:(0,a.jsx)(n.Text,{children:(0,a.jsx)("span",{children:e})})})},e.s(["default",0,o],744061)},862326,e=>{"use strict";var a=e.i(744061);e.s(["Menu",()=>a.default])},388147,799793,e=>{"use strict";var a=e.i(478902),t=e.i(587433),s=e.i(862326),n=e.i(210419),i=e.i(837710);let r=({item:e,isActive:r,target:l="_self",hoverText:c="",onClick:o})=>{let{name:d="",url:u="",icon:m,rightIcon:h,isExternal:p,label:x,disabled:f}=e,g=(0,a.jsx)(s.Menu.Item,{icon:m,active:r,onClick:o,children:(0,a.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 min-w-0 flex-1",title:c||("string"==typeof d?d:""),children:[(0,a.jsx)("span",{className:"truncate flex-1 min-w-0",children:d}),void 0!==x&&(0,a.jsx)(t.Badge,{className:"flex-shrink-0",variant:"new"===x.toLowerCase()?"success":"warning",children:x})]}),h&&(0,a.jsx)("div",{children:h})]})});return f?(0,a.jsx)("div",{className:"opacity-50 pointer-events-none",children:g}):u?p?(0,a.jsx)(i.Button,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:m,children:(0,a.jsx)(n.default,{href:u,target:"_blank",rel:"noreferrer",children:d})}):(0,a.jsx)(n.default,{href:u,className:"block",target:l,children:g}):g};e.s(["ProductMenuItem",0,r],799793),e.s(["ProductMenu",0,({page:e,menu:n})=>(0,a.jsx)("div",{className:"flex flex-col space-y-8",children:(0,a.jsx)(s.Menu,{type:"pills",children:n.map((i,l)=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"my-6 space-y-8",children:(0,a.jsxs)("div",{className:"mx-3",children:[(0,a.jsx)(s.Menu.Group,{title:i.title?(0,a.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,a.jsx)("span",{children:i.title}),i.isPreview&&(0,a.jsx)(t.Badge,{variant:"warning",children:"Not production ready"})]}):null}),(0,a.jsx)("div",{children:i.items.map(t=>{let s=t.pages?t.pages.includes(e??""):e===t.key;return(0,a.jsx)(r,{item:t,isActive:s,target:t.isExternal?"_blank":"_self"},t.key)})})]})}),l!==n.length-1&&(0,a.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},i.key||i.title))})})],388147)},127739,e=>{"use strict";var a=e.i(478902),t=e.i(709520),s=e.i(389959),n=e.i(843778);let i=(0,t.cva)(["mx-auto w-full @container px-6 xl:px-10"],{variants:{size:{small:"max-w-[768px]",default:"max-w-[1200px]",large:"max-w-[1600px]",full:"max-w-none"}},defaultVariants:{size:"default"}}),r=(0,s.forwardRef)(({className:e,size:t,...s},r)=>(0,a.jsx)("div",{ref:r,...s,className:(0,n.cn)(i({size:t}),e)}));r.displayName="PageContainer",e.s(["PageContainer",0,r])},456050,e=>{"use strict";var a=e.i(478902),t=e.i(709520),s=e.i(389959),n=e.i(843778),i=e.i(3259),r=e.i(127739);let l=(0,t.cva)(["flex flex-col gap-4 w-full"],{variants:{size:{default:"pt-12",small:"pt-12",large:"pt-12",full:"pt-6"}},defaultVariants:{size:"default"}}),c=(0,s.createContext)({size:"default"}),o=()=>(0,s.useContext)(c),d=({className:e,size:t,children:s,...i})=>{let r=t??"default";return(0,a.jsx)(c.Provider,{value:{size:r},children:(0,a.jsx)("div",{"data-slot":"page-header","data-size":r,className:(0,n.cn)(l({size:r}),e),...i,children:s})})},u=({className:e,children:t,...s})=>{let{size:l}=o();return(0,a.jsx)(r.PageContainer,{size:l,children:(0,a.jsx)(i.Breadcrumb,{"data-slot":"page-header-breadcrumb",className:(0,n.cn)("flex items-center gap-4 [&_li]:text-xs",e),...s,children:t})})};u.displayName="PageHeaderBreadcrumb";let m=({className:e,...t})=>(0,a.jsx)("div",{"data-slot":"page-header-icon",className:(0,n.cn)("text-foreground-light",e),...t});m.displayName="PageHeaderIcon";let h=({className:e,children:t,...s})=>(0,a.jsx)("div",{"data-slot":"page-header-summary",className:(0,n.cn)("flex flex-col gap-1",e),...s,children:t});h.displayName="PageHeaderSummary";let p=({className:e,children:t,...s})=>(0,a.jsx)("h1",{"data-slot":"page-header-title",className:(0,n.cn)("heading-title",e),...s,children:t}),x=({className:e,children:t,...s})=>(0,a.jsx)("div",{"data-slot":"page-header-description",className:(0,n.cn)("heading-subSection text-foreground-light",e),...s,children:t}),f=({className:e,children:t,...s})=>{let{size:i}=o();return(0,a.jsx)(r.PageContainer,{size:i,children:(0,a.jsx)("div",{"data-slot":"page-header-meta",className:(0,n.cn)("flex flex-col @xl:flex-row @xl:justify-between @xl:items-center gap-4",'[&>[data-slot="page-header-icon"]]:shrink-0','[&>[data-slot="page-header-summary"]]:flex-1',e),...s,children:t})})};f.displayName="PageHeaderMeta";let g=({className:e,...t})=>(0,a.jsx)("div",{"data-slot":"page-header-actions",className:(0,n.cn)("flex items-center gap-2 shrink-0",e),...t});g.displayName="PageHeaderAside";let j=({className:e,...t})=>{let{size:s}=o();return(0,a.jsx)(r.PageContainer,{size:s,className:(0,n.cn)("full"===s&&"border-b"),children:(0,a.jsx)("div",{"data-slot":"page-header-footer",className:(0,n.cn)("w-full [&>nav]:border-b-0","full"!==s&&"border-b",e),...t})})};j.displayName="PageHeaderNavigationTabs",e.s(["PageHeader",()=>d,"PageHeaderAside",()=>g,"PageHeaderBreadcrumb",()=>u,"PageHeaderDescription",()=>x,"PageHeaderIcon",()=>m,"PageHeaderMeta",()=>f,"PageHeaderNavigationTabs",()=>j,"PageHeaderSummary",()=>h,"PageHeaderTitle",()=>p])},737051,e=>{"use strict";e.i(128328);var a=e.i(657588),t=e.i(265735);e.s(["useIsETLPrivateAlpha",0,()=>{let{data:e}=(0,t.useSelectedOrganizationQuery)(),s=(0,a.useFlag)("etlPrivateAlpha"),n="string"==typeof s?s.split(",").map(e=>e.trim()):[];return(0,a.useFlag)("etlPrivateAlphaOverride")||n.includes(e?.slug??"")}])},812136,e=>{"use strict";var a=e.i(478902),t=e.i(271226),s=e.i(463333),n=e.i(737051),i=e.i(388147),r=e.i(450972),l=e.i(144676),c=e.i(912793),o=e.i(635494),d=e.i(951138),u=e.i(825713),m=e.i(731201);let h=()=>{let{data:e}=(0,o.useSelectedProjectQuery)(),d=(0,t.useRouter)().pathname.split("/")[4],{data:u}=(0,r.useDatabaseExtensionsQuery)({projectRef:e?.ref,connectionString:e?.connectionString}),{data:h}=(0,l.useProjectAddonsQuery)({projectRef:e?.ref}),p=void 0!==(u??[]).find(e=>"pg_net"===e.name),x=h?.selected_addons.find(e=>"pitr"===e.type)!==void 0,f=(0,s.useIsColumnLevelPrivilegesEnabled)(),g=(0,n.useIsETLPrivateAlpha)(),{databaseReplication:j,databaseRoles:b,integrationsWrappers:y}=(0,c.useIsFeatureEnabled)(["database:replication","database:roles","integrations:wrappers"]);return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(i.ProductMenu,{page:d,menu:(0,m.generateDatabaseMenu)(e,{pgNetExtensionExists:p,pitrEnabled:x,columnLevelPrivileges:f,showPgReplicate:j,enablePgReplicate:g,showRoles:b,showWrappers:y})})})},p=(0,d.withAuth)(({children:e})=>(0,a.jsx)(u.ProjectLayout,{product:"Database",productMenu:(0,a.jsx)(h,{}),isBlocking:!1,children:e}));e.s(["default",0,p])},843142,e=>{"use strict";var a=e.i(130843);e.s(["SelectSeparator_Shadcn_",()=>a.SelectSeparator])},114378,e=>{"use strict";var a=e.i(533488),t=e.i(389959),s=e.i(355901);function n({enabled:e,urlKey:s,select:n,onError:i}){let[r,l]=(0,a.useQueryState)(s,a.parseAsString.withOptions({history:"push",clearOnDefault:!0})),c=(0,t.useMemo)(()=>r?n(r):void 0,[r,n]);return(0,t.useEffect)(()=>{e&&r&&!c&&(i(Error("not found"),r),l(null))},[e,i,r,l,c]),{value:c,setValue:l}}e.s(["handleErrorOnDelete",0,(e,a,t)=>{a!==e.current?s.toast.error(t):e.current=null},"useQueryStateWithSelect",()=>n])},300424,e=>{"use strict";var a=e.i(478902),t=e.i(902858),s=e.i(370410),n=e.i(365257),i=e.i(479232),r=e.i(389959),l=e.i(801834),c=e.i(2579),o=e.i(635494),d=e.i(206413),u=e.i(592360),m=e.i(178527),h=e.i(837710),p=e.i(703526),x=e.i(917007),f=e.i(920432),g=e.i(549815),j=e.i(911509),b=e.i(996960),y=e.i(866205),_=e.i(793912),v=e.i(135144),S=e.i(689805),N=e.i(396831),w=e.i(903248);let C=({className:e,disabled:C=!1,size:E="tiny",showError:P=!0,selectedSchemaName:k,supportSelectAll:A=!1,excludedSchemas:T=[],onSelectSchema:R,onSelectCreateSchema:D,align:L="start"})=>{let[I,O]=(0,r.useState)(!1),{can:B}=(0,c.useAsyncCheckPermissions)(t.PermissionAction.TENANT_SQL_ADMIN_WRITE,"schemas"),{data:F}=(0,o.useSelectedProjectQuery)(),{data:q,isPending:z,isSuccess:H,isError:M,error:$,refetch:W}=(0,l.useSchemasQuery)({projectRef:F?.ref,connectionString:F?.connectionString}),Q=(q||[]).filter(e=>!T.includes(e.name)).sort((e,a)=>e.name.localeCompare(a.name));return(0,a.jsxs)("div",{className:e,children:[z&&(0,a.jsx)(h.Button,{type:"default",className:"w-full [&>span]:w-full",size:E,disabled:!0,children:(0,a.jsx)(w.Skeleton,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),P&&M&&(0,a.jsxs)(m.Alert_Shadcn_,{variant:"warning",className:"!px-3 !py-3",children:[(0,a.jsx)(u.AlertTitle_Shadcn_,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,a.jsxs)(d.AlertDescription_Shadcn_,{className:"text-xs mb-2 break-words",children:["Error: ",$?.message]}),(0,a.jsx)(h.Button,{type:"default",size:"tiny",onClick:()=>W(),children:"Reload schemas"})]}),H&&(0,a.jsxs)(S.Popover_Shadcn_,{open:I,onOpenChange:O,modal:!1,children:[(0,a.jsx)(v.PopoverTrigger_Shadcn_,{asChild:!0,children:(0,a.jsx)(h.Button,{size:E,disabled:C,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,a.jsx)(n.ChevronsUpDown,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:k?(0,a.jsxs)("div",{className:"w-full flex gap-1",children:[(0,a.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,a.jsx)("p",{className:"text-foreground",children:"*"===k?"All schemas":k})]}):(0,a.jsx)("div",{className:"w-full flex gap-1",children:(0,a.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schema..."})})})}),(0,a.jsx)(_.PopoverContent_Shadcn_,{className:"p-0 min-w-[200px] pointer-events-auto",side:"bottom",align:L,sameWidthAsTrigger:!0,children:(0,a.jsxs)(y.Command_Shadcn_,{children:[(0,a.jsx)(f.CommandInput_Shadcn_,{className:"text-xs",placeholder:"Find schema..."}),(0,a.jsxs)(j.CommandList_Shadcn_,{children:[(0,a.jsx)(p.CommandEmpty_Shadcn_,{children:"No schemas found"}),(0,a.jsx)(x.CommandGroup_Shadcn_,{children:(0,a.jsxs)(N.ScrollArea,{className:(Q||[]).length>7?"h-[210px]":"",children:[A&&(0,a.jsxs)(g.CommandItem_Shadcn_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{R("*"),O(!1)},onClick:()=>{R("*"),O(!1)},children:[(0,a.jsx)("span",{children:"All schemas"}),"*"===k&&(0,a.jsx)(s.Check,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),Q?.map(e=>(0,a.jsxs)(g.CommandItem_Shadcn_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{R(e.name),O(!1)},onClick:()=>{R(e.name),O(!1)},children:[(0,a.jsx)("span",{children:e.name}),k===e.name&&(0,a.jsx)(s.Check,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==D&&B&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.CommandSeparator_Shadcn_,{}),(0,a.jsx)(x.CommandGroup_Shadcn_,{children:(0,a.jsxs)(g.CommandItem_Shadcn_,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{D(),O(!1)},onClick:()=>{D(),O(!1)},children:[(0,a.jsx)(i.Plus,{size:12}),"Create a new schema"]})})]})]})]})})]})]})};e.s(["SchemaSelector",0,C,"default",0,C])},983783,e=>{"use strict";var a=e.i(533488),t=e.i(389959);e.i(128328);var s=e.i(947748),n=e.i(158639);e.s(["useQuerySchemaState",0,()=>{var e;let{ref:i}=(0,n.useParams)(),r=i&&i.length>0&&window.localStorage.getItem(s.LOCAL_STORAGE_KEYS.LAST_SELECTED_SCHEMA(i))||"public",[l,c]=(e=(0,t.useMemo)(()=>r,[i]),(0,a.useQueryState)("schema",a.parseAsString.withDefault(e).withOptions({clearOnDefault:!1})));return(0,t.useEffect)(()=>{i&&i.length>0&&window.localStorage.setItem(s.LOCAL_STORAGE_KEYS.LAST_SELECTED_SCHEMA(i),l)},[l,i]),{selectedSchema:l,setSelectedSchema:c}}])},892277,e=>{"use strict";var a=e.i(478902),t=e.i(389959),s=e.i(837710),n=e.i(253214),i=e.i(392491),r=e.i(710483);let l=({onClose:e})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.DialogHeader,{children:(0,a.jsx)(n.DialogTitle,{children:"Schemas managed by Supabase"})}),(0,a.jsx)(n.DialogSectionSeparator,{}),(0,a.jsxs)(n.DialogSection,{className:"space-y-2 prose",children:[(0,a.jsx)("p",{className:"text-sm",children:"The following schemas are managed by Supabase and are currently protected from write access through the dashboard."}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:i.INTERNAL_SCHEMAS.map(e=>(0,a.jsx)("code",{className:"text-xs",children:e},e))}),(0,a.jsx)("p",{className:"text-sm !mt-4",children:"These schemas are critical to the functionality of your Supabase project and hence we highly recommend not altering them."}),(0,a.jsx)("p",{className:"text-sm",children:"You can, however, still interact with those schemas through the SQL Editor although we advise you only do so if you know what you are doing."})]}),(0,a.jsx)(n.DialogFooter,{children:(0,a.jsx)("div",{className:"flex items-center justify-end space-x-2",children:(0,a.jsx)(s.Button,{type:"default",onClick:e,children:"Understood"})})})]});e.s(["ProtectedSchemaWarning",0,({size:e="md",schema:c,entity:o})=>{let[d,u]=(0,t.useState)(!1),{isSchemaLocked:m,reason:h,fdwType:p}=(0,i.useIsProtectedSchema)({schema:c});return m?(0,a.jsx)(r.Admonition,{showIcon:"sm"!==e,layout:"sm"===e?"vertical":"horizontal",type:"note",title:"sm"===e?"Viewing protected schema":`Viewing ${o} from a protected schema`,description:"fdw"===h&&"iceberg"===p?(0,a.jsxs)("p",{children:["The ",(0,a.jsx)("code",{className:"text-code-inline",children:c})," schema is used by Supabase to connect to analytics buckets and is read-only through the dashboard."]}):"fdw"===h&&"s3_vectors"===p?(0,a.jsxs)("p",{children:["The ",(0,a.jsx)("code",{className:"text-code-inline",children:c})," schema is used by Supabase to connect to vector buckets and is read-only through the dashboard."]}):(0,a.jsxs)("p",{children:["The ",(0,a.jsx)("code",{className:"text-code-inline",children:c})," schema is managed by Supabase and is read-only through the dashboard."]}),actions:("fdw"!==h||"iceberg"!==p&&"s3_vectors"!==p)&&(0,a.jsxs)(n.Dialog,{open:d,onOpenChange:u,children:[(0,a.jsx)(n.DialogTrigger,{asChild:!0,children:(0,a.jsx)(s.Button,{type:"default",size:"tiny",onClick:()=>u(!0),children:"Learn more"})}),(0,a.jsx)(n.DialogContent,{children:(0,a.jsx)(l,{onClose:()=>u(!1)})})]})}):null}])},379565,(e,a,t)=>{var s=e.r(176211),n=e.r(99625),i=e.r(905799),r=e.r(632981),l=e.r(778436),c=e.r(737469);a.exports=function(e,a,t,o){var d=-1,u=n,m=!0,h=e.length,p=[],x=a.length;if(!h)return p;t&&(a=r(a,l(t))),o?(u=i,m=!1):a.length>=200&&(u=c,m=!1,a=new s(a));e:for(;++d<h;){var f=e[d],g=null==t?f:t(f);if(f=o||0!==f?f:0,m&&g==g){for(var j=x;j--;)if(a[j]===g)continue e;p.push(f)}else u(a,g,o)||p.push(f)}return p}},600760,(e,a,t)=>{var s=e.r(379565),n=e.r(239334),i=e.r(608435);a.exports=n(function(e,a){return i(e)?s(e,a):[]})},347595,(e,a,t)=>{var s=e.r(465838),n=e.r(413850);a.exports=function(e,a,t,i){return null==e?[]:(n(a)||(a=null==a?[]:[a]),n(t=i?void 0:t)||(t=null==t?[]:[t]),s(e,a,t))}},442338,e=>{"use strict";var a=e.i(478902),t=e.i(975924);e.s(["BadgeDisabled",0,({name:e})=>(0,a.jsx)("div",{className:"text-typography-body-light [[data-theme*=dark]_&]:text-typography-body-dark flex cursor-not-allowed items-center space-x-2 rounded bg-gray-600 py-0.5 px-2 text-sm",children:(0,a.jsx)("span",{className:"opacity-50",children:e})}),"BadgeSelected",0,({name:e,handleRemove:s})=>(0,a.jsxs)("div",{className:"text-typography-body-light [[data-theme*=dark]_&]:text-typography-body-dark flex items-center space-x-2 rounded bg-surface-300 py-0.5 px-2 text-sm",onClick:e=>e.preventDefault(),children:[(0,a.jsx)("span",{children:e}),(0,a.jsx)(t.X,{size:12,className:"cursor-pointer opacity-50 transition hover:opacity-100",onClick:e=>{e.preventDefault(),e.stopPropagation(),s()}})]})])},297396,e=>{"use strict";var a=e.i(478902),t=e.i(347595),s=e.i(600760),n=e.i(370410),i=e.i(88816),r=e.i(389959),l=e.i(843778),c=e.i(866205),o=e.i(703526),d=e.i(917007),u=e.i(920432),m=e.i(549815),h=e.i(911509),p=e.i(689805),x=e.i(793912),f=e.i(135144),g=e.i(396831),j=e.i(442338);e.s(["MultiSelectV2",0,({options:e,value:b,placeholder:y,searchPlaceholder:_="Search for option",disabled:v=!1,onChange:S=()=>{}})=>{let[N,w]=(0,r.useState)(!1),[C,E]=(0,r.useState)(b||[]),P=b||C,k=(0,t.default)(e,["disabled"],["desc"]),A=a=>{let t=void 0!==(P||[]).find(e=>e===a.value)?[...(0,s.default)(P,a.value)]:[...P.concat([a.value])],n=e.filter(e=>e.disabled).map(e=>e.name),i=[...new Set(t.concat(n))];E(i),S(i)};return(0,a.jsx)("div",{className:v?"pointer-events-none opacity-50":"",children:(0,a.jsxs)(p.Popover_Shadcn_,{open:N,onOpenChange:w,modal:!1,children:[(0,a.jsx)(f.PopoverTrigger_Shadcn_,{asChild:!0,children:(0,a.jsxs)("div",{className:(0,l.cn)("relative border border-strong bg-control rounded","flex w-full flex-wrap items-start gap-1.5 p-1.5 cursor-pointer",`${0===P.length?"h-9":""}`),onClick:()=>w(!0),children:[0===P.length&&y&&(0,a.jsx)("div",{className:"px-2 text-sm text-foreground-light h-full flex items-center",children:y}),P.map((e,t)=>{let s=`${e}-${t}`,n=k.find(a=>a.value===e),i=n?.disabled??!1;return n?i?(0,a.jsx)(j.BadgeDisabled,{name:n.name},s):(0,a.jsx)(j.BadgeSelected,{name:n.name,handleRemove:()=>A(n)},s):(0,a.jsx)(a.Fragment,{})}),(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pl-3 pr-2 flex space-x-1 items-center cursor-pointer ",children:(0,a.jsx)(i.ChevronDown,{size:16,strokeWidth:2,className:"text-foreground-lighter"})})]})}),(0,a.jsx)(x.PopoverContent_Shadcn_,{className:"p-0 w-96 border-strong",side:"bottom",align:"start",children:(0,a.jsxs)(c.Command_Shadcn_,{children:[(0,a.jsx)(u.CommandInput_Shadcn_,{placeholder:_}),(0,a.jsxs)(h.CommandList_Shadcn_,{children:[(0,a.jsx)(o.CommandEmpty_Shadcn_,{children:"No options found"}),(0,a.jsx)(d.CommandGroup_Shadcn_,{children:(0,a.jsx)(g.ScrollArea,{className:(0,l.cn)(k.length>7?"h-[210px]":""),children:k?.map(e=>{let t=!!(P&&P.find(a=>a===e.value));return(0,a.jsx)(m.CommandItem_Shadcn_,{value:e.value,className:"cursor-pointer w-full",onClick:()=>A(e),onSelect:()=>A(e),children:(0,a.jsxs)("div",{className:"w-full flex items-center justify-between",children:[e.name,t&&(0,a.jsx)(n.Check,{size:14})]})},e.id)})})})]})]})})]})})}])},863562,e=>{"use strict";let a="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;e.s(["DEBUG_BUILD",()=>a])},926077,e=>{"use strict";var a=e.i(242882),t=e.i(714403),s=e.i(246230);async function n({projectRef:e,connectionString:a,table:s,schema:n},i){let r=(({table:e,schema:a})=>{let t=[];e&&t.push(`tablename = '${e}'`),a&&t.push(`schemaname = '${a}'`);let s=t.length>0?`WHERE ${t.join(" AND ")}`:"";return`
  
  SELECT
    tbl.schemaname,
    tbl.tablename,
    tbl.quoted_name,
    tbl.is_table,
    json_agg(a) as columns
  FROM
    (
      SELECT
        n.nspname as schemaname,
        c.relname as tablename,
        (quote_ident(n.nspname) || '.' || quote_ident(c.relname)) as quoted_name,
        true as is_table
      FROM
        pg_catalog.pg_class c
        JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace
      WHERE
        c.relkind = 'r'
        AND n.nspname not in ('information_schema', 'pg_catalog', 'pg_toast')
        AND n.nspname not like 'pg_temp_%'
        AND n.nspname not like 'pg_toast_temp_%'
        AND has_schema_privilege(n.oid, 'USAGE') = true
        AND has_table_privilege(quote_ident(n.nspname) || '.' || quote_ident(c.relname), 'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER') = true
      union all
      SELECT
        n.nspname as schemaname,
        c.relname as tablename,
        (quote_ident(n.nspname) || '.' || quote_ident(c.relname)) as quoted_name,
        false as is_table
      FROM
        pg_catalog.pg_class c
        JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace
      WHERE
        c.relkind in ('v', 'm')
        AND n.nspname not in ('information_schema', 'pg_catalog', 'pg_toast')
        AND n.nspname not like 'pg_temp_%'
        AND n.nspname not like 'pg_toast_temp_%'
        AND has_schema_privilege(n.oid, 'USAGE') = true
        AND has_table_privilege(quote_ident(n.nspname) || '.' || quote_ident(c.relname), 'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER') = true
    ) as tbl
    LEFT JOIN (
      SELECT
        attrelid,
        attname,
        format_type(atttypid, atttypmod) as data_type,
        attnum,
        attisdropped
      FROM
        pg_attribute
    ) as a ON (
      a.attrelid = tbl.quoted_name::regclass
      AND a.attnum > 0
      AND NOT a.attisdropped
      AND has_column_privilege(tbl.quoted_name, a.attname, 'SELECT, INSERT, UPDATE, REFERENCES')
    )
  ${s}
  GROUP BY schemaname, tablename, quoted_name, is_table;
`.trim()})({table:s,schema:n}),{result:l}=await (0,t.executeSql)({projectRef:e,connectionString:a,sql:r,queryKey:["table-columns",n,s]},i);return l}e.s(["useTableColumnsQuery",0,({projectRef:e,connectionString:t,schema:i,table:r},{enabled:l=!0,...c}={})=>(0,a.useQuery)({queryKey:s.databaseKeys.tableColumns(e,i,r),queryFn:({signal:a})=>n({projectRef:e,connectionString:t,schema:i,table:r},a),enabled:l&&void 0!==e,...c})])},672296,e=>{"use strict";function a(e){return e.split("#")[0]}function t(e,a={}){let{maxDepth:s=3,redaction:n="[REDACTED]",truncationNotice:i="[REDACTED: max depth reached]",sensitiveKeys:r=[]}=a,l=new Set(["password","passwd","pwd","pass","secret","token","id_token","access_token","refresh_token","apikey","api_key","api-key","apiKey","key","privatekey","private_key","client_secret","clientSecret","auth","authorization","ssh_key","sshKey","bearer","session","cookie","csrf","xsrf","ip","ip_address","ipAddress","aws_access_key_id","aws_secret_access_key","gcp_service_account_key",...r].map(e=>e.toLowerCase())),c=[{re:/\b(?:(?:25[0-5]|2[0-4]\d|1?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|1?\d?\d)\b/g,reason:"ip"},{re:/\b(?:[A-Fa-f0-9]{1,4}:){2,7}[A-Fa-f0-9]{1,4}\b/g,reason:"ip6"},{re:/\b(AKI|ASI)A[0-9A-Z]{16}\b/g,reason:"aws_access_key_id"},{re:/\b[0-9A-Za-z/+]{40}\b/g,reason:"aws_secret_access_key_like"},{re:/\bBearer\s+[A-Za-z0-9\-._~+/]+=*\b/g,reason:"bearer"},{re:/\b[A-Za-z0-9-_]+?\.[A-Za-z0-9-_]+?\.[A-Za-z0-9-_]+?\b/g,reason:"jwt_like"},{re:/\b[A-Za-z0-9_\-]{24,64}\b/g,reason:"long_token"}],o=new WeakMap;function d(e){let a=e;for(let{re:e}of c)a=a.replace(e,n);return a}function u(e){return l.has(String(e).toLowerCase())}return e.map(e=>(function e(a,t){if(null==a||"number"==typeof a||"boolean"==typeof a||"bigint"==typeof a)return a;if("string"==typeof a)return d(a);if("function"==typeof a)return"[Function]";if(a instanceof Date)return a.toISOString();if(a instanceof RegExp)return a.toString();if(ArrayBuffer.isView(a)&&!(a instanceof DataView))return`[TypedArray byteLength=${a.byteLength}]`;if(a instanceof ArrayBuffer)return`[ArrayBuffer byteLength=${a.byteLength}]`;if(t>=s)return i;if("object"==typeof a){if(o.has(a))return"[Circular]";if(Array.isArray(a)){let s=[];o.set(a,s);for(let n=0;n<a.length;n++)s[n]=e(a[n],t+1);return s}if(function(e){if(null===e||"object"!=typeof e)return!1;let a=Object.getPrototypeOf(e);return a===Object.prototype||null===a}(a)){let s={};for(let[i,r]of(o.set(a,s),Object.entries(a)))u(i)?s[i]=n:s[i]=e(r,t+1);return s}if(a instanceof Map){let s=[];for(let[i,r]of(o.set(a,s),a.entries())){let a=u(i)?n:e(i,t+1),l=u(i)?n:e(r,t+1);s.push([a,l])}return s}if(a instanceof Set){let s=[];for(let n of(o.set(a,s),a.values()))s.push(e(n,t+1));return s}if(a instanceof URL)return a.toString();if(a instanceof Error){let e={name:a.name,message:d(a.message),stack:i};return o.set(a,e),e}try{return d(String(a))}catch{return d(Object.prototype.toString.call(a))}}return d(String(a))})(e,0))}e.s(["sanitizeArrayOfObjects",()=>t,"sanitizeUrlHashParams",()=>a])},664367,e=>{"use strict";var a=e.i(478902),t=e.i(17203),s=e.i(339098),n=e.i(867637),i=e.i(366652),r=e.i(211570),l=e.i(533488),c=e.i(389959),o=e.i(355901);e.i(128328);var d=e.i(158639),u=e.i(567558),m=e.i(653961),h=e.i(300424),p=e.i(38429),x=e.i(356003),f=e.i(714403),g=e.i(937357);async function j({projectRef:e,connectionString:a,name:t,schema:s}){let n=`drop index if exists "${s}"."${t}"`,{result:i}=await (0,f.executeSql)({projectRef:e,connectionString:a,sql:n,queryKey:["indexes"]});return i}var b=e.i(242882);async function y({schema:e,projectRef:a,connectionString:t},s){if(!e)throw Error("schema is required");let n=(({schema:e})=>`
SELECT
  n.nspname        AS schema,
  t.relname        AS "table",
  i.relname        AS name,
  pg_get_indexdef(idx.indexrelid) AS definition,
  STRING_AGG(
    COALESCE(a.attname, '(expression)'),
    ', ' ORDER BY k.ord
  ) AS columns
FROM pg_index idx
JOIN pg_class      t ON t.oid = idx.indrelid
JOIN pg_class      i ON i.oid = idx.indexrelid
JOIN pg_namespace  n ON n.oid = t.relnamespace
JOIN LATERAL unnest(idx.indkey) WITH ORDINALITY AS k(attnum, ord) ON TRUE
LEFT JOIN pg_attribute a
  ON a.attrelid = t.oid
 AND a.attnum   = k.attnum
WHERE n.nspname = '${e}'
GROUP BY
  n.nspname,
  t.relname,
  i.relname,
  idx.indexrelid
ORDER BY
  schema, "table", name;
`.trim())({schema:e}),{result:i}=await (0,f.executeSql)({projectRef:a,connectionString:t,sql:n,queryKey:["indexes",e]},s);return i}var _=e.i(801834),v=e.i(114378),S=e.i(983783),N=e.i(635494),w=e.i(392491),C=e.i(837710),E=e.i(627069),P=e.i(539013),k=e.i(492418),A=e.i(746301),T=e.i(466472),R=e.i(108151),D=e.i(892277),L=e.i(370410),I=e.i(365257),O=e.i(774803),B=e.i(210419),F=e.i(513826);async function q({projectRef:e,connectionString:a,payload:t}){let{schema:s,entity:n,type:i,columns:r}=t,l=`
  CREATE INDEX ON "${s}"."${n}" USING ${i} (${r.map(e=>`"${e}"`).join(", ")});
  `.trim(),{result:c}=await (0,f.executeSql)({projectRef:e,connectionString:a,sql:l,queryKey:["indexes",s]});return c}var z=e.i(926077),H=e.i(740413),M=e.i(10429),$=e.i(703526),W=e.i(917007),Q=e.i(920432),G=e.i(549815),U=e.i(911509),K=e.i(866205),V=e.i(793912),Y=e.i(135144),J=e.i(689805),Z=e.i(396831),X=e.i(451031),ee=e.i(831927),ea=e.i(843142),et=e.i(156722),es=e.i(719754),en=e.i(449123),ei=e.i(843778),er=e.i(710483),el=e.i(297396),ec=e.i(538482);let eo=[{name:"B-Tree",value:"btree",description:"For querying data with equality or range conditions on columns.\nThis is the default index type that Postgres uses."},{name:"Hash",value:"hash",description:"For querying exact matches on columns"},{name:"GiST",value:"gist",description:"For querying complex data types or custom-defined operators"},{name:"SP-GiST",value:"spgist",description:"Similar to GiST, but is more specialized and customizable"},{name:"GIN",value:"gin",description:"For querying multi-valued data such as arrays or full-text search scenarios"},{name:"BRIN",value:"brin",description:"For querying large tables with sorted data"}],ed=({visible:e,onClose:t})=>{let{data:s}=(0,N.useSelectedProjectQuery)(),n=(0,N.useIsOrioleDb)(),[i,r]=(0,c.useState)("public"),[l,d]=(0,c.useState)(void 0),[u,h]=(0,c.useState)([]),[f,j]=(0,c.useState)(eo[0].value),[b,y]=(0,c.useState)(!1),[v,S]=(0,c.useState)(!1),[w,E]=(0,c.useState)(""),{data:k}=(0,_.useSchemasQuery)({projectRef:s?.ref,connectionString:s?.connectionString}),{data:A,isPending:T}=(0,H.useEntityTypesQuery)({schemas:[i],sort:"alphabetical",search:w,projectRef:s?.ref,connectionString:s?.connectionString}),{data:D,isPending:ed,isSuccess:eu}=(0,z.useTableColumnsQuery)({schema:i,table:l,projectRef:s?.ref,connectionString:s?.connectionString}),{mutate:em,isPending:eh}=(({onSuccess:e,onError:a,...t}={})=>{let s=(0,x.useQueryClient)();return(0,p.useMutation)({mutationFn:e=>q(e),async onSuccess(a,t,n){let{projectRef:i}=t;await s.invalidateQueries({queryKey:g.databaseIndexesKeys.list(i)}),await e?.(a,t,n)},async onError(e,t,s){void 0===a?o.toast.error(`Failed to create database index: ${e.message}`):a(e,t,s)},...t})})({onSuccess:()=>{t(),o.toast.success("Successfully created index")}}),ep=(0,c.useMemo)(()=>A?.pages.flatMap(e=>e.data.entities)||[],[A?.pages]);function ex(e){E(e)}let ef=(D?.[0]?.columns??[]).filter(e=>null!==e).map(e=>({id:e.attname,value:e.attname,name:e.attname,disabled:!1})),eg=`
CREATE INDEX ON "${i}"."${l}" USING ${f} (${u.map(e=>`"${e}"`).join(", ")});
`.trim();(0,c.useEffect)(()=>{e&&(r("public"),d(""),h([]),j(eo[0].value))},[e]),(0,c.useEffect)(()=>{d(""),h([]),j(eo[0].value)},[i]),(0,c.useEffect)(()=>{h([]),j(eo[0].value)},[l]);let ej=0===ep.length;return(0,a.jsx)(P.SidePanel,{size:"large",header:"Create new index",visible:e,onCancel:t,onConfirm:()=>s?l?void em({projectRef:s.ref,connectionString:s.connectionString,payload:{schema:i,entity:l,type:f,columns:u}}):console.error("Entity is required"):console.error("Project is required"),loading:eh,confirmText:"Create index",children:(0,a.jsxs)("div",{className:"py-6 space-y-6",children:[(0,a.jsxs)(P.SidePanel.Content,{className:"space-y-6",children:[(0,a.jsx)(ec.FormItemLayout,{label:"Select a schema",name:"select-schema",isReactForm:!1,children:(0,a.jsxs)(J.Popover_Shadcn_,{modal:!1,open:b,onOpenChange:y,children:[(0,a.jsx)(Y.PopoverTrigger_Shadcn_,{asChild:!0,children:(0,a.jsx)(C.Button,{type:"default",size:"medium",className:"w-full [&>span]:w-full text-left",iconRight:(0,a.jsx)(I.ChevronsUpDown,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:void 0!==i&&""!==i?i:"Choose a schema"})}),(0,a.jsx)(V.PopoverContent_Shadcn_,{className:"p-0",side:"bottom",align:"start",sameWidthAsTrigger:!0,children:(0,a.jsxs)(K.Command_Shadcn_,{children:[(0,a.jsx)(Q.CommandInput_Shadcn_,{placeholder:"Find table...",value:w,onValueChange:ex}),(0,a.jsxs)(U.CommandList_Shadcn_,{children:[(0,a.jsx)($.CommandEmpty_Shadcn_,{children:"No schemas found"}),(0,a.jsx)(W.CommandGroup_Shadcn_,{children:(0,a.jsx)(Z.ScrollArea,{className:(k||[]).length>7?"h-[210px]":"",children:(k??[]).map(e=>(0,a.jsxs)(G.CommandItem_Shadcn_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{r(e.name),y(!1)},onClick:()=>{r(e.name),y(!1)},children:[(0,a.jsx)("span",{children:e.name}),l===e.name&&(0,a.jsx)(L.Check,{className:"text-brand",strokeWidth:2,size:16})]},e.name))})})]})]})})]})}),(0,a.jsx)(ec.FormItemLayout,{label:"Select a table",name:"select-table",description:ej&&!T&&"Create a table in this schema via the Table or SQL editor first",isReactForm:!1,children:(0,a.jsxs)(J.Popover_Shadcn_,{modal:!1,open:v,onOpenChange:S,children:[(0,a.jsx)(Y.PopoverTrigger_Shadcn_,{asChild:!0,disabled:ej||T,children:(0,a.jsx)(C.Button,{type:"default",size:"medium",className:(0,ei.cn)("w-full [&>span]:w-full text-left",""===l&&"text-foreground-lighter"),iconRight:(0,a.jsx)(I.ChevronsUpDown,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:void 0!==l&&""!==l?l:ej?"No tables available in schema":"Choose a table"})}),(0,a.jsx)(V.PopoverContent_Shadcn_,{className:"p-0",side:"bottom",align:"start",sameWidthAsTrigger:!0,children:(0,a.jsxs)(K.Command_Shadcn_,{shouldFilter:!1,children:[(0,a.jsx)(Q.CommandInput_Shadcn_,{placeholder:"Find table...",value:w,onValueChange:ex}),(0,a.jsxs)(U.CommandList_Shadcn_,{children:[(0,a.jsx)($.CommandEmpty_Shadcn_,{children:T?(0,a.jsxs)("div",{className:"flex items-center gap-2 text-center justify-center",children:[(0,a.jsx)(O.Loader2,{size:12,className:"animate-spin"}),"Loading..."]}):"No tables found"}),(0,a.jsx)(W.CommandGroup_Shadcn_,{children:(0,a.jsx)(Z.ScrollArea,{className:(ep||[]).length>7?"h-[210px]":"",children:(ep??[]).map(e=>(0,a.jsxs)(G.CommandItem_Shadcn_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{d(e.name),S(!1)},onClick:()=>{d(e.name),S(!1)},children:[(0,a.jsx)("span",{children:e.name}),l===e.name&&(0,a.jsx)(L.Check,{className:"text-brand",strokeWidth:2,size:16})]},e.name))})})]})]})})]})}),l&&(0,a.jsxs)(ec.FormItemLayout,{label:"Select up to 32 columns",isReactForm:!1,children:[ed&&(0,a.jsx)(R.ShimmeringLoader,{className:"py-4"}),eu&&(0,a.jsx)(el.MultiSelectV2,{options:ef,placeholder:"Choose which columns to create an index on",searchPlaceholder:"Search for a column",value:u,onChange:h})]})]}),u.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.SidePanel.Separator,{}),(0,a.jsxs)(P.SidePanel.Content,{className:"space-y-6",children:[(0,a.jsx)(ec.FormItemLayout,{label:"Select an index type",name:"selected-index-type",isReactForm:!1,children:(0,a.jsxs)(en.Select_Shadcn_,{disabled:n,value:f,onValueChange:j,name:"selected-index-type",children:[(0,a.jsx)(et.SelectTrigger_Shadcn_,{size:"small",children:(0,a.jsx)(es.SelectValue_Shadcn_,{className:"font-mono",children:f})}),(0,a.jsx)(X.SelectContent_Shadcn_,{children:eo.map((e,t)=>(0,a.jsxs)(c.Fragment,{children:[(0,a.jsx)(ee.SelectItem_Shadcn_,{value:e.value,children:(0,a.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,a.jsx)("span",{children:e.name}),e.description.split("\n").map((t,s)=>(0,a.jsx)("span",{className:"text-foreground-lighter group-focus:text-foreground-light group-data-[state=checked]:text-foreground-light",children:t},`${e.value}-description-${s}`))]})}),t<eo.length-1&&(0,a.jsx)(ea.SelectSeparator_Shadcn_,{})]},e.name))})]})}),n&&(0,a.jsx)(er.Admonition,{type:"default",className:"!mt-2",title:"OrioleDB currently only supports the B-tree index type",description:"More index types may be supported when OrioleDB is no longer in preview",children:(0,a.jsx)(F.DocsButton,{className:"mt-2",abbrev:!1,href:`${M.DOCS_URL}`})})]}),(0,a.jsx)(P.SidePanel.Separator,{}),(0,a.jsx)(P.SidePanel.Content,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm",children:"Preview of SQL statement"}),(0,a.jsx)(C.Button,{asChild:!0,type:"default",children:(0,a.jsx)(B.default,{href:void 0!==s?`/project/${s.ref}/sql/new?content=${eg}`:"/",children:"Open in SQL Editor"})})]})}),(0,a.jsx)("div",{className:"h-[200px] !mt-2",children:(0,a.jsx)("div",{className:"relative h-full",children:(0,a.jsx)(m.default,{isReadOnly:!0,autofocus:!1,id:`${i}-${l}-${u.join(",")}-${f}`,language:"pgsql",defaultValue:eg})})})]})]})})},eu=()=>{let{data:e}=(0,N.useSelectedProjectQuery)(),{schema:t,table:f}=(0,d.useParams)(),[L,I]=(0,l.useQueryState)("search",l.parseAsString.withDefault("")),{selectedSchema:O,setSelectedSchema:B}=(0,S.useQuerySchemaState)(),F=(0,c.useRef)(null),{data:q,error:z,isPending:H,isSuccess:M,isError:$}=(({projectRef:e,connectionString:a,schema:t},{enabled:s=!0,...n}={})=>(0,b.useQuery)({queryKey:g.databaseIndexesKeys.list(e,t),queryFn:({signal:s})=>y({projectRef:e,connectionString:a,schema:t},s),enabled:s&&void 0!==e&&void 0!==t,...n}))({schema:O,projectRef:e?.ref,connectionString:e?.connectionString}),[W,Q]=(0,l.useQueryState)("new",l.parseAsBoolean.withDefault(!1).withOptions({history:"push",clearOnDefault:!0})),{setValue:G,value:U}=(0,v.useQueryStateWithSelect)({urlKey:"edit",select:e=>e?q?.find(a=>a.name===e):void 0,enabled:!!q,onError:()=>o.toast.error("Index not found")}),{setValue:K,value:V}=(0,v.useQueryStateWithSelect)({urlKey:"delete",select:e=>e?q?.find(a=>a.name===e):void 0,enabled:!!q,onError:(e,a)=>(0,v.handleErrorOnDelete)(F,a,"Index not found")}),{data:Y,isPending:J,isSuccess:Z,isError:X}=(0,_.useSchemasQuery)({projectRef:e?.ref,connectionString:e?.connectionString}),{mutate:ee,isPending:ea}=(({onSuccess:e,onError:a,...t}={})=>{let s=(0,x.useQueryClient)();return(0,p.useMutation)({mutationFn:e=>j(e),async onSuccess(a,t,n){let{projectRef:i}=t;await s.invalidateQueries({queryKey:g.databaseIndexesKeys.list(i)}),await e?.(a,t,n)},async onError(e,t,s){void 0===a?o.toast.error(`Failed to delete database index: ${e.message}`):a(e,t,s)},...t})})({onSuccess:async()=>{K(null),o.toast.success("Successfully deleted index")}}),{isSchemaLocked:et}=(0,w.useIsProtectedSchema)({schema:O}),es=(0,s.default)(q??[],e=>e.name.toLocaleLowerCase()),en=L.length>0?es.filter(e=>e.name.includes(L)||e.table.includes(L)):es;return(0,c.useEffect)(()=>{if(void 0!==t){let e=Y?.find(e=>e.name===t);void 0!==e&&B(e.name)}},[t,Z]),(0,c.useEffect)(()=>{void 0!==f&&I(f)},[f]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"pb-8",children:(0,a.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[J&&(0,a.jsx)(R.ShimmeringLoader,{className:"w-[260px]"}),X&&(0,a.jsxs)("div",{className:"w-[260px] text-foreground-light text-sm border px-3 py-1.5 rounded flex items-center space-x-2",children:[(0,a.jsx)(n.AlertCircle,{strokeWidth:2,size:16}),(0,a.jsx)("p",{children:"Failed to load schemas"})]}),Z&&(0,a.jsx)(h.default,{className:"w-full lg:w-[180px]",size:"tiny",showError:!1,selectedSchemaName:O,onSelectSchema:B}),(0,a.jsx)(A.Input,{size:"tiny",value:L,className:"w-full lg:w-52",onChange:e=>I(e.target.value),placeholder:"Search for an index",icon:(0,a.jsx)(i.Search,{})}),!et&&(0,a.jsx)(C.Button,{className:"ml-auto flex-grow lg:flex-grow-0",type:"primary",onClick:()=>Q(!0),disabled:!Z,children:"Create index"})]}),et&&(0,a.jsx)(D.ProtectedSchemaWarning,{schema:O,entity:"indexes"}),H&&(0,a.jsx)(R.GenericSkeletonLoader,{}),$&&(0,a.jsx)(u.default,{error:z,subject:"Failed to retrieve database indexes"}),M&&(0,a.jsx)("div",{className:"w-full overflow-hidden",children:(0,a.jsx)(E.Card,{children:(0,a.jsxs)(k.Table,{children:[(0,a.jsx)(k.TableHeader,{children:(0,a.jsxs)(k.TableRow,{children:[(0,a.jsx)(k.TableHead,{children:"Table"},"table"),(0,a.jsx)(k.TableHead,{children:"Columns"},"columns"),(0,a.jsx)(k.TableHead,{children:"Name"},"name"),(0,a.jsx)(k.TableHead,{},"buttons")]})}),(0,a.jsxs)(k.TableBody,{children:[0===en.length&&0===L.length&&(0,a.jsx)(k.TableRow,{children:(0,a.jsxs)(k.TableCell,{colSpan:4,children:[(0,a.jsx)("p",{className:"text-sm text-foreground",children:"No indexes created yet"}),(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:['There are no indexes found in the schema "',O,'"']})]})}),0===en.length&&L.length>0&&(0,a.jsx)(k.TableRow,{children:(0,a.jsxs)(k.TableCell,{colSpan:4,children:[(0,a.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',L,'" did not return any results']})]})}),en.length>0&&en.map(e=>(0,a.jsxs)(k.TableRow,{children:[(0,a.jsx)(k.TableCell,{children:(0,a.jsx)("p",{title:e.table,children:e.table})}),(0,a.jsx)(k.TableCell,{children:(0,a.jsx)("p",{title:e.columns,children:e.columns})}),(0,a.jsx)(k.TableCell,{children:(0,a.jsx)("p",{title:e.name,children:e.name})}),(0,a.jsx)(k.TableCell,{children:(0,a.jsxs)("div",{className:"flex justify-end items-center space-x-2",children:[(0,a.jsx)(C.Button,{type:"default",onClick:()=>G(e.name),children:"View definition"}),!et&&(0,a.jsx)(C.Button,{"aria-label":"Delete index",type:"text",className:"px-1",icon:(0,a.jsx)(r.Trash,{}),onClick:()=>K(e.name)})]})})]},e.name))]})]})})})]})}),(0,a.jsx)(P.SidePanel,{size:"xlarge",visible:!!U,header:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"Index:"}),(0,a.jsx)("code",{className:"text-sm ml-2",children:U?.name})]}),onCancel:()=>G(null),children:(0,a.jsx)("div",{className:"h-full",children:(0,a.jsx)("div",{className:"relative h-full",children:(0,a.jsx)(m.default,{isReadOnly:!0,id:U?.name??"",language:"pgsql",defaultValue:U?.definition??""})})})}),(0,a.jsx)(ed,{visible:W,onClose:()=>Q(!1)}),(0,a.jsx)(T.ConfirmationModal,{variant:"warning",size:"medium",loading:ea,visible:!!V,title:(0,a.jsxs)(a.Fragment,{children:["Confirm to delete index ",(0,a.jsx)("code",{className:"text-sm",children:V?.name})]}),confirmLabel:"Confirm delete",confirmLabelLoading:"Deleting...",onConfirm:()=>void 0!==V?(a=>{if(!e)return console.error("Project is required");F.current=a.name,ee({projectRef:e.ref,connectionString:e.connectionString,name:a.name,schema:O})})(V):{},onCancel:()=>K(null),alert:{title:"This action cannot be undone",description:"Deleting an index that is still in use will cause queries to slow down, and in some cases causing significant performance issues."},children:(0,a.jsx)("ul",{className:"mt-4 space-y-5",children:(0,a.jsx)("li",{className:"flex gap-3",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"text-sm",children:"Before deleting this index, consider:"}),(0,a.jsxs)("ul",{className:"space-y-2 mt-2 text-sm text-foreground-light",children:[(0,a.jsx)("li",{className:"list-disc ml-6",children:"This index is no longer in use"}),(0,a.jsx)("li",{className:"list-disc ml-6",children:"The table which the index is on is not currently in use, as dropping an index requires a short exclusive access lock on the table."})]})]})})})})]})};var em=e.i(812136),eh=e.i(448710),ep=e.i(127739),ex=e.i(456050),ef=e.i(228027);let eg=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ex.PageHeader,{size:"large",children:(0,a.jsxs)(ex.PageHeaderMeta,{children:[(0,a.jsxs)(ex.PageHeaderSummary,{children:[(0,a.jsx)(ex.PageHeaderTitle,{children:"Database Indexes"}),(0,a.jsx)(ex.PageHeaderDescription,{children:"Improve query performance against your database"})]}),(0,a.jsxs)(ex.PageHeaderAside,{children:[(0,a.jsx)(F.DocsButton,{className:"no-underline",href:`${M.DOCS_URL}/guides/database/query-optimization`}),(0,a.jsx)(C.Button,{asChild:!0,type:"default",icon:(0,a.jsx)(t.ExternalLink,{strokeWidth:1.5}),children:(0,a.jsx)("a",{target:"_blank",rel:"noreferrer",className:"no-underline",href:`${M.DOCS_URL}/guides/database/extensions/index_advisor`,children:"Index Advisor"})})]})]})}),(0,a.jsx)(ep.PageContainer,{size:"large",children:(0,a.jsx)(ef.PageSection,{children:(0,a.jsx)(ef.PageSectionContent,{children:(0,a.jsx)(eu,{})})})})]});eg.getLayout=e=>(0,a.jsx)(eh.default,{children:(0,a.jsx)(em.default,{title:"Indexes",children:e})}),e.s(["default",0,eg],664367)},789740,(e,a,t)=>{let s="/project/[ref]/database/indexes";(window.__NEXT_P=window.__NEXT_P||[]).push([s,()=>e.r(664367)]),a.hot&&a.hot.dispose(function(){window.__NEXT_P.push([s])})},111410,e=>{e.v(a=>Promise.all(["static/chunks/a428d2b7e6671266.js","static/chunks/92a7c4be60dd12e3.js"].map(a=>e.l(a))).then(()=>a(677146)))},883471,e=>{e.v(a=>Promise.all(["static/chunks/69b2faaedd35af23.js"].map(a=>e.l(a))).then(()=>a(518769)))},774186,e=>{e.v(a=>Promise.all(["static/chunks/117b4e5883cfc423.js"].map(a=>e.l(a))).then(()=>a(376359)))},981889,e=>{e.v(a=>Promise.all(["static/chunks/e44cabdf5aea9bff.js"].map(a=>e.l(a))).then(()=>a(242525)))},730314,e=>{e.v(a=>Promise.all(["static/chunks/dcadd9d46d72282e.js","static/chunks/0860ba34f07162db.js","static/chunks/82dddbda1a808189.js","static/chunks/15e50b9d6c55f00a.js","static/chunks/87b9766a4d16d1da.js","static/chunks/cc8130a84ee9bc2c.css"].map(a=>e.l(a))).then(()=>a(686651)))},753940,e=>{e.v(a=>Promise.all(["static/chunks/046f60a3ac988a54.js"].map(a=>e.l(a))).then(()=>a(478124)))},724565,e=>{e.v(a=>Promise.all(["static/chunks/3ef67abf4c659c0b.js"].map(a=>e.l(a))).then(()=>a(341546)))},591393,e=>{e.v(a=>Promise.all(["static/chunks/e9ad074e72197584.js"].map(a=>e.l(a))).then(()=>a(217383)))},379416,e=>{e.v(a=>Promise.all(["static/chunks/031b0d6330b6fbae.js"].map(a=>e.l(a))).then(()=>a(931066)))},15732,e=>{e.v(a=>Promise.all(["static/chunks/0d5256e667945be4.js"].map(a=>e.l(a))).then(()=>a(760545)))},957083,e=>{e.v(a=>Promise.all(["static/chunks/e7d07ff1ae210964.js"].map(a=>e.l(a))).then(()=>a(667558)))},926327,e=>{e.v(a=>Promise.all(["static/chunks/a5f6425a6c20e9a8.js"].map(a=>e.l(a))).then(()=>a(72947)))},207969,e=>{e.v(a=>Promise.all(["static/chunks/8dd7282c22f923f6.js"].map(a=>e.l(a))).then(()=>a(427328)))},992842,e=>{e.v(a=>Promise.all(["static/chunks/d064a48a1c7cf778.js"].map(a=>e.l(a))).then(()=>a(793794)))},239573,e=>{e.v(a=>Promise.all(["static/chunks/edc5d84148401903.js"].map(a=>e.l(a))).then(()=>a(210246)))},963685,e=>{e.v(a=>Promise.all(["static/chunks/92b20126e5ca0919.js"].map(a=>e.l(a))).then(()=>a(983756)))},665811,e=>{e.v(a=>Promise.all(["static/chunks/e37e25f8b82619ef.js"].map(a=>e.l(a))).then(()=>a(544836)))},369256,e=>{e.v(a=>Promise.all(["static/chunks/8296dc618dae72f0.js"].map(a=>e.l(a))).then(()=>a(930239)))},16037,e=>{e.v(a=>Promise.all(["static/chunks/3251b4bc539a554b.js"].map(a=>e.l(a))).then(()=>a(397698)))},616788,e=>{e.v(a=>Promise.all(["static/chunks/c6b81ab43a1d5d23.js"].map(a=>e.l(a))).then(()=>a(7346)))},315750,e=>{e.v(a=>Promise.all(["static/chunks/32c236321136eb7c.js"].map(a=>e.l(a))).then(()=>a(531289)))},460510,e=>{e.v(a=>Promise.all(["static/chunks/d91062943e6a7c30.js"].map(a=>e.l(a))).then(()=>a(276898)))},550265,e=>{e.v(a=>Promise.all(["static/chunks/75ff0e62b8a31d26.js"].map(a=>e.l(a))).then(()=>a(259714)))},830960,e=>{e.v(a=>Promise.all(["static/chunks/b44aa26556fee7df.js"].map(a=>e.l(a))).then(()=>a(882885)))},336744,e=>{e.v(a=>Promise.all(["static/chunks/2b0767b5c008139a.js"].map(a=>e.l(a))).then(()=>a(955268)))},63631,e=>{e.v(a=>Promise.all(["static/chunks/21a4706e1f02d90b.js"].map(a=>e.l(a))).then(()=>a(853630)))},396476,e=>{e.v(a=>Promise.all(["static/chunks/265a0c1d143bd3f1.js"].map(a=>e.l(a))).then(()=>a(62943)))},912072,e=>{e.v(a=>Promise.all(["static/chunks/c17c80e5efc43419.js"].map(a=>e.l(a))).then(()=>a(311301)))}]);

//# debugId=066ea2f4-3171-dd86-7343-a19297a79cdf
//# sourceMappingURL=d02fdbc123595aab.js.map